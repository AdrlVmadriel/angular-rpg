webpackJsonp([1],[,,,,,,,,,,,function(t,e,n){"use strict";var o=n(63);n.d(e,"a",function(){return a});var a=function(){function t(t,e){t&&t.hasOwnProperty("x")&&t.hasOwnProperty("y")?this.set(t.x,t.y):"string"==typeof t&&"string"==typeof e?this.set(parseFloat(t),parseFloat(e)):"number"==typeof t&&"number"==typeof e?this.set(t,e):this.zero()}return t.prototype.toString=function(){return this.x+","+this.y},t.prototype.set=function(e,n){if(e instanceof t||e&&void 0!==e.x&&void 0!==e.y)this.x=e.x,this.y=e.y;else{if("number"!=typeof e||"number"!=typeof n)throw new Error(o.a.INVALID_ARGUMENTS);this.x=e,this.y=n}return this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.add=function(e,n){return e instanceof t?(this.x+=e.x,this.y+=e.y):"number"==typeof e&&"undefined"==typeof n?(this.x+=e,this.y+=e):(this.x+=e,this.y+=n),this},t.prototype.subtract=function(e,n){return e instanceof t?(this.x-=e.x,this.y-=e.y):"number"==typeof e&&"undefined"==typeof n?(this.x-=e,this.y-=e):(this.x-=e,this.y-=n),this},t.prototype.multiply=function(e,n){return e instanceof t?(this.x*=e.x,this.y*=e.y):"number"==typeof e&&"undefined"==typeof n?(this.x*=e,this.y*=e):(this.x*=e,this.y*=n),this},t.prototype.divide=function(e,n){if(e instanceof t){if(0===e.x||0===e.y)throw new Error(o.a.DIVIDE_ZERO);this.x/=e.x,this.y/=e.y}else if("number"==typeof e&&"undefined"==typeof n){if(0===e)throw new Error(o.a.DIVIDE_ZERO);this.x/=e,this.y/=e}else{if(0===e||0===n)throw new Error(o.a.DIVIDE_ZERO);this.x/=e,this.y/=n}return this},t.prototype.inverse=function(){return this.x*=-1,this.y*=-1,this},t.prototype.equal=function(t){return this.x===t.x&&this.y===t.y},t.equal=function(t,e){return e.x===t.x&&e.y===t.y},t.prototype.isZero=function(){return 0===this.x&&0===this.y},t.prototype.zero=function(){return this.x=this.y=0,this},t.interpolate=function(t,e,n,o){return o=Math.min(Math.max(o,0),1),t.x=e.x*(1-o)+n.x*o,t.y=e.y*(1-o)+n.y*o,t},t.prototype.interpolate=function(e,n,o){return t.interpolate(this,e,n,o)},t}()},,,,,function(t,e,n){"use strict";var o=n(663),a=(n.n(o),n(165)),i=n(167),r=n(166),s=n(164),c=n(168),u=n(22);n.d(e,"g",function(){return p}),n.d(e,"i",function(){return d}),n.d(e,"h",function(){return l}),n.d(e,"a",function(){return m}),n.d(e,"c",function(){return g}),n.d(e,"n",function(){return _}),n.d(e,"d",function(){return k}),n.d(e,"s",function(){return S}),n.d(e,"o",function(){return E}),n.d(e,"v",function(){return I}),n.d(e,"t",function(){return T}),n.d(e,"r",function(){return M}),n.d(e,"e",function(){return $}),n.d(e,"m",function(){return A}),n.d(e,"f",function(){return F}),n.d(e,"b",function(){return O}),n.d(e,"j",function(){return R}),n.d(e,"k",function(){return z}),n.d(e,"l",function(){return G}),n.d(e,"q",function(){return H}),n.d(e,"u",function(){return Q}),n.d(e,"p",function(){return nt});var p=function(t){return t.combat},d=(n.i(o.createSelector)(p,s.a),n.i(o.createSelector)(p,s.b)),l=n.i(o.createSelector)(p,s.c),h=function(t){return t.sprites},m=n.i(o.createSelector)(h,c.a),f=(n.i(o.createSelector)(h,c.b),function(t){return t.entities}),y=n.i(o.createSelector)(f,a.a),b=(n.i(o.createSelector)(f,a.b),function(t){return n.i(o.createSelector)(y,function(e){return e.get(t)})}),v=n.i(o.createSelector)(f,a.c),g=(n.i(o.createSelector)(f,a.d),function(t){return n.i(o.createSelector)(b(t),v,function(t,e){if(!t)return null;var n={armor:e.get(t.armor),helm:e.get(t.helm),shield:e.get(t.shield),accessory:e.get(t.accessory),boots:e.get(t.boots),weapon:e.get(t.weapon)};return Object.assign({},t,n)})}),_=function(t){return t.gameState},x=n.i(o.createSelector)(_,i.a),w=n.i(o.createSelector)(_,i.b),k=n.i(o.createSelector)(_,i.c),S=n.i(o.createSelector)(_,i.d),E=n.i(o.createSelector)(_,i.e),I=n.i(o.createSelector)(_,i.f),T=(n.i(o.createSelector)(_,i.g),n.i(o.createSelector)(_,i.h)),M=n.i(o.createSelector)(_,i.i),$=n.i(o.createSelector)(y,w,function(t,e){return e.map(function(e){return t.get(e)})}),A=function(t){return n.i(o.createSelector)(M,function(e){return e.get(t)})},F=n.i(o.createSelector)(v,x,function(t,e){return e.map(function(e){var o=t.get(e);return n.i(u.c)(o,e+" is present in inventory but not in entity collection. Did you forget to dispatch EntityAddItemAction?"),o})}),C=function(t){return t.gameData},O=n.i(o.createSelector)(C,r.a),D=function(t,e){return e.map(function(e){return t.get(e)})},B=n.i(o.createSelector)(C,r.c),L=n.i(o.createSelector)(C,r.d),R=n.i(o.createSelector)(B,L,D),P=n.i(o.createSelector)(C,r.e),j=n.i(o.createSelector)(C,r.f),z=n.i(o.createSelector)(P,j,D),N=n.i(o.createSelector)(C,r.g),U=n.i(o.createSelector)(C,r.h),G=n.i(o.createSelector)(N,U,D),W=n.i(o.createSelector)(C,r.i),V=n.i(o.createSelector)(C,r.j),H=n.i(o.createSelector)(W,V,D),q=n.i(o.createSelector)(C,r.k),Y=n.i(o.createSelector)(C,r.l),Z=(n.i(o.createSelector)(q,Y,D),n.i(o.createSelector)(C,r.m)),X=n.i(o.createSelector)(C,r.n),K=(n.i(o.createSelector)(Z,X,D),n.i(o.createSelector)(C,r.o)),J=n.i(o.createSelector)(C,r.p),Q=n.i(o.createSelector)(K,J,D),tt=n.i(o.createSelector)(C,r.q),et=n.i(o.createSelector)(C,r.r),nt=n.i(o.createSelector)(tt,et,D)},,,function(t,e,n){"use strict";var o=n(22);n.d(e,"o",function(){return a}),n.d(e,"p",function(){return i}),n.d(e,"q",function(){return r}),n.d(e,"l",function(){return s}),n.d(e,"m",function(){return c}),n.d(e,"n",function(){return u}),n.d(e,"i",function(){return p}),n.d(e,"j",function(){return d}),n.d(e,"k",function(){return l}),n.d(e,"d",function(){return h}),n.d(e,"e",function(){return m}),n.d(e,"f",function(){return f}),n.d(e,"t",function(){return y}),n.d(e,"a",function(){return b}),n.d(e,"b",function(){return v}),n.d(e,"c",function(){return g}),n.d(e,"r",function(){return _}),n.d(e,"u",function(){return x}),n.d(e,"v",function(){return w}),n.d(e,"s",function(){return k}),n.d(e,"g",function(){return S}),n.d(e,"h",function(){return E}),n.d(e,"w",function(){return I}),n.d(e,"x",function(){return T});var a=function(){function t(){this.type=t.typeId,this.payload=null}return t}();a.typeId=n.i(o.a)("GAME_SAVE");var i=function(){function t(){this.type=t.typeId,this.payload=null}return t}();i.typeId=n.i(o.a)("GAME_SAVE_SUCCESS");var r=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();r.typeId=n.i(o.a)("GAME_SAVE_FAIL");var s=function(){function t(){this.type=t.typeId,this.payload=null}return t}();s.typeId=n.i(o.a)("GAME_SAVE_DELETE");var c=function(){function t(){this.type=t.typeId,this.payload=null}return t}();c.typeId=n.i(o.a)("GAME_SAVE_DELETE_SUCCESS");var u=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();u.typeId=n.i(o.a)("GAME_SAVE_DELETE_FAIL");var p=function(){function t(){this.type=t.typeId}return t}();p.typeId=n.i(o.a)("GAME_LOAD");var d=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();d.typeId=n.i(o.a)("GAME_LOAD_SUCCESS");var l=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();l.typeId=n.i(o.a)("GAME_LOAD_FAIL");var h=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();h.typeId=n.i(o.a)("GAME_NEW");var m=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();m.typeId=n.i(o.a)("GAME_NEW_SUCCESS");var f=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();f.typeId=n.i(o.a)("GAME_NEW_FAIL");var y=function(){function t(e,n){this.type=t.typeId,this.payload={key:e,value:n}}return t}();y.typeId=n.i(o.a)("GAME_SET_KEY_DATA");var b=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();b.typeId=n.i(o.a)("GAME_TRAVEL");var v=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();v.typeId=n.i(o.a)("GAME_TRAVEL_SUCCESS");var g=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();g.typeId=n.i(o.a)("GAME_TRAVEL_FAIL");var _=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();_.typeId=n.i(o.a)("GAME_MOVE");var x=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();x.typeId=n.i(o.a)("GAME_ADD_GOLD");var w=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();w.typeId=n.i(o.a)("GAME_HEAL_PARTY");var k=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();k.typeId=n.i(o.a)("GAME_SET_BATTLE_COUNTER");var S=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();S.typeId=n.i(o.a)("GAME_EQUIP_ITEM");var E=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();E.typeId=n.i(o.a)("GAME_UNEQUIP_ITEM");var I=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();I.typeId=n.i(o.a)("GAME_ADD_INVENTORY");var T=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();T.typeId=n.i(o.a)("GAME_REMOVE_INVENTORY")},,,function(t,e,n){"use strict";function o(t){if(u[t])throw new Error('Action type "'+t+'" is not unique"');return u[t]=!0,t}function a(t){}function i(t,e){return n.i(c.makeTypedFactory)(t,e)}function r(t,e){if(!t)throw new Error("Assertion Failed: "+e)}function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})}var c=n(915);n.n(c);e.a=o,e.e=a,e.d=i,e.c=r,e.b=s;var u={}},,,,,,function(t,e,n){"use strict";var o=n(1),a=n(177);n.d(e,"a",function(){return i});var i=function(){function t(t){var e=this;this.animate=t,this.paused=!1,this.animationClass="active",this.message=null,this.defaultTimeout=2500,this._container=null,this._current=null,this._queue=[],this._dismissBinding=null,this._dismissBinding=function(t){e.dismiss()}}return Object.defineProperty(t.prototype,"container",{get:function(){return this._container},set:function(t){this._container&&this._container.removeEventListener("click",this._dismissBinding),this._container=t,this._container&&this._container.addEventListener("click",this._dismissBinding)},enumerable:!0,configurable:!0}),t.prototype.show=function(t,e,n){var o={message:t,done:e,duration:"undefined"==typeof n?this.defaultTimeout:n};return this.queue(o)},t.prototype.dismiss=function(){var t=this;this._current&&!this.paused&&(this.paused=!0,this.animate.leave(this.container,this.animationClass).then(function(){if(t._current){try{t._current.done&&t._current.done(t._current)}catch(t){console.warn(t)}t._current=null,t.message=null}t.paused=!1}),this._current&&(this._current.dismissed=!0))},t.prototype.queue=function(t){return t.elapsed=0,this._queue.push(t),t},t.prototype.processFrame=function(t){var e=this;if(this._current&&this.paused!==!0){var n=this._current,o=n.duration&&n.elapsed>n.duration,a=n.dismissed===!0;if(!o&&!a)return void(n.elapsed+=t);this.dismiss()}this.paused||0===this._queue.length||(this._current=this._queue.shift(),this.paused=!0,this.message=this._current.message,this.animate.enter(this.container,this.animationClass).then(function(){e.paused=!1}))},t}();i=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[a.a])],i)},,,,,,,,,function(t,e,n){"use strict";var o=n(1),a=n(39),i=n(130),r=n(284),s=n(178),c=n(7),u=n(73),p=n(123),d=n(124),l=n(90),h=n(19),m=n(16);n.d(e,"a",function(){return y});var f=null,y=function(t){function e(e,n,o,a){var r=t.call(this)||this;return r.loader=e,r.store=n,r.sprites=o,r.gameStateService=a,r.input=new i.a,r.ready$=r.store.select(m.a).combineLatest(r.store.select(m.b),function(t,e){return t&&e}).filter(function(t){return t}).map(function(){}),f=r,r.gameStateService.hasSaveGame()?r.store.dispatch(new h.i):(r.store.dispatch(new d.d("assets/images/index.json")),r.store.dispatch(new p.b(u.a))),r}return __extends(e,t),e.get=function(){return f},e}(r.a);y=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[a.a,c.a,s.a,l.a])],y)},function(t,e,n){"use strict";var o=n(63),a=n(11);n.d(e,"a",function(){return i});var i=function(){function t(e,n,o,i){return e instanceof t?(this.point=new a.a(e.point),this.extent=new a.a(e.extent)):"number"==typeof o&&"number"==typeof i?(this.point=new a.a(e,n),this.extent=new a.a(o,i)):e instanceof a.a&&n instanceof a.a?(this.point=new a.a(e),this.extent=new a.a(n)):(this.point=new a.a(0,0),this.extent=new a.a(1,1)),this}return t.prototype.toString=function(){return this.point.toString()+","+this.extent.toString()},t.prototype.set=function(e,n,i,r){if(e instanceof t)this.point.set(e.point),this.extent.set(e.extent);else if("number"==typeof i&&"number"==typeof r)this.point.set(e,n),this.extent.set(i,r);else{if(!(e instanceof a.a&&n instanceof a.a))throw new Error(o.a.INVALID_ARGUMENTS);this.point.set(e),this.extent.set(n)}return this},t.prototype.clone=function(){return new t(this.point.clone(),this.extent.clone())},t.prototype.clip=function(t){var e=this.point.x+this.extent.x,n=this.point.y+this.extent.y;return this.point.x=Math.max(t.point.x,this.point.x),this.extent.x=Math.min(t.point.x+t.extent.x,e)-this.point.x,this.point.y=Math.max(t.point.y,this.point.y),this.extent.y=Math.min(t.point.y+t.extent.y,n)-this.point.y,this},t.prototype.isValid=function(){return this.extent.x>0&&this.extent.y>0},t.prototype.intersect=function(t){return!(t.point.x>this.point.x+this.extent.x||t.point.x+t.extent.x<this.point.x||t.point.y>this.point.y+this.extent.y||t.point.y+t.extent.y<this.point.y)},t.prototype.pointInRect=function(t,e){var n=0;if(t instanceof a.a)n=t.x,e=t.y;else{if("number"!=typeof t||"number"!=typeof e)throw new Error(o.a.INVALID_ARGUMENTS);n=t}return!(n>=this.point.x+this.extent.x||e>=this.point.y+this.extent.y)&&!(n<this.point.x||e<this.point.y)},t.prototype.getCenter=function(){var t=parseFloat((this.point.x+.5*this.extent.x).toFixed(2)),e=parseFloat((this.point.y+.5*this.extent.y).toFixed(2));return new a.a(t,e)},t.prototype.setCenter=function(t,e){var n;return t instanceof a.a||t&&void 0!==t.x&&void 0!==t.y?(n=t.x,e=t.y):n=t,this.point.x=parseFloat((n-.5*this.extent.x).toFixed(2)),this.point.y=parseFloat((e-.5*this.extent.y).toFixed(2)),this},t.prototype.getLeft=function(){return this.point.x},t.prototype.getTop=function(){return this.point.y},t.prototype.getRight=function(){return this.point.x+this.extent.x},t.prototype.getBottom=function(){return this.point.y+this.extent.y},t.prototype.getHalfSize=function(){return new a.a(this.extent.x/2,this.extent.y/2)},t.prototype.addPoint=function(t){t.x<this.point.x&&(this.extent.x=this.extent.x-(t.x-this.point.x),this.point.x=t.x),t.y<this.point.y&&(this.extent.y=this.extent.y-(t.x-this.point.y),this.point.y=t.y),t.x>this.point.x+this.extent.x&&(this.extent.x=t.x-this.point.x),t.y>this.point.y+this.extent.y&&(this.extent.y=t.y-this.point.y)},t.prototype.inflate=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.point.x-=t,this.extent.x+=2*t,this.point.y-=e,this.extent.y+=2*e,this},t}()},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(63)),i=n(179),r=n(283),s=n(129),c=n(180),u=n(181),p=n(282),d=n(1),l=n(121);n.d(e,"a",function(){return h});var h=function(){function t(t){this.http=t,this._cache={},this._types={png:i.a,json:r.a,xml:s.a,tmx:c.a,tsx:u.a,"":p.a,mp3:p.a,m4a:p.a,aac:p.a,ogg:p.a,wav:p.a}}return t.prototype.registerType=function(t,e){this._types[t]=e},t.prototype.getResourceExtension=function(t){var e=t.lastIndexOf(".");return e===-1||e<=t.lastIndexOf("/")?"":t.substr(e+1)},t.prototype.create=function(t,e){if("function"!=typeof t)throw new Error(a.a.INVALID_ARGUMENTS);return new t(null,e)},t.prototype.loadAsType=function(t,e){var n=this;return new Promise(function(o,i){if(!t||!e)return i(a.a.INVALID_ARGUMENTS);var r=n._cache[t];return r&&r.data?o(r):(r||(r=n._cache[t]=new e(t,null)),void r.fetch(t).then(function(){return o(r)}).catch(function(t){return i(t)}))})},t.prototype.load=function(t){var e=this;return new Promise(function(n,a){function i(){if(0===s)return 0===c?n(r):a(c+" resources failed to load")}var r=[],s=0,c=0;o.isArray(t)||(t=[t]);for(var u=function(n){var o=t[n],a=e.getResourceExtension(o),u=e._types[a];return u?(s++,void e.loadAsType(o,e._types[a]).then(function(t){s--,i(),t.extension=a,r.push(t)}).catch(function(t){console.log("failed to load resource ("+o+") with error: "+t),c++,s--,i()})):(c++,"continue")},p=0;p<t.length;p++)u(p);i()})},t}();h=__decorate([n.i(d.d)(),__metadata("design:paramtypes",[l.a])],h)},,,function(t,e,n){"use strict";var o=n(281);n.d(e,"a",function(){return a});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.a)},,,,function(t,e,n){"use strict";var o=n(35);n.n(o);n.d(e,"a",function(){return a});var a=function(){function t(){this._loading$=new o.BehaviorSubject(!0),this.loading$=this._loading$,this._title$=new o.BehaviorSubject(""),this.title$=this._title$,this._message$=new o.BehaviorSubject(""),this.message$=this._message$}return Object.defineProperty(t.prototype,"loading",{set:function(t){this._loading$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{set:function(t){this._title$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{set:function(t){this._message$.next(t)},enumerable:!0,configurable:!0}),t}()},function(t,e,n){"use strict";var o=n(1),a=n(35),i=(n.n(a),n(39)),r=n(74),s=n(4);n.n(s);n.d(e,"a",function(){return c});var c=function(){function t(t){this.resourceLoader=t,this._combatMap$=new a.ReplaySubject(1),this.combatMap$=this._combatMap$}return t.prototype.loadMap=function(t){var e=this,o=n.i(r.a)("combat");return a.Observable.fromPromise(this.resourceLoader.load(o).then(function(n){if(!n[0]||!n[0].data)return null;var o=n[0];return o.layers.forEach(function(e){e.visible=e.name===t}),e._combatMap$.next(o),o}))},t.prototype.loadEncounter=function(t){return this.loadMap(t.zone).map(function(){return t})},t.prototype.isDefeated=function(t){return!t||t.hp<=0},t.prototype.rollHit=function(t,e){var n=s.random(0,200),o=this.getSpeed(t),a=this.getSpeed(e),i=o<a,r=i?180:120;return 200!==n&&(0===n||n<=r)},t.prototype.getSpeed=function(t){return t.speed},t.prototype.attackCombatant=function(t,e){var n=this.getAttack(t),o=this.getDefense(e),a=n-o,i=this.varyDamage(a);return this.rollHit(t,e)?Math.ceil(i):0},t.prototype.getDefense=function(t){var e=t,n=e.shield?e.shield.defense:0,o=e.armor?e.armor.defense:0,a=e.boots?e.boots.defense:0,i=e.helm?e.helm.defense:0,r=e.accessory?e.accessory.defense:0;return t.defense+n+o+a+i+r},t.prototype.getAttack=function(t){return this.getWeaponStrength(t)+t.attack},t.prototype.getMagic=function(t){return t.magic},t.prototype.getWeaponStrength=function(t){var e=t;return e.weapon?e.weapon.attack:0},t.prototype.varyDamage=function(t){var e=1.2*t,n=.8*t;return Math.max(1,Math.floor(Math.random()*(e-n+1))+n)},t}();c=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[i.a])],c)},function(t,e,n){"use strict";var o=n(94),a=n(187),i=n(1),r=n(35),s=(n.n(r),n(37)),c=n(49),u=n(180),p=n(16),d=n(7);n.d(e,"b",function(){return l}),n.d(e,"a",function(){return h});var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._feature$=new r.BehaviorSubject(null),e.feature$=e._feature$,e._active$=new r.BehaviorSubject(!1),e.active$=e._active$,e}return __extends(e,t),Object.defineProperty(e.prototype,"feature",{set:function(t){this._feature$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._feature$.value?this._feature$.value.properties||{}:{}},enumerable:!0,configurable:!0}),e.prototype.assertFeature=function(){if(!this._feature$.value||!this.properties)throw new Error("feature lacks valid data or properties")},Object.defineProperty(e.prototype,"active",{set:function(t){this._active$.next(t)},enumerable:!0,configurable:!0}),e.prototype.enter=function(t){return this.assertFeature(),this.active=!0,!0},e.prototype.exit=function(t){return this.assertFeature(),this.active=!1,!0},e}(a.a);__decorate([n.i(i.M)(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],l.prototype,"active",null);var h=function(t){function e(e){var a=t.call(this)||this;return a.store=e,a.onClose=new i.D,a._featureComponent$=new r.ReplaySubject(1),a._feature$=new r.BehaviorSubject(null),a.feature$=a._feature$,a.type$=a.feature$.map(function(t){return t.type}),a.gameFeatureObject$=a.feature$.combineLatest(a._featureComponent$,function(t,e){if(!t||!a.tiledMap)return null;var n=Object.assign({},t.properties||{},{type:t.type,x:Math.round(t.x/a.tiledMap.tilewidth),y:Math.round(t.y/a.tiledMap.tileheight)}),i=new o.a(n);return i.addBehavior(e),i}),a.enabled$=a._feature$.switchMap(function(t){return t&&t.properties&&t.properties.id?a.store.select(n.i(p.m)(t.properties.id)):r.Observable.of(void 0)}).map(function(t){return t!==!0}),a}return __extends(e,t),Object.defineProperty(e.prototype,"feature",{get:function(){return this._feature$.value},set:function(t){this._feature$.next(t)},enumerable:!0,configurable:!0}),e.prototype.toString=function(){var e=this._feature$.value;return e?"[TiledTMXFeature] (name:"+e.name+") (id:"+e.properties.id+")":t.prototype.toString.call(this)},e.prototype.ngAfterViewInit=function(){var t=this;this.featureQuery.length>0&&this._featureComponent$.next(this.featureQuery.first),this._hostSubscription=this.gameFeatureObject$.do(function(e){t.disconnectHost(),t.host=e,s.a.get().mark(t.host),t.scene.addObject(t.host)}).subscribe()},e.prototype.disconnectHost=function(){this.host&&(this.scene&&this.scene.removeObject(this.host),s.a.get().erase(this.host),this.host.destroy(),this.host=null)},e.prototype.ngOnDestroy=function(){this._hostSubscription&&(this._hostSubscription.unsubscribe(),this._hostSubscription=null),this.disconnectHost()},e}(a.a);__decorate([n.i(i.M)(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],h.prototype,"feature",null),__decorate([n.i(i.M)(),__metadata("design:type",u.a)],h.prototype,"tiledMap",void 0),__decorate([n.i(i.M)(),__metadata("design:type",c.a)],h.prototype,"scene",void 0),__decorate([n.i(i._18)("comp"),__metadata("design:type",i._19)],h.prototype,"featureQuery",void 0),__decorate([n.i(i._8)(),__metadata("design:type",i.D)],h.prototype,"onClose",void 0),h=__decorate([n.i(i.Z)({selector:"map-feature",changeDetection:i._0.OnPush,template:n(660)}),__metadata("design:paramtypes",[d.a])],h)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(469)),i=n(127);n.d(e,"a",function(){return r});var r=function(t){function e(n){void 0===n&&(n={});var i=t.call(this)||this;return i.id="scene-"+e.sceneCount++,i.db=new a.a,i.options={},i._objects=[],i._views=[],i.world=null,i.fps=0,i.time=0,i.paused=!1,i.options=o.defaults(n||{},{debugRender:!1}),i}return __extends(e,t),e.prototype.destroy=function(){var t;this.world&&this.world.erase(this);var e=this._objects.length;for(t=0;t<e;t++)this.removeObject(this._objects[t],!0);for(e=this._views.length,t=0;t<e;t++)this.removeView(this._views[t]);this.paused=!0},e.prototype.onAddToWorld=function(t){t.time.addObject(this)},e.prototype.onRemoveFromWorld=function(t){t.time.removeObject(this)},e.prototype.tick=function(t){if(!this.paused)for(var e=this._objects.length,n=0;n<e;n++)this._objects[n]&&this._objects[n].tick(t)},e.prototype.processFrame=function(t){var e;if(!this.paused){this.time=this.world.time.time;var n=this._objects.length;for(e=0;e<n;e++){var o=this._objects[e];o.interpolateTick&&o.interpolateTick(t)}for(n=this._views.length,e=0;e<n;e++)this._views[e].render(t);var a=t?1e3/t:0;this.fps+=(a-this.fps)/10}},e.prototype.removeIt=function(t,e){var n=this,a=!1;return this[t]=o.filter(this[t],function(t){return e&&t&&t._uid===e._uid?(n.db.removeSpatialObject(t),t.onRemoveFromScene&&t.onRemoveFromScene(n),n.world&&n.world.erase(t),delete t.scene,a=!0,!1):!!t}),a},e.prototype.addIt=function(t,e){if(e.scene&&e.scene.removeIt(t,e),o.where(this[t],{_uid:e._uid}).length>0)throw new Error("Object added to scene twice");return this[t].push(e),this.world&&this.world.mark(e),this.db.addSpatialObject(e),e.scene=this,e.onAddToScene&&e.onAddToScene(this),!0},e.prototype.findIt=function(t,e){return o.where(this[t],{_uid:e._uid})},e.prototype.addView=function(t){return this.addIt("_views",t)},e.prototype.removeView=function(t){return this.removeIt("_views",t)},e.prototype.findView=function(t){return!!this.findIt("_views",t)},e.prototype.getViewOfType=function(t){return o.find(this._views,function(e){return e instanceof t})},e.prototype.addObject=function(t){return this.addIt("_objects",t)},e.prototype.removeObject=function(t,e){e="undefined"==typeof e||!!e;var n=t,o=this.removeIt("_objects",t);return n&&e&&n.destroy&&n.destroy(),o},e.prototype.findObject=function(t){return!!this.findIt("_objects",t)},e.prototype.componentByType=function(t){for(var e=this._objects,n=this._objects.length,o=0;o<n;o++){var a=e[o],i=a.findBehavior(t);if(i)return i}return null},e.prototype.componentsByType=function(t){for(var e=this._objects,n=this._objects.length,o=[],a=0;a<n;a++){var i=e[a],r=i.findBehaviors(t);r&&(o=o.concat(r))}return o},e.prototype.objectsByName=function(t){for(var e=this._objects,n=this._objects.length,o=[],a=0;a<n;a++){var i=e[a];i.name===t&&o.push(i)}return o},e.prototype.objectByName=function(t){for(var e=this._objects,n=this._objects.length,o=0;o<n;o++){var a=e[o];if(a.name===t)return a}return null},e.prototype.objectsByType=function(t){for(var e=this._objects,n=this._objects.length,o=[],a=0;a<n;a++){var i=e[a];i instanceof t&&o.push(i)}return o},e.prototype.objectByType=function(t){for(var e=this._objects,n=this._objects.length,o=0;o<n;o++){var a=e[o];if(a instanceof t)return a}return null},e.prototype.objectsByComponent=function(t){for(var e=this._objects,n=this._objects.length,o=[],a=0;a<n;a++){var i=e[a];i.findBehavior(t)&&o.push(i)}return o},e.prototype.objectByComponent=function(t){for(var e=this._objects,n=this._objects.length,o=0;o<n;o++){var a=e[o];if(a.findBehavior(t))return a}return null},e.prototype.toString=function(){return this.constructor.name?this.constructor.name+" ("+this.id+")":this.id},e}(i.a);r.sceneCount=0},,,,,,,,,,,,function(t,e,n){"use strict";var o=n(286);n.d(e,"a",function(){return a});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o.a)},function(t,e,n){"use strict";var o=n(39),a=n(1),i=n(7),r=n(19),s=n(4),c=(n.n(s),n(122)),u=n(90),p=n(45);n.n(p);n.d(e,"a",function(){return d});var d=l=function(){function t(t,e){this.loader=t,this.store=e}return t.getHPForLevel=function(t,e){return Math.floor(e.basedefense*Math.pow(t,1.1))+2*e.basedefense},t.create=function(t,e){var n={eid:"invalid-hero",type:t,name:e,level:1,exp:0,baseattack:0,basespeed:0,basemagic:0,basedefense:0},o=null;switch(t){case"warrior":o=s.extend({},n,{eid:"warrior-123",icon:"warrior-male.png",baseattack:10,basespeed:2,basemagic:1,basedefense:7});break;case"healer":o=s.extend({},n,{eid:"lifemage-123",icon:"magician-female.png",baseattack:1,basespeed:6,basemagic:9,basedefense:4});break;case"ranger":o=s.extend({},n,{eid:"ranger-123",icon:"ranger-female.png",baseattack:3,basespeed:10,basemagic:2,basedefense:5});break;case"mage":o=s.extend({},n,{eid:"deathmage-123",icon:"magician-male.png",baseattack:2,basespeed:10,basemagic:4,basedefense:4});break;default:throw new Error("Unknown character class: "+t)}var a=l.getHPForLevel(1,o);return o=s.extend(o,{maxhp:a,hp:a,defense:o.basedefense,speed:o.basespeed,attack:o.baseattack,magic:o.basemagic})},t.prototype.initGame=function(t){var e=this;return void 0===t&&(t=!!localStorage.getItem(u.a.STATE_KEY)),new Promise(function(n,o){if(t)e.store.dispatch(new r.i),n(!1);else{var a=l.create("warrior","Warrior"),i=l.create("ranger","Ranger"),s=l.create("healer","Mage"),u={party:p.List([a.eid,i.eid,s.eid]),inventory:p.List(),battleCounter:0,keyData:p.Map(),gold:200,combatZone:"",location:"town",position:{x:12,y:8},shipPosition:{x:0,y:0}};e.store.dispatch(new r.d(u)),e.store.dispatch(new c.a(a)),e.store.dispatch(new c.a(i)),e.store.dispatch(new c.a(s)),e.store.dispatch(new r.a(u)),n(!0)}})},t}();d=l=__decorate([n.i(a.d)(),__metadata("design:paramtypes",[o.a,i.a])],d);var l},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o={INVALID_ARGUMENTS:"invalid arguments",DIVIDE_ZERO:"divide by zero operation",CLASS_NOT_IMPLEMENTED:"must be implemented in a subclass",UNSUPPORTED_OPERATION:"this operation is unsupported by the implementation",REQUIRED_ARGUMENT:"argument must be valid",ALREADY_EXISTS:"already exists and would overwrite existing value",INDEX_OUT_OF_RANGE:"index out of range",INVALID_ITEM:"invalid item type or value",COMPONENT_REGISTER_FAIL:"component failed to register with host entity"}},,,,,,,,,function(t,e,n){"use strict";var o=n(22);n.d(e,"b",function(){return a}),n.d(e,"f",function(){return i}),n.d(e,"c",function(){return r}),n.d(e,"e",function(){return s}),n.d(e,"a",function(){return c}),n.d(e,"d",function(){return u});var a=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();a.typeId=n.i(o.a)("COMBAT_ENCOUNTER");var i=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();i.typeId=n.i(o.a)("COMBAT_ENCOUNTER_ERROR");var r=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();r.typeId=n.i(o.a)("COMBAT_ENCOUNTER_READY");var s=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();s.typeId=n.i(o.a)("COMBAT_ATTACK");var c=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();c.typeId=n.i(o.a)("COMBAT_VICTORY");var u=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();u.typeId=n.i(o.a)("COMBAT_VICTORY_DONE")},function(t,e,n){"use strict";function o(t,e){return Object.assign({eid:a(t.id)},t,e||{})}function a(t){return t+"-"+n.i(i.b)()}var i=n(22);n.d(e,"a",function(){return r}),e.b=o,e.c=a;var r="1LXSRyupQanOYeZv-h7lgSwaAzB-TxwfDPFJyZqnaewc"},function(t,e,n){"use strict";function o(t){return c+"maps/"+t+".tmx"}function a(t,e){return void 0===e&&(e="wav"),c+"sounds/"+t+"."+e}function i(t,e){for(var n in e)e.hasOwnProperty(n)&&(u.sprites[n]=s.defaults(u.sprites[n]||{},e[n]))}function r(t){return u.sprites[t]}var s=n(4);n.n(s);e.a=o,e.d=a,n.d(e,"c",function(){return u}),e.b=i,e.e=r;var c="assets/",u={sprites:{}}},function(t,e,n){"use strict";var o=n(42);n.d(e,"a",function(){return a});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tickRateMS=300,e}return __extends(e,t),e.prototype.tick=function(t){},e.prototype.interpolateTick=function(t){},e}(o.a)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(102)),i=n(38);n.d(e,"a",function(){return r});var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tiles=[],e.bounds=new i.a(0,0,10,10),e.dirtyLayers=!1,e._loaded=!1,e}return __extends(e,t),e.prototype.isLoaded=function(){return this._loaded},e.prototype.loaded=function(){this.trigger(e.Events.LOADED,this),this.scene&&this.scene.trigger(e.Events.MAP_LOADED,this),this._loaded=!0},e.prototype.unloaded=function(){this.trigger(e.Events.UNLOADED,this),this.scene&&this.scene.trigger(e.Events.MAP_UNLOADED,this),this._loaded=!1},e.prototype.setMap=function(t){var e=this;if(!t)return!1;this.map&&this.unloaded(),this.map=t,this.bounds=new i.a(0,0,this.map.width,this.map.height);var n=o.sortBy(this.map.tilesets,function(t){return t.firstgid});return this.tiles.length=0,o.each(n,function(t){for(;e.tiles.length<t.firstgid;)e.tiles.push(null);e.tiles=e.tiles.concat(t.tiles)}),this.features=o.where(this.map.layers,{name:"Features"})[0]||[],this.zones=o.where(this.map.layers,{name:"Zones"})[0]||[],this.loaded(),!0},e.prototype.getLayers=function(){return this.map?this.map.layers:[]},e.prototype.getLayer=function(t){return o.where(this.map.layers,{name:t})[0]},e.prototype.getTerrain=function(t,e,n){return this.getTileData(this.getLayer(t),e,n)},e.prototype.getTileData=function(t,e,n){if(!(this.map&&t&&t.data&&this.bounds.pointInRect(e,n)))return null;var o=n*this.map.width+e,a=t.data[o];return this.tiles[a]},e.prototype.getTileGid=function(t,e,n){var o=this.getLayer(t);
if(!(this.map&&o&&o.data&&this.bounds.pointInRect(e,n)))return null;var a=n*this.map.width+e;return o.data[a]},e.prototype.getTileMeta=function(t){if(this.tiles.length<=t)return null;var e=o.find(this.map.tilesets,function(e){return e.hasGid(t)});return e?e.getTileMeta(t):null},e}(a.a);r.Events={LOADED:"loaded",UNLOADED:"unloaded",MAP_LOADED:"map:loaded",MAP_UNLOADED:"map:unloaded"}},,,,,,,,,,,,,,function(t,e,n){"use strict";var o=n(1),a=n(35),i=(n.n(a),n(39)),r=n(74),s=n(7);n.d(e,"a",function(){return c});var c=u=function(){function t(t,e){this.loader=t,this.store=e,this._worldMap$=new a.ReplaySubject(1),this.worldMap$=this._worldMap$}return t.prototype.loadMap=function(t){var e=this,o=n.i(r.a)(t);return a.Observable.fromPromise(this.loader.load(o).then(function(t){return e._worldMap$.next(t[0]),t[0]}))},t.prototype.resetGame=function(){return a.Observable.interval(10).take(1).map(function(){localStorage.removeItem(u.STATE_KEY)})},t.prototype.hasSaveGame=function(){return!!localStorage.getItem(u.STATE_KEY)},t.prototype.load=function(){return a.Observable.interval(10).take(1).map(function(){var t=JSON.parse(localStorage.getItem(u.STATE_KEY));return t})},t.prototype.save=function(){return this.store.take(1).map(function(t){var e=JSON.stringify(t);return localStorage.setItem(u.STATE_KEY,e),t})},t}();c.STATE_KEY="_angular2PowRPGState",c=u=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[i.a,s.a])],c);var u},function(t,e,n){"use strict";var o=n(1),a=n(130),i=n(62),r=n(37),s=n(28),c=n(11),u=n(49),p=n(93),d=n(186),l=n(46),h=n(7),m=n(175),f=n(260);n.d(e,"a",function(){return y});var y=function(t){function e(e,n,o,a,i){var r=t.call(this)||this;return r.game=e,r.notify=n,r.loadingService=o,r.store=a,r.world=i,r.combat=r,r.scene=new u.a,r.pointer=null,r.items=[],r.damages=[],r.mouse=null,r.world.mark(r.scene),r}return __extends(e,t),e.prototype.ngOnDestroy=function(){this.world.erase(this.scene),this.world.time.removeObject(this),this.scene.removeView(this),this.pointer=null,this.damages=[]},e.prototype.ngAfterViewInit=function(){var t=this;this.canvas=this.canvasElementRef.nativeElement,this.camera&&(this.camera.point.zero(),this.camera.extent.set(25,25)),this.scene.addView(this),setTimeout(function(){return t._onResize()},1),this.world.time.addObject(this),this._bindRenderCombat()},e.prototype.onAddToScene=function(e){t.prototype.onAddToScene.call(this,e),e.world&&e.world.input&&(this.mouse=e.world.input.mouseHook(this,"combat"))},e.prototype.onRemoveFromScene=function(t){t.world&&t.world.input&&t.world.input.mouseUnhook("combat")},e.prototype.tick=function(t){if(this&&this.pointer&&this.pointer.object){var e=new c.a(this.pointer.object.point);e.y=e.y-this.camera.point.y+this.pointer.offset.y,e.x=e.x-this.camera.point.x+this.pointer.offset.x;var n=this.worldToScreen(e,this.cameraScale),o=this.pointer.element.nativeElement;o.style.left=n.x+"px",o.style.top=n.y+"px"}},e.prototype.processCamera=function(){this.cameraComponent=this.map.camera,t.prototype.processCamera.call(this)},e.prototype.renderFrame=function(t){return this.clearRect(),this.map.renderFrame(this,t),this},e.prototype.applyDamage=function(t,e){var n=new c.a(t.point);n.y-=this.camera.point.y+1.25,n.x-=this.camera.point.x;var o=this.worldToScreen(n,this.cameraScale);o.add(this.canvasElementRef.nativeElement.offsetLeft,this.canvasElementRef.nativeElement.offsetTop),this.damages.push({timeout:(new Date).getTime()+5e3,value:Math.abs(e),classes:{miss:0===e,heal:e<0},position:o})},e.prototype._onClick=function(t){var e=[];if(a.a.mouseOnView(t,this,this.mouse),this.scene.db.queryPoint(this.mouse.world,p.a,e))return this.scene.trigger("click",this.mouse,e),t.stopImmediatePropagation(),!1},e.prototype._bindRenderCombat=function(){var t=this;this.machine.on("combat:attack",function(e){var n=t.machine.notifyWait(),o="",a=e.attacker.model.name,i=e.defender.model.name;o=e.damage>0?a+" attacked "+i+" for "+e.damage+" damage!":e.damage<0?a+" healed "+i+" for "+Math.abs(e.damage)+" hit points":a+" attacked "+i+", and MISSED!",t.applyDamage(e.defender,e.damage),t.notify.show(o,n)}),this.machine.on("combat:run",function(e){var n=t.machine.notifyWait(),o=e.player.model.name;o+=e.success?" bravely ran away!":" failed to escape!",t.notify.show(o,n)}),this.machine.on("combat:defeat",function(e){var n=t.machine.notifyWait();t.notify.show("Your entity was defeated...",function(){t.game.initGame().then(n)},0)})},e}(d.a);__decorate([n.i(o.M)(),__metadata("design:type",u.a)],y.prototype,"scene",void 0),__decorate([n.i(o.M)(),__metadata("design:type",Array)],y.prototype,"items",void 0),__decorate([n.i(o._14)(m.a),__metadata("design:type",m.a)],y.prototype,"machine",void 0),__decorate([n.i(o.M)(),__metadata("design:type",Array)],y.prototype,"damages",void 0),__decorate([n.i(o._14)("combatCanvas"),__metadata("design:type",o.K)],y.prototype,"canvasElementRef",void 0),__decorate([n.i(o._14)(f.b),__metadata("design:type",f.b)],y.prototype,"map",void 0),y=__decorate([n.i(o.Z)({selector:"rpg-combat",styles:[n(908)],template:n(655),host:{"(window:resize)":"_onResize($event)","(click)":"_onClick($event)"}}),__metadata("design:paramtypes",[i.a,s.a,l.a,h.a,r.a])],y)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(94)),i=n(237),r=n(76),s=n(19),c=n(1);n.d(e,"a",function(){return u});var u=p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.map=null,e.onCompleteMove=new c.D,e}return __extends(e,t),e.prototype.collideMove=function(t,e,n){void 0===n&&(n=[]),this.host.scene&&!this.map&&(this.map=this.host.scene.objectByType(r.a));var i=0,s=this.collider&&this.collider.collide(t,e,a.a,n);if(s)for(i=0;i<n.length;i++){var c=n[i];if(c.passable===!0||!c.type)return!1;if(o.indexOf(p.COLLIDE_TYPES,c.type)!==-1)return!0}if(this.map){var u=this.map.getLayers();for(i=0;i<u.length;i++){var d=this.map.getTileData(u[i],t,e);if(d)for(var l=0;l<this.passableKeys.length;l++)if(d[this.passableKeys[l]]===!1)return!0}}return!1},e.prototype.completeMove=function(e){this.host.world.store.dispatch(new s.r(e.to)),this.onCompleteMove.next(e),t.prototype.completeMove.call(this,e)},e}(i.a);u.COLLIDE_TYPES=["TempleFeatureComponent","StoreFeatureComponent","DialogFeatureComponent","CombatFeatureComponent","sign"],__decorate([n.i(c._8)(),__metadata("design:type",Object)],u.prototype,"onCompleteMove",void 0),u=p=__decorate([n.i(c.Z)({selector:"player-behavior",template:"<ng-content></ng-content>"})],u);var p},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(188));n.d(e,"a",function(){return i});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="player",e}return __extends(e,t),e.prototype.getSpells=function(){console.warn("no spell data available in GameEntityObject.getSpells");var t=[],e=this.model,n=e.level,a=e.type;return o.filter(t,function(t){return t.level<=n&&o.indexOf(t.usedby,a)!==-1})},e}(a.a)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(188));n.d(e,"a",function(){return i});var i=function(t){function e(e){var n=t.call(this)||this;return o.extend(n,o.defaults({},e)),n.feature=e,n.point.x=e.x,n.point.y=e.y,n.frame="undefined"!=typeof e.frame?e.frame:0,n.groups="string"==typeof e.groups?e.groups.split("|"):e.groups,n}return __extends(e,t),e}(a.a)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(94)),i=n(76),r=n(11),s=n(38),c=n(270);n.d(e,"a",function(){return u});var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.loaded=function(){t.prototype.loaded.call(this),this.musicUrl="",this.map.properties&&this.map.properties.music&&(this.musicUrl=this.map.properties.music),this.buildFeatures()},e.prototype.destroy=function(){return this.unloaded(),t.prototype.destroy.call(this)},e.prototype.unloaded=function(){this.removeFeaturesFromScene(),t.prototype.unloaded.call(this)},e.prototype.getFeature=function(t){return o.find(this.features.objects,function(e){return e.name===t})},e.prototype.getEntryPoint=function(){var t=o.where(this.features.objects,{type:"PortalFeatureComponent"})[0];return t?new r.a(t.x/t.width,t.y/t.height):new r.a(-1,-1)},e.prototype.addFeaturesToScene=function(){},e.prototype.removeFeaturesFromScene=function(){o.each(this.features.objects,function(t){var e=t._object;delete t._object,e&&e.destroy()})},e.prototype.buildFeatures=function(){return!0},e.prototype.createFeatureObject=function(t){var e=o.extend({},t.properties||{},{tileMap:this,type:t.type,x:Math.round(t.x/this.map.tilewidth),y:Math.round(t.y/this.map.tileheight)}),n=new a.a(e);this.scene&&this.scene.world&&this.scene.world.mark(n);var i=o.find(c.a,function(e){return e.name===t.type});if(t.type&&i){var r=new i;if(!n.addBehavior(r))throw new Error("Component "+r.name+" failed to connect to host "+this.name)}return n},e.prototype.getCombatZones=function(t){var e={map:null,target:null,targetPoint:t};this.map&&this.map.properties&&this.map.properties&&"undefined"!=typeof this.map.properties.combatZone&&(e.map=this.map.properties.combatZone);var n=1/this.map.tilewidth,a=o.map(this.zones.objects,function(t){var e=t.x*n,o=t.y*n,a=t.width*n,i=t.height*n;return{bounds:new s.a(e,o,a,i),name:t.name}}),i=o.find(a,function(e){return e.bounds.pointInRect(t)&&e.name});return i&&(e.target=i.name),e},e.prototype.toString=function(){return this.map?this.map.url:"no-data"},e}(i.a)},function(t,e,n){"use strict";var o=n(177),a=n(62),i=n(37),r=n(1),s=n(128),c=n(178),u=n(7),p=n(77),d=n(466),l=n(90),h=n(47),m=n(28),f=n(252),y=n(255);n.d(e,"d",function(){return o.a}),n.d(e,"b",function(){return m.a}),n.d(e,"c",function(){return a.a}),n.d(e,"a",function(){return b});var b=[o.a,a.a,i.a,c.a,d.a,m.a,h.a,y.a,f.a,l.a],v=g=function(){function t(){}return t.forRoot=function(){return{ngModule:g,providers:b}},t}();v=g=__decorate([n.i(r.x)({providers:b,imports:[s.a,u.c,p.c]})],v);var g},function(t,e,n){"use strict";var o=n(63);n.d(e,"a",function(){return a});var a=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.url=t,this.data=e}return t.prototype.load=function(t){return Promise.reject(o.a.CLASS_NOT_IMPLEMENTED)},t.prototype.fetch=function(t){return Promise.reject(o.a.CLASS_NOT_IMPLEMENTED)},t}()},,,,,function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(280)),i=n(11);n.d(e,"a",function(){return r});var r=function(t){function e(n){var a=t.call(this)||this;return a._uid="scene-object-"+e.objectCount++,o.extend(a,o.defaults(n||{}),{point:new i.a(0,0),size:new i.a(1,1),enabled:!0}),a}return __extends(e,t),e.prototype.tick=function(t){if(this.enabled)for(var e=this._connectedBehaviors,n=this._connectedBehaviors.length,o=0;o<n;o++){if(!e[o])throw new Error("Component deleted during tick, use _.defer to delay removal until the callstack unwinds");e[o].tick&&e[o].tick(t)}},e.prototype.interpolateTick=function(t){if(this.enabled)for(var e=this._connectedBehaviors,n=this._connectedBehaviors.length,o=0;o<n;o++){if(!e[o])throw new Error("Component deleted during interpolateTick, delay removal until the callstack unwinds");e[o].interpolateTick&&e[o].interpolateTick(t)}},e.prototype.destroy=function(){o.each(this._connectedBehaviors,function(t){t.disconnectBehavior()}),this._connectedBehaviors.length=0,this.scene&&this.scene.removeObject(this,!1)},e.prototype.onAddToScene=function(t){this.syncBehaviors()},e.prototype.addComponentDictionary=function(t,e){var n=this,a=null;return o.each(t,function(t,e){a||n.addBehavior(t,!0)||(a=t)}),a?console.log("Failed to add component set to host. Component "+a.toString()+" failed to connect to host."):this.syncBehaviors(),!a},e.prototype.removeComponentDictionary=function(t,e){var n=this._connectedBehaviors.length,a=o.map(t,function(t){return t.id});this._connectedBehaviors=o.filter(this._connectedBehaviors,function(t){return o.indexOf(a,t.id)===-1||(t.disconnectBehavior()===!1||(t.host=null,!1))});var i=this._connectedBehaviors.length===n;return i&&e!==!0&&this.syncBehaviors(),i},e.prototype.toString=function(){var t=this.constructor,e=this.name;return t&&"Function"!==t.name&&(e=t.name||(this.toString().match(/function (.+?)\(/)||[,""])[1]),o.each(this._connectedBehaviors,function(t){e+=", "+t}),e},e}(a.a);r.objectCount=0},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(42));n.d(e,"a",function(){return i});var i=function(t){function e(e){var n=t.call(this)||this;return n.frame=0,"undefined"!=typeof e&&o.extend(n,e),n}return __extends(e,t),Object.defineProperty(e.prototype,"scale",{get:function(){return this.host?this.host.scale:1},enumerable:!0,configurable:!0}),e.prototype.syncBehavior=function(){return this.host.world&&this.setSprite(this.icon,this.frame),t.prototype.syncBehavior.call(this)},e.prototype.setSprite=function(t,e){var n=this;return void 0===e&&(e=0),new Promise(function(o,a){return t===n.icon&&n.image&&n.meta?o(n.icon):(n.icon=t,t?(n.meta=n.host.world.sprites.getSpriteMeta(t),void n.host.world.sprites.getSpriteSheet(n.meta.source).then(function(t){n.image=t[0].data,n.frame=e,o(n.icon)}).catch(a)):(n.meta=null,o(null)))})},e}(a.a)},,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var o=n(22);n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return r}),n.d(e,"d",function(){return s});var a=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();a.typeId=n.i(o.a)("ENTITY_ADD_BEING");var i=function(){function t(e){this.type=t.typeId,this.payload=e}return t}();i.typeId=n.i(o.a)("ENTITY_REMOVE_BEING");var r=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();r.typeId=n.i(o.a)("ENTITY_ADD_ITEM");var s=function(){function t(e){this.type=t.typeId,this.payload=e}return t}();s.typeId=n.i(o.a)("ENTITY_REMOVE_ITEM")},function(t,e,n){"use strict";var o=n(22);n.d(e,"b",function(){return a}),n.d(e,"d",function(){return i}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return s}),n.d(e,"e",function(){return c});var a=function(){function t(e){this.type=t.typeId,this.payload=e}return t}();a.typeId=n.i(o.a)("GAME_DATA_FETCH");var i=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();i.typeId=n.i(o.a)("GAME_DATA_FETCH_SUCCESS");var r=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();r.typeId=n.i(o.a)("GAME_DATA_FETCH_FAIL");var s=function(){function t(e,n){this.type=t.typeId,this.payload={sheet:e,data:n}}return t}();s.typeId=n.i(o.a)("DATA_ADD_SHEET");var c=function(){function t(e){this.type=t.typeId,this.payload=e}return t}();c.typeId=n.i(o.a)("DATA_REMOVE_SHEET")},function(t,e,n){"use strict";var o=n(22);n.d(e,"a",function(){return a}),n.d(e,"d",function(){return i}),n.d(e,"b",function(){return r}),n.d(e,"c",function(){return s});var a=function(){function t(e){this.payload=e,this.type=t.typeId}return t}();a.typeId=n.i(o.a)("SPRITE_REGISTER_MAP");var i=function(){function t(e){this.type=t.typeId,this.payload=e}return t}();i.typeId=n.i(o.a)("SPRITES_LOAD");var r=function(){function t(e){this.type=t.typeId,this.payload=e}return t}();r.typeId=n.i(o.a)("SPRITES_LOAD_SUCCESS");var s=function(){function t(e){this.type=t.typeId,this.payload=e}return t}();s.typeId=n.i(o.a)("SPRITES_LOAD_FAIL")},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(1)),i=n(61),r=n(169),s=n(47);n.d(e,"a",function(){return c});var c=u=function(t){function e(e){var n=t.call(this)||this;return n.combatService=e,n.name=u.NAME,n}return __extends(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),this.machine=e,e.currentDone=!1,e.current.scale=1.25,this.current=e.current,e.current&&e.isFriendlyTurn()&&(e.focus=e.current),e.trigger("combat:beginTurn",e.current);var n=null;if(e.isFriendlyTurn()?(console.log("TURN: "+e.current.model.name),n=e.playerChoices[e.current._uid]):(n=e.current.findBehavior(r.a),n&&(n.to=e.getRandomPartyMember(),n.from=e.current)),!n)throw new Error("Invalid Combat Action Choice. This should not happen.");n.to&&this.combatService.isDefeated(n.to.model)&&(n.to=e.getRandomEnemy()),o.defer(function(){n.act(function(t,e){e&&console.error(e)})})},e.prototype.exit=function(e){this.current.scale=1,t.prototype.exit.call(this,e)},e}(i.a);c.NAME="Combat Begin Turn",c=u=__decorate([n.i(a.Z)({selector:"combat-begin-turn-state",template:"\n    <ng-content></ng-content>"}),__metadata("design:paramtypes",[s.a])],c);var u},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(1)),i=n(93),r=n(61),s=n(125),c=n(456),u=n(11),p=n(35),d=(n.n(p),n(91));n.d(e,"a",function(){return l});var l=h=function(t){function e(e,n){var o=t.call(this)||this;return o.renderer=e,o.combat=n,o.name=h.NAME,o.pending=[],o.machine=null,o.items=[],o.pointAt=null,o.pointOffset=new u.a,o._pointerPosition$=new p.BehaviorSubject(new u.a),o.pointerPosition$=o._pointerPosition$.distinctUntilChanged(),o}return __extends(e,t),e.prototype.ngAfterViewInit=function(){var t=this;this._timerSubscription=p.Observable.interval(50).do(function(){if(t.pointAt&&t.combat){var e=new u.a(t.pointAt.point);e.y=e.y-t.combat.camera.point.y+t.pointOffset.y,e.x=e.x-t.combat.camera.point.x+t.pointOffset.x;var n=t.combat.worldToScreen(e,t.combat.cameraScale);t._pointerPosition$.next(n)}}).subscribe()},e.prototype.ngOnDestroy=function(){this._timerSubscription.unsubscribe()},e.prototype.enter=function(e){var n=this;if(t.prototype.enter.call(this,e),!e.scene)throw new Error("Invalid Combat Scene");this.machine=e;var a=e.getLiveParty().concat(e.getLiveEnemies());e.turnList=o.shuffle(a),e.current=e.turnList.shift(),e.currentDone=!0,this.pending=e.getLiveParty(),e.playerChoices={};var i,r={choose:function(t){e.playerChoices[t.from._uid]=t,n.pending=o.filter(n.pending,function(e){return t.from._uid!==e._uid}),console.log(t.from.model.name+" chose "+t.getActionName()),0===n.pending.length&&e.setCurrentState(s.a.NAME)},players:this.pending,enemies:e.getLiveEnemies()},u=r.players.slice(),p=function(){var t=u.shift();t&&(i.current=t,i.setCurrentState(c.a.NAME))},d=function(t){i.data.choose(t),p()};i=new c.b(this,e.scene,r,d),p()},e.prototype.exit=function(e){return this.machine=null,t.prototype.exit.call(this,e)},e.prototype.setPointerTarget=function(t,e,n){void 0===e&&(e="right"),void 0===n&&(n=new u.a);var o=this.pointerElementRef.nativeElement;this.renderer.setElementClass(o,"left",!1),this.renderer.setElementClass(o,"right",!1),this.renderer.setElementClass(o,e,!0),this.pointAt=t,this.pointOffset=n},e.prototype.addPointerClass=function(t){this.renderer.setElementClass(this.pointerElementRef.nativeElement,t,!0)},e.prototype.removePointerClass=function(t){this.renderer.setElementClass(this.pointerElementRef.nativeElement,t,!1)},e.prototype.hidePointer=function(){this.renderer.setElementClass(this.pointerElementRef.nativeElement,"hidden",!0)},e.prototype.showPointer=function(){this.renderer.setElementClass(this.pointerElementRef.nativeElement,"hidden",!1)},e}(r.a);l.NAME="Combat Choose Actions",__decorate([n.i(a._14)("combatPointer"),__metadata("design:type",a.K)],l.prototype,"pointerElementRef",void 0),__decorate([n.i(a.M)(),__metadata("design:type",Array)],l.prototype,"items",void 0),__decorate([n.i(a.M)(),__metadata("design:type",i.a)],l.prototype,"pointAt",void 0),l=h=__decorate([n.i(a.Z)({selector:"combat-choose-action-state",styles:[n(909)],template:'<ul *ngIf="items.length > 0" class="ebp action-menu">\n  <li *ngFor="let item of items" (click)="item.select()" [innerText]="item.label"></li>\n</ul>\n<span #combatPointer\n      class="point-to-player"\n      [class.hidden]="!pointAt"\n      [style.left]="(pointerPosition$ | async)?.x + \'px\'"\n      [style.top]="(pointerPosition$ | async)?.y + \'px\'"\n></span>\n<ng-content></ng-content>'}),__param(1,n.i(a.e)(n.i(a._13)(function(){return d.a}))),__metadata("design:paramtypes",[a.L,d.a])],l);var h},function(t,e,n){"use strict";var o=n(4);n.n(o);n.d(e,"a",function(){return a});var a=function(){function t(){}return t.prototype.on=function(t,e,n){if(!r(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var o=this._events[t]||(this._events[t]=[]);return o.push({callback:e,context:n,ctx:n||this}),this},t.prototype.once=function(t,e,n){if(!r(this,"once",t,[e,n])||!e)return this;var a=this,i=o.once(function(){a.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,n)},t.prototype.off=function(t,e,n){var a,i,s,c,u,p,d,l;if(!this._events||!r(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(c=t?[t]:o.keys(this._events),u=0,p=c.length;u<p;u++)if(t=c[u],s=this._events[t]){if(this._events[t]=a=[],e||n)for(d=0,l=s.length;d<l;d++)i=s[d],(e&&e!==i.callback&&e!==i.callback._callback||n&&n!==i.context)&&a.push(i);a.length||delete this._events[t]}return this},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!this._events)return this;var e=Array.prototype.slice.call(arguments,1);if(!r(this,"trigger",t,e))return this;var o=this._events[t],a=this._events.all;return o&&s(o,e),a&&s(a,arguments),this},t}(),i=/\s+/,r=function(t,e,n,o){if(!n)return!0;if("object"==typeof n){for(var a in n)t[e].apply(t,[a,n[a]].concat(o));return!1}if(i.test(n)){for(var r=n.split(i),s=0,c=r.length;s<c;s++)t[e].apply(t,[r[s]].concat(o));return!1}return!0},s=function(t,e){var n,o=-1,a=t.length,i=e[0],r=e[1],s=e[2];switch(e.length){case 0:for(;++o<a;)(n=t[o]).callback.call(n.ctx);return;case 1:for(;++o<a;)(n=t[o]).callback.call(n.ctx,i);return;case 2:for(;++o<a;)(n=t[o]).callback.call(n.ctx,i,r);return;case 3:for(;++o<a;)(n=t[o]).callback.call(n.ctx,i,r,s);return;default:for(;++o<a;)(n=t[o]).callback.apply(n.ctx,e);return}}},function(t,e,n){"use strict";var o=n(1),a=n(39),i=n(121),r=n(31),s=(n(281),n(280),n(63),n(11));n.d(e,"b",function(){return s.a});n(38),n(97),n(183),n(284),n(282),n(179),n(283),n(129),n(182),n(180),n(181);n.d(e,"a",function(){return u});var c=[a.a],u=p=function(){function t(){}return t.forRoot=function(){return{ngModule:p,providers:c}},t}();u=p=__decorate([n.i(o.x)({providers:c,imports:[i.b,r.c]})],u);var p},function(t,e,n){"use strict";var o=n(97),a=n(4),i=(n.n(a),n(100));n.n(i);n.d(e,"a",function(){return r});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.fetch=function(t){var e=this;return this.url=t||this.url,new Promise(function(t,n){var o=i.get(e.url);o.done(function(o){e.data=i(o),e.load(e.data).then(t).catch(n)}),o.fail(function(t,e,o){n(o)})})},e.prototype.load=function(t){return Promise.resolve(this)},e.prototype.getRootNode=function(t){return this.data?i(a.find(this.data,function(e){return e.tagName&&e.tagName.toLowerCase()===t})):null},e.prototype.getChildren=function(t,e){var n=t.find(e);return a.compact(a.map(n,function(e){var n=i(e);return n.parent()[0]!==t[0]?null:n}))},e.prototype.getChild=function(t,e){return this.getChildren(t,e)[0]},e.prototype.getElAttribute=function(t,e){if(t){var n=t.attr(e);if(n)return n}return null},e}(o.a)},function(t,e,n){"use strict";(function(t){var o=n(4),a=(n.n(o),n(289)),i=n(11);n.d(e,"b",function(){return r}),n.d(e,"a",function(){return s});var r;(function(t){t[t.UP=38]="UP",t[t.DOWN=40]="DOWN",t[t.LEFT=37]="LEFT",t[t.RIGHT=39]="RIGHT",t[t.BACKSPACE=8]="BACKSPACE",t[t.COMMA=188]="COMMA",t[t.DELETE=46]="DELETE",t[t.END=35]="END",t[t.ENTER=13]="ENTER",t[t.ESCAPE=27]="ESCAPE",t[t.HOME=36]="HOME",t[t.SPACE=32]="SPACE",t[t.TAB=9]="TAB"})(r||(r={}));var s=function(){function e(){var t=this;this._keysDown={},this._mouseElements=[],window.addEventListener("keydown",function(e){t._keysDown[e.which]=!0}),window.addEventListener("keyup",function(e){t._keysDown[e.which]=!1});var n=this._mouseElements;window.addEventListener("mousemove touchmove",function(t){for(var o=n.length,a=0;a<o;a++){var i=n[a];t.srcElement===i.view.canvas?e.mouseOnView(t,i.view,i):(i.point.set(-1,-1),i.world.set(-1,-1))}})}return e.mouseOnView=function(e,n,o){var a=e.srcElement,r=e.touches;r&&r.length>0&&(e=r[0]);var s=o||{point:new i.a,world:new i.a},c=t(a).offset(),u=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft-Math.floor(c.left),p=e.clientY+document.body.scrollTop+document.documentElement.scrollTop-Math.floor(c.top);s.point.set(u,p);var d=n.screenToWorld(s.point,n.cameraScale).add(n.camera.point).round();return s.world.set(d.x,d.y),s},e.prototype.mouseHook=function(t,e){var n=o.where(this._mouseElements,{name:e}),a={name:e,view:t,point:new i.a(-1,-1),world:new i.a(-1,-1)};return n.length>0?n[0]=a:this._mouseElements.push(a),a},e.prototype.mouseUnhook=function(t){this._mouseElements=o.filter(this._mouseElements,function(e){return t instanceof a.a?e.view._uid===t._uid:e.name===t})},e.prototype.getMouseHook=function(t){return o.find(this._mouseElements,function(e){return t instanceof a.a?e.view._uid===t._uid:e.name===t})},e.prototype.keyDown=function(t){return!!this._keysDown[t]},e}()}).call(e,n(100))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(11)),i=n(75),r=n(1);n.d(e,"a",function(){return s});var s=c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tasks=[],e._animationKeys=[],e._currentAnimation=null,e}return __extends(e,t),e.prototype.play=function(t){var e=t;e.elapsed=0,e.move&&(e.startFrame=this.host.frame,e.start=new a.a(this.host.point),e.target=new a.a(this.host.point).clone().add(e.move),e.value=new a.a(this.host.point)),"undefined"==typeof e.duration&&(e.duration=0),this._tasks.push(e)},e.prototype.stop=function(t){for(var e=0;e<this._tasks.length;e++){var n=this._tasks[e];n.name===t.name&&(n.complete=!0)}},e.prototype.removeCompleteTasks=function(){for(var t=0;t<this._tasks.length;t++){var e=this._tasks[t];e.complete===!0&&(this._tasks.splice(t,1),e.done&&e.done(e),e.callback&&e.callback(e),this.trigger(c.EVENTS.Stopped,{task:e,component:this}),t--)}},e.prototype.interpolateTick=function(e){t.prototype.interpolateTick.call(this,e),this.update(e),this.removeCompleteTasks()},e.prototype.update=function(t){var e=this;0!==this._tasks.length&&o.each(this._tasks,function(n){if(n.elapsed>n.duration&&(n.complete=!0,n.elapsed=n.duration),n.duration>0){var o=n.elapsed/n.duration;if(n.move&&n.move instanceof a.a){var i=n.value.interpolate(n.start,n.target,o);e.host.point.x=i.x,e.host.point.y=i.y}if(n.frames&&n.frames.length){var r=Math.round(e.interpolate(0,n.frames.length-1,o)),s=n.frames[r];e.host.frame=s}}n.complete||(n.elapsed+=t)})},e.prototype.interpolate=function(t,e,n){return n=Math.min(Math.max(n,0),1),t*(1-n)+e*n},e.prototype.playChain=function(t,e){"undefined"!=typeof e&&t.push({name:"Chain Callback",duration:0,callback:e}),this._animationKeys=t,this._animateNext()},e.prototype._animateNext=function(){var t=this;0!==this._animationKeys.length&&(this._currentAnimation=this._animationKeys.shift(),this._currentAnimation.done=function(){o.defer(function(){t._animateNext()})},this.play(this._currentAnimation))},e}(i.a);s.EVENTS={Started:"start",Stopped:"stop",Repeated:"repeat"},s=c=__decorate([n.i(r.Z)({selector:"animated-behavior",template:"<ng-content></ng-content>"})],s);var c},function(t,e,n){"use strict";var o=n(102),a=n(42),i=n(38),r=n(1);n.d(e,"a",function(){return s});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.collideBox=new i.a(0,0,1,1),e.resultsArray=[],e}return __extends(e,t),e.prototype.collide=function(t,e,n,a){return void 0===n&&(n=o.a),void 0===a&&(a=[]),!(!this.host||!this.host.scene)&&(this.collideBox.point.x=t,this.collideBox.point.y=e,this.host.scene.db.queryRect(this.collideBox,n,a))},e.prototype.collideFirst=function(t,e,n){if(void 0===n&&(n=o.a),!this.host||!this.host.scene)return null;this.collideBox.point.x=t,this.collideBox.point.y=e,this.resultsArray.length=0;var a=this.host.scene.db.queryRect(this.collideBox,n,this.resultsArray);return a?this.resultsArray[0]:null},e}(a.a);s=__decorate([n.i(r.Z)({selector:"collision-behavior",template:"<ng-content></ng-content>"})],s)},function(t,e,n){"use strict";var o=n(1),a=n(31),i=n(159),r=n(160),s=n(238);n.d(e,"a",function(){return u});var c=[i.a,r.a,s.a],u=p=function(){function t(){}return t.forRoot=function(){return{ngModule:p}},t}();u=p=__decorate([n.i(o.x)({declarations:c,exports:c,imports:[a.c]})],u);var p},function(t,e,n){"use strict";var o=n(1),a=n(31),i=n(240),r=n(163),s=n(242),c=n(245),u=n(247),p=n(244),d=n(249),l=n(234),h=n(434),m=n(438),f=n(248);n.d(e,"a",function(){return v});var y=i.a.concat(r.b,s.a,p.a,c.a,u.a,f.a,d.a),b=r.c.concat(s.b),v=g=function(){function t(){}return t.forRoot=function(){return{ngModule:g}},t}();v=g=__decorate([n.i(o.x)({declarations:y,exports:y,providers:b,imports:[m.a,a.c,h.FlexLayoutModule,l.a,l.b,l.c,l.d,l.e,l.f,l.g]})],v);var g},function(t,e,n){"use strict";var o=n(241),a=n(46);n.d(e,"a",function(){return a.a}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return r});var i=[o.a],r=[a.a]},function(t,e,n){"use strict";function o(t){var e=__assign({},t,{enemies:r.List(t.enemies),party:r.List(t.party)});return c(e)}function a(t,e){switch(void 0===t&&(t=c()),e.type){case i.b.typeId:return t.merge(__assign({loading:!0},e.payload));case i.c.typeId:return t.merge({loading:!0});case i.a.typeId:return t;case i.d.typeId:return c();case i.e.typeId:var o=e.payload,a=function(t){return t.eid===o.defender.eid};n.i(s.c)("none"!==t.type,"invalid encounter for attack action");var r=t.enemies.findIndex(a);if(r!==-1){o.defender;return t.update("enemies",function(t){var e=t.get(r);n.i(s.c)(e,"invalid target for attack action");var a=Math.max(e.hp-o.damage,0);return t.set(r,__assign({},e,{hp:a}))})}if(r=t.party.findIndex(a),r!==-1){o.defender;return t.update("party",function(t){var e=t.get(r);n.i(s.c)(e,"invalid target for attack action");var a=Math.max(e.hp-o.damage,0);return t.set(r,__assign({},e,{hp:a}))})}return n.i(s.c)(r!==-1,"attack target found in neither enemies nor party lists"),t;default:return n.i(s.e)(e),t}}var i=n(72),r=n(45),s=(n.n(r),n(22));e.e=o,e.d=a,n.d(e,"a",function(){return u}),n.d(e,"c",function(){return p}),n.d(e,"b",function(){return d});var c=n.i(s.d)({loading:!1,enemies:r.List(),party:r.List(),type:"none",message:[],gold:0,experience:0,items:[],zone:"",id:""}),u=function(t){return t.loading},p=function(t){return t.enemies},d=function(t){return t.party}},function(t,e,n){"use strict";function o(t){var e={beings:d(n.i(r.a)(t.beings)),items:l(n.i(r.a)(t.items))};return h(e)}function a(t,e){switch(void 0===t&&(t=h()),e.type){case i.a.typeId:var o=e.payload;return t.updateIn(["beings"],function(t){return n.i(r.b)(t,o,o.eid)});case i.b.typeId:var a=e.payload;return t.updateIn(["beings"],function(t){return n.i(r.c)(t,a)});case i.c.typeId:var p=e.payload;return t.updateIn(["items"],function(t){return n.i(r.b)(t,p,p.eid)});case i.d.typeId:var d=e.payload;return t.updateIn(["items"],function(t){return n.i(r.c)(t,d)});case s.v.typeId:var l=t,m=e;return l.updateIn(["beings"],function(e){var o=e;return m.payload.partyIds.forEach(function(e){var a=t.beings.byId.get(e).maxhp,i=t.beings.byId.get(e).maxmp;o=n.i(r.d)(o,{hp:a,mp:i},e)}),o});case s.g.typeId:var l=t,f=t.beings.byId.get(e.payload.entityId);return n.i(u.c)(!!f,"entity does not exist"),n.i(u.c)(!f[e.payload.slot],"entity already has item "+f[e.payload.slot]+" in "+e.payload.slot),l.updateIn(["beings","byId",e.payload.entityId],function(t){return __assign({},t,(n={},n[e.payload.slot]=e.payload.itemId,n));var n});case s.h.typeId:var l=t,f=t.beings.byId.get(e.payload.entityId);return n.i(u.c)(!!f,"entity does not exist"),n.i(u.c)(f[e.payload.slot]===e.payload.itemId,"entity does not have item "+f[e.payload.slot]+" equipped "+e.payload.slot),l.updateIn(["beings","byId",e.payload.entityId],function(t){return __assign({},t,(n={},n[e.payload.slot]=null,n));var n});case c.a.typeId:var l=t,y=e;return l.updateIn(["beings"],function(t){var e=t;return y.payload.party.forEach(function(t){n.i(u.c)(!(!t||!t.eid),"invalid party entity in combat victory action"),e=n.i(r.d)(e,t,t.eid)}),e});default:return n.i(u.e)(e),t}}var i=n(122),r=n(251),s=n(19),c=n(72),u=n(22),p=n(45);n.n(p);e.f=o,e.e=a,n.d(e,"b",function(){return m}),n.d(e,"a",function(){
return f}),n.d(e,"d",function(){return y}),n.d(e,"c",function(){return b});var d=n.i(u.d)({byId:p.Map(),allIds:p.List()}),l=n.i(u.d)({byId:p.Map(),allIds:p.List()}),h=n.i(u.d)({beings:d(),items:l()}),m=function(t){return t.beings.allIds},f=function(t){return t.beings.byId},y=function(t){return t.items.allIds},b=function(t){return t.items.byId}},function(t,e,n){"use strict";function o(t){var e=b({loaded:t.loaded,weapons:u(n.i(r.a)(t.weapons)),items:p(n.i(r.a)(t.items)),armor:d(n.i(r.a)(t.armor)),enemies:l(n.i(r.a)(t.enemies)),magic:h(n.i(r.a)(t.magic)),classes:m(n.i(r.a)(t.classes)),fixedEncounters:f(n.i(r.a)(t.fixedEncounters)),randomEncounters:y(n.i(r.a)(t.randomEncounters))});return e}function a(t,e){void 0===t&&(t=b());var o=t;switch(e.type){case s.b.typeId:case s.c.typeId:return t;case s.d.typeId:return o.merge({loaded:!0});case s.a.typeId:var a=e.payload;return n.i(c.c)(!!t[a.sheet],"unknown collection cannot be added with sheet name: "+a.sheet),o.updateIn([a.sheet],function(t){return a.data.forEach(function(e){t=n.i(r.b)(t,e,e.id)}),t});case s.e.typeId:var i=e.payload;return n.i(c.c)(o.has(i),"cannot remove sheet that does not exist: "+i),o.updateIn([i],function(t){return t.set("byId",t.byId.clear()).set("allIds",t.allIds.clear())});default:return n.i(c.e)(e),t}}var i=n(45),r=(n.n(i),n(251)),s=n(123),c=n(22);e.t=o,e.s=a,n.d(e,"b",function(){return v}),n.d(e,"a",function(){return g}),n.d(e,"d",function(){return _}),n.d(e,"c",function(){return x}),n.d(e,"f",function(){return w}),n.d(e,"e",function(){return k}),n.d(e,"h",function(){return S}),n.d(e,"g",function(){return E}),n.d(e,"j",function(){return I}),n.d(e,"i",function(){return T}),n.d(e,"l",function(){return M}),n.d(e,"k",function(){return $}),n.d(e,"n",function(){return A}),n.d(e,"m",function(){return F}),n.d(e,"p",function(){return C}),n.d(e,"o",function(){return O}),n.d(e,"r",function(){return D}),n.d(e,"q",function(){return B});var u=n.i(c.d)({byId:i.Map(),allIds:i.List()}),p=n.i(c.d)({byId:i.Map(),allIds:i.List()}),d=n.i(c.d)({byId:i.Map(),allIds:i.List()}),l=n.i(c.d)({byId:i.Map(),allIds:i.List()}),h=n.i(c.d)({byId:i.Map(),allIds:i.List()}),m=n.i(c.d)({byId:i.Map(),allIds:i.List()}),f=n.i(c.d)({byId:i.Map(),allIds:i.List()}),y=n.i(c.d)({byId:i.Map(),allIds:i.List()}),b=n.i(c.d)({loaded:!1,weapons:u(),items:p(),armor:d(),enemies:l(),magic:h(),classes:m(),fixedEncounters:f(),randomEncounters:y()}),v=function(t){return function(e){return e[t].byId}},g=function(t){return t.loaded},_=function(t){return t.weapons.allIds},x=function(t){return t.weapons.byId},w=function(t){return t.armor.allIds},k=function(t){return t.armor.byId},S=function(t){return t.items.allIds},E=function(t){return t.items.byId},I=function(t){return t.enemies.allIds},T=function(t){return t.enemies.byId},M=function(t){return t.magic.allIds},$=function(t){return t.magic.byId},A=function(t){return t.classes.allIds},F=function(t){return t.classes.byId},C=function(t){return t.randomEncounters.allIds},O=function(t){return t.randomEncounters.byId},D=function(t){return t.fixedEncounters.allIds},B=function(t){return t.fixedEncounters.byId}},function(t,e,n){"use strict";function o(t){var e=__assign({},t,{party:m.List(t.party),inventory:m.List(t.inventory),keyData:m.Map(t.keyData),position:n.i(y.a)(t.position),shipPosition:n.i(y.a)(t.shipPosition)});return b(e)}function a(t,e){switch(void 0===t&&(t=b()),e.type){case h.d.typeId:return o(e.payload);case h.e.typeId:case h.f.typeId:return t;case h.a.typeId:return t.merge({position:n.i(y.a)(e.payload.position),location:e.payload.location});case h.g.typeId:return n.i(f.c)(t.party.find(function(t){return t===e.payload.entityId}),"cannot equip item on entity that is not in the party"),n.i(f.c)(t.inventory.find(function(t){return t===e.payload.itemId}),"item does not exist in inventory"),t.merge({inventory:t.inventory.filter(function(t){return t!==e.payload.itemId})});case h.h.typeId:return n.i(f.c)(t.party.find(function(t){return t===e.payload.entityId}),"cannot remove item from entity that is not in the party"),n.i(f.c)(!t.inventory.find(function(t){return t===e.payload.itemId}),"item already exists in inventory"),t.merge({inventory:t.inventory.push(e.payload.itemId)});case h.b.typeId:case h.c.typeId:case h.i.typeId:case h.j.typeId:case h.k.typeId:case h.l.typeId:case h.m.typeId:case h.n.typeId:case h.o.typeId:case h.p.typeId:case h.q.typeId:return t;case h.r.typeId:return t.merge({position:e.payload});case h.s.typeId:return t.merge({battleCounter:e.payload});case h.t.typeId:return t.merge({keyData:t.keyData.set(e.payload.key,e.payload.value)});case h.u.typeId:return t.merge({gold:t.gold+e.payload});case h.v.typeId:return t.merge({gold:t.gold-e.payload.cost});case h.w.typeId:var a=e.payload;n.i(f.c)(a,"cannot add invalid item to inventory"),n.i(f.c)(a.eid,'item must have an eid. consider using "entityId" or "instantiateEntity" during creation'),n.i(f.c)(a.id,"item must have a template id. see game-data models for more information");var i=!!t.inventory.find(function(t){return t===a.eid});return n.i(f.c)(!i,"item already exists in inventory"),t.merge({inventory:t.inventory.push(a.eid)});case h.x.typeId:var r=e.payload,s=t.inventory.filter(function(t){return t!==r.eid});return n.i(f.c)(s.count()===t.inventory.count()-1,"item does not exist in party inventory to remove"),t.merge({inventory:s});default:return n.i(f.e)(e),t}}function i(t){return t.gold}function r(t){return t.location}function s(t){return t.position}function c(t){return t.shipPosition}function u(t){return t.battleCounter}function p(t){return t.combatZone}function d(t){return t.party}function l(t){return t.inventory}var h=n(19),m=n(45),f=(n.n(m),n(22)),y=n(454);e.k=o,e.j=a,n.d(e,"i",function(){return v}),e.c=i,e.f=r,e.d=s,e.e=c,e.h=u,e.g=p,e.b=d,e.a=l;var b=n.i(f.d)({party:m.List(),inventory:m.List(),keyData:m.Map(),battleCounter:64,gold:0,location:"",combatZone:"",position:n.i(y.a)(),shipPosition:n.i(y.a)()}),v=function(t){return t.keyData}},function(t,e,n){"use strict";function o(t){var e={spritesById:i.Map(t.spritesById),loaded:t.loaded};return n.i(c.b)("",t.spritesById),u(e)}function a(t,e){switch(void 0===t&&(t=u()),e.type){case s.a.typeId:var o=i.Map(e.payload);return o.forEach(function(e,o){n.i(r.c)(!t.spritesById.has(o),"duplicates are not allowed. sprite ("+o+") is already declared")}),t.updateIn(["spritesById"],function(t){return t.merge(e.payload)});case s.b.typeId:return t.merge({loaded:!0});case s.c.typeId:case s.d.typeId:return t;default:return n.i(r.e)(e),t}}var i=n(45),r=(n.n(i),n(22)),s=n(124),c=n(74);e.d=o,e.c=a,n.d(e,"a",function(){return p}),n.d(e,"b",function(){return d});var u=n.i(r.d)({loaded:!1,spritesById:i.Map()}),p=function(t){return t.loaded},d=function(t){return t.spritesById}},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(172)),i=n(74),r=n(290),s=n(103),c=n(445),u=n(288),p=n(257),d=n(256),l=n(1),h=n(91),m=n(7),f=n(72),y=n(37),b=n(47),v=n(16);n.d(e,"a",function(){return g});var g=function(t){function e(e,n,o){var a=t.call(this)||this;return a.store=e,a.combatService=n,a.gameWorld=o,a.name="attack",a}return __extends(e,t),e.prototype.canBeUsedBy=function(e){var n=["lifemage","deathmage"],a=e.model;return(void 0===a.type||o.indexOf(n,a.type)===-1)&&t.prototype.canBeUsedBy.call(this,e)},e.prototype.act=function(t){var e=this;if(!this.isCurrentTurn())return!1;var d=function(n){t&&t(e,n),e.combat.machine.setCurrentState(a.a.NAME)},l=this.from,h=this.to,m=l.findBehavior(p.a),y=function(){e.store.select(n.i(v.c)(l.model.eid)).combineLatest(e.store.select(n.i(v.c)(h.model.eid)),function(t,a){var p=e.combatService.attackCombatant(t||l.model,a||h.model),y=h.model.hp-p<=0,b=p>0,v=!1,g=n.i(i.d)(y?"killed":b?v?"miss":"hit":"miss"),_={attacker:l.model,defender:h.model,damage:p};e.store.dispatch(new f.e(_));var x=b?v?"animSmoke.png":"animHit.png":"animMiss.png",w=e.gameWorld.sprites.getSpriteMeta(x);return w?void e.gameWorld.sprites.getSpriteSheet(w.source).then(function(t){var n=t[0].data,a={animation:new r.a({spriteName:"attack",lengthMS:350}),sprite:new s.a({name:"attack",icon:x,meta:w,image:n}),damage:new c.a,sound:new u.a({url:g,volume:.3})};m&&m.setState("Moving"),h.addComponentDictionary(a),a.damage.once("damage:done",function(){m&&m.setState(),y&&o.defer(function(){h.destroy()}),h.removeComponentDictionary(a)});var i={damage:p,attacker:l,defender:h};e.combat.machine.notify("combat:attack",i,d)}):(console.warn("could not find damage animation in sprites metadata: "+x),d())}).take(1).subscribe()};return m?m.attack(y):o.delay(function(){y()},1e3),!0},e}(d.a);__decorate([n.i(l.M)(),__metadata("design:type",h.a)],g.prototype,"combat",void 0),g=__decorate([n.i(l.Z)({selector:"combat-attack-behavior",template:"<ng-content></ng-content>"}),__metadata("design:paramtypes",[m.a,b.a,y.a])],g)},function(t,e,n){"use strict";var o=n(1),a=n(258),i=n(91),r=n(31),s=n(262),c=n(261),u=n(161),p=n(259),d=n(459),l=n(162),h=n(260);n.d(e,"c",function(){return i.a}),n.d(e,"a",function(){return f}),n.d(e,"b",function(){return y});var m=[a.a,i.a].concat(c.a,p.a,d.a,h.a),f=[s.a],y=b=function(){function t(){}return t.forRoot=function(){return{ngModule:b}},t}();y=b=__decorate([n.i(o.x)({declarations:m,exports:m,imports:[r.c,u.a,l.a]})],y);var b},function(t,e,n){"use strict";var o=n(61),a=n(1);n.d(e,"a",function(){return i});var i=r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=r.NAME,e}return __extends(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e);var n={enemies:e.enemies.toArray(),party:e.party.toArray()};e.notify("combat:defeat",n,function(){alert("defeat is not implemented"),window.location.reload(!0)})},e}(o.a);i.NAME="Combat Defeat",i=r=__decorate([n.i(a.Z)({selector:"combat-defeat-state",template:"<ng-content></ng-content>"})],i);var r},function(t,e,n){"use strict";var o=n(61),a=n(125),i=n(126),r=n(171),s=n(174),c=n(1),u=n(47);n.d(e,"a",function(){return p});var p=d=function(t){function e(e){var n=t.call(this)||this;return n.combatService=e,n.name=d.NAME,n}return __extends(e,t),e.prototype.enter=function(e){for(t.prototype.enter.call(this,e),e.current=null;e.turnList.length>0&&!e.current;)e.current=e.turnList.shift(),e.current&&this.combatService.isDefeated(e.current.model)&&(e.current=null);var n=e.current?a.a.NAME:i.a.NAME;if(e.partyDefeated()?n=r.a.NAME:e.enemiesDefeated()&&(n=s.a.NAME),!n)throw new Error("Invalid transition from end turn");e.setCurrentState(n)},e}(o.a);p.NAME="Combat End Turn",p=d=__decorate([n.i(c.Z)({selector:"combat-end-turn-state",template:"\n    <ng-content></ng-content>"}),__metadata("design:paramtypes",[u.a])],p);var d},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(61)),i=n(126),r=n(1),s=n(28);n.d(e,"a",function(){return c});var c=u=function(t){function e(e){var n=t.call(this)||this;return n.notify=e,n.name=u.NAME,n}return __extends(e,t),e.prototype.enter=function(e){var n=this;t.prototype.enter.call(this,e),o.defer(function(){var t=e.encounter,o=function(){e.setCurrentState(i.a.NAME)};if(t&&t.message){var a=t.message.slice(),r=a.pop();a.forEach(function(t){return n.notify.show(t,null,0)}),n.notify.show(r,o,0)}else o()})},e}(a.a);c.NAME="Combat Started",c=u=__decorate([n.i(r.Z)({selector:"combat-start-state",template:"<ng-content></ng-content>"}),__metadata("design:paramtypes",[s.a])],c);var u},function(t,e,n){"use strict";var o=n(61),a=n(1),i=n(7),r=n(16),s=n(22),c=n(19),u=n(73),p=n(254),d=n(72);n.d(e,"a",function(){return l});var l=h=function(t){function e(e){var n=t.call(this)||this;return n.store=e,n.name=h.NAME,n.items$=n.store.select(r.j).combineLatest(n.store.select(r.k),n.store.select(r.l),function(t,e,n){return n.concat(t).concat(e)}),n}return __extends(e,t),e.prototype.awardExperience=function(t,e){var o=e.exp+t,a=__assign({},e,{exp:o}),i=n.i(p.a)(e.level+1);return o>=i&&(a=this.awardLevelUp(e)),a},e.prototype.awardLevelUp=function(t){var e=t.level+1,o=n.i(p.b)(e,t);return __assign({},t,{level:e,maxhp:o,hp:o,attack:n.i(p.c)(e,t),speed:n.i(p.d)(e,t),defense:n.i(p.e)(e,t),magic:n.i(p.f)(e,t)})},e.prototype.enter=function(e){var o=this;t.prototype.enter.call(this,e),this.store.select(r.g).take(1).combineLatest(this.items$,function(t,a){var i=t.party.toArray(),r=t.enemies.toArray();n.i(s.c)(i.length>0,"no living players during combat victory state");var p=0,l=0,h=[];t.enemies.forEach(function(t){p+=t.gold||0,l+=t.exp||0}),"fixed"===t.type&&(t.gold>0&&(p+=t.gold),t.experience>0&&(l+=t.experience),t.items&&t.items.length>0&&(h=h.concat(t.items))),o.store.dispatch(new c.u(p));var m=[];h.forEach(function(t){var e=a.find(function(e){return e.id===t});n.i(s.c)(!!e,"cannot award unknown item "+t);var i=n.i(u.b)(e);o.store.dispatch(new c.w(i))});var f=Math.round(l/i.length),y=[];i=i.map(function(t){var e=o.awardExperience(f,t);return e.level>t.level&&y.push(e),e});var b={type:e.encounter.type,id:e.encounter.id,party:i,enemies:r,levels:y,items:m,gold:p,exp:l};o.store.dispatch(new d.a(b))}).subscribe()},e}(o.a);l.NAME="Combat Victory",l=h=__decorate([n.i(a.Z)({selector:"combat-victory-state",template:"\n    <ng-content></ng-content>"}),__metadata("design:paramtypes",[i.a])],l);var h},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(285)),i=n(173),r=n(1),s=n(49),c=n(186),u=n(47);n.d(e,"a",function(){return p});var p=function(t){function e(e){var n=t.call(this)||this;return n.combatService=e,n.defaultState=i.a.NAME,n.states=[],n.turnList=[],n.playerChoices={},n.currentDone=!1,n}return __extends(e,t),e.prototype.ngAfterViewInit=function(){this.addStates(this.childStates.toArray()),this.setCurrentState(this.getState(this.defaultState))},e.prototype.isFriendlyTurn=function(){var t=this;return!(!this.current||!this.party.find(function(e){return e._uid===t.current._uid}))},e.prototype.getLiveParty=function(){var t=this;return this.party.filter(function(e){return!t.combatService.isDefeated(e.model)})},e.prototype.getLiveEnemies=function(){var t=this;return this.enemies.filter(function(e){return!t.combatService.isDefeated(e.model)})},e.prototype.getRandomPartyMember=function(){for(var t=o.shuffle(this.party.toArray());t.length>0;){var e=t.shift();if(!this.combatService.isDefeated(e.model))return e}return null},e.prototype.getRandomEnemy=function(){for(var t=o.shuffle(this.enemies.toArray());t.length>0;){var e=t.shift();if(!this.combatService.isDefeated(e.model))return e}return null},e.prototype.partyDefeated=function(){return 0===this.getLiveParty().length},e.prototype.enemiesDefeated=function(){return 0===this.getLiveEnemies().length},e}(a.a);__decorate([n.i(r.M)(),__metadata("design:type",s.a)],p.prototype,"scene",void 0),__decorate([n.i(r.M)(),__metadata("design:type",Object)],p.prototype,"encounter",void 0),__decorate([n.i(r.M)(),__metadata("design:type",r._19)],p.prototype,"party",void 0),__decorate([n.i(r.M)(),__metadata("design:type",r._19)],p.prototype,"enemies",void 0),__decorate([n.i(r.M)(),__metadata("design:type",c.a)],p.prototype,"view",void 0),__decorate([n.i(r._18)("start,beginTurn,chooseAction,endTurn,defeat,victory,escape"),__metadata("design:type",r._19)],p.prototype,"childStates",void 0),p=__decorate([n.i(r.Z)({selector:"combat-state-machine",template:'\n    <combat-start-state #start></combat-start-state>\n    <combat-begin-turn-state #beginTurn></combat-begin-turn-state>\n    <combat-choose-action-state\n      [pointAt]="current"\n      #chooseAction></combat-choose-action-state>\n    <combat-end-turn-state #endTurn></combat-end-turn-state>\n    <combat-defeat-state #defeat></combat-defeat-state>\n    <combat-victory-state #victory></combat-victory-state>\n    <combat-escape-state #escape></combat-escape-state>\n  '}),__metadata("design:paramtypes",[u.a])],p)},function(t,e,n){"use strict";var o=n(75),a=n(467),i=n(1);n.d(e,"a",function(){return s}),n.d(e,"b",function(){return c});var r;(function(t){t[t.LEFT=10]="LEFT",t[t.RIGHT=4]="RIGHT",t[t.DOWN=7]="DOWN",t[t.UP=1]="UP",t[t.LEFTALT=11]="LEFTALT",t[t.RIGHTALT=5]="RIGHTALT",t[t.DOWNALT=8]="DOWNALT",t[t.UPALT=2]="UPALT"})(r||(r={}));var s;(function(t){t[t.WEST=0]="WEST",t[t.EAST=1]="EAST",t[t.SOUTH=2]="SOUTH",t[t.NORTH=3]="NORTH"})(s||(s={}));var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._animator=new a.a,e.heading=s.WEST,e.animating=!1,e}return __extends(e,t),e.prototype.setHeading=function(t,e){switch(this._animator.sourceAnims||this._animator.setAnimationSource(this.host.icon),this.heading=t,this.heading){case s.SOUTH:this._animator.setAnimation("down");break;case s.NORTH:this._animator.setAnimation("up");break;case s.EAST:this._animator.setAnimation("right");break;case s.WEST:this._animator.setAnimation("left");break;default:console.warn("unsupported heading direction: "+this.heading)}this._animator.updateTime(0),this.animating=e},e.prototype.setMoving=function(t){this.animating=t},e.prototype.interpolateTick=function(e){t.prototype.interpolateTick.call(this,e),this.animating&&this._animator.updateTime(e),this.host.frame=this._animator.getFrame()},e}(o.a);c=__decorate([n.i(i.Z)({selector:"player-render-behavior",template:"<ng-content></ng-content>"})],c)},function(t,e,n){"use strict";var o=n(1);n.d(e,"a",function(){return a});var a=function(){function t(){this.eventName=this.whichTransitionEvent()}return t.prototype.enter=function(t,e){var n=this;return new Promise(function(o){t.classList.add(e);var a,i=n.getTransitionDuration(t,!0),r=function(){clearTimeout(a),t.removeEventListener(n.eventName,r),o()};a=setTimeout(function(){return r()},i),t.addEventListener(n.eventName,r)})},t.prototype.leave=function(t,e){var n=this;return new Promise(function(o){var a,i=n.getTransitionDuration(t,!0),r=function(){clearTimeout(a),t.removeEventListener(n.eventName,r),o()};a=setTimeout(function(){return r()},i),t.addEventListener(n.eventName,r),t.classList.remove(e)})},t.prototype.getTransitionDuration=function(t,e){void 0===e&&(e=!1);for(var n=["moz","webkit","ms","o","khtml"],o=window.getComputedStyle(t),a=0;a<n.length;a++){var i=o["-"+n[a]+"-transition-duration"];if(i){if(i=i.indexOf("ms")>-1?parseFloat(i):1e3*parseFloat(i),e){var r=o["-"+n[a]+"-transition-delay"];"undefined"!=typeof r&&(i+=r.indexOf("ms")>-1?parseFloat(r):1e3*parseFloat(r))}return i}}return 0},t.prototype.whichTransitionEvent=function(){var t,e=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in n)if(void 0!==e.style[t])return n[t]},t}();a=__decorate([n.i(o.d)()],a)},function(t,e,n){"use strict";var o=n(74),a=n(38),i=n(1),r=n(39);n.d(e,"a",function(){return s});var s=c=function(){function t(t){this.loader=t,this.canvas=null,this.context=null,this.canvas=document.createElement("canvas"),this.sizeCanvas(c.SIZE,c.SIZE)}return t.getSpriteSheetUrl=function(t){return"assets/images/"+t+".png"},t.prototype.sizeCanvas=function(t,e){this.canvas.width=t,this.canvas.height=e,this.context=this.canvas.getContext("2d"),this.context.msImageSmoothingEnabled=!1,this.context.imageSmoothingEnabled=!1,this.context.webkitImageSmoothingEnabled=!1,this.context.mozImageSmoothingEnabled=!1},t.prototype.getSpriteSheet=function(t){return this.loader.load(c.getSpriteSheetUrl(t))},t.prototype.getSingleSprite=function(t,e){var n=this;void 0===e&&(e=0);var a=o.c.sprites[t];return a?new Promise(function(o,i){n.getSpriteSheet(a.source).then(function(a){var r=a[0],s=n.getSpriteRect(t,e);n.sizeCanvas(s.extent.x,s.extent.y),n.context.clearRect(0,0,n.canvas.width,n.canvas.height),n.context.drawImage(r.data,s.point.x,s.point.y,s.extent.x,s.extent.y,0,0,n.canvas.width,n.canvas.height);var c=n.canvas.toDataURL(),u=new Image;u.src=c,u.onload=function(){o(u)},u.onerror=function(t){i(t)}})}):Promise.reject("Unable to find sprite by name: "+t)},t.prototype.getSpriteRect=function(t,e){void 0===e&&(e=0);var n=this.getSpriteMeta(t),o=n.x,i=c.SIZE,r=c.SIZE,s=n.y;if(n.frames>1){n&&"undefined"!=typeof n.cellWidth&&"undefined"!=typeof n.cellHeight&&(i=n.cellWidth,r=n.cellHeight);var u=n.width/i,p=e%u,d=Math.floor((e-p)/u);o+=p*i,s+=d*r}else i=n.width,r=n.height;return new a.a(o,s,i,r)},t.prototype.getSpriteMeta=function(t){var e=o.c.sprites[t];return e},t}();s.SIZE=16,s=c=__decorate([n.i(i.d)(),__metadata("design:paramtypes",[r.a])],s);var c},function(t,e,n){"use strict";var o=n(97);n.d(e,"a",function(){return a});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.fetch=function(t){var e=this;return this.url=t||this.url,new Promise(function(t,n){var o=new Image;o.onload=function(){e.data=o,t(e)},o.onerror=function(t){n(t)},o.src=e.url})},e}(o.a)},function(t,e,n){"use strict";var o=n(63),a=n(182),i=n(129),r=n(181),s=n(4),c=(n.n(s),n(100));n.n(c);n.d(e,"a",function(){return u});var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.height=0,e.orientation="orthogonal",e.tileheight=16,e.tilewidth=16,e.version=1,e.properties={},e.tilesets={},e.layers=[],e.xmlHeader='<?xml version="1.0" encoding="UTF-8"?>',e}return __extends(e,t),e.prototype.write=function(){var t=this,e=c("<map/>");return n.i(a.c)(e,"version",this.version),n.i(a.c)(e,"orientation",this.orientation),n.i(a.c)(e,"width",this.width),n.i(a.c)(e,"height",this.height),n.i(a.c)(e,"tilewidth",this.tilewidth),n.i(a.c)(e,"tileheight",this.tileheight),n.i(a.d)(e,this.properties),s.each(this.tilesets,function(t){if(!t.literal)throw new Error("Add support for inline TSX writing");if(!t.firstgid)throw new Error(o.a.INVALID_ITEM);var n=c("<tileset/>");n.attr("firstgid",t.firstgid),n.attr("source",t.literal),e.append(n)}),s.each(this.layers,function(i){var r=null;if("undefined"!=typeof i.data){r=c("<layer/>"),n.i(a.e)(r,i);var u=c("<data/>"),p=t.width*t.height;if(i.data.length!==p)throw new Error(o.a.INVALID_ITEM);u.attr("encoding","csv"),u.text(i.data.join(",")),r.append(u)}else{if("undefined"==typeof i.objects)throw new Error(o.a.INVALID_ITEM);r=c("<objectgroup/>"),s.each(i.objects,function(t){var e=c("<object/>");n.i(a.e)(e,t),n.i(a.d)(e,t.properties),r.append(e)})}n.i(a.f)(r,i),e.append(r)}),this.xmlHeader+n.i(a.g)(e[0])},e.prototype.load=function(t){var e=this;return this.data=t||this.data,new Promise(function(t,o){e.$map=e.getRootNode("map"),e.version=parseInt(e.getElAttribute(e.$map,"version"),10),e.width=parseInt(e.getElAttribute(e.$map,"width"),10),e.height=parseInt(e.getElAttribute(e.$map,"height"),10),e.orientation=e.getElAttribute(e.$map,"orientation"),e.tileheight=parseInt(e.getElAttribute(e.$map,"tileheight"),10),e.tilewidth=parseInt(e.getElAttribute(e.$map,"tilewidth"),10),e.properties=n.i(a.a)(e.$map);var i=[],u=e.getChildren(e.$map,"tileset"),p=e.url.substr(0,e.url.lastIndexOf("/")+1);s.each(u,function(t){var o=e.getElAttribute(t,"source"),r=parseInt(e.getElAttribute(t,"firstgid")||"-1",10);o?i.push({source:n.i(a.b)(p,o),literal:o,firstgid:r}):i.push({data:t,source:p,firstgid:r})});var d=e.getChildren(e.$map,"layer,objectgroup"),l=!1;if(s.each(d,function(t){if(!l){var i=n.i(a.h)(t);e.layers.push(i);var r=e.getChild(t,"data");if(r){var u=e.getElAttribute(r,"encoding");if(!u||"csv"!==u.toLowerCase())return l=!0,o("pow-core only supports CSV maps. Edit the Map Properties (for:"+e.url+") to use the CSV");i.data=JSON.parse("["+c.trim(r.text())+"]")}var p=e.getElAttribute(t,"color");p&&(i.color=p);var d=e.getChildren(t,"object");d&&(i.objects=[],s.each(d,function(t){i.objects.push(n.i(a.i)(t))}))}}),!l){var h=function(){if(i.length<=0)return t(e);var n=i.shift();n.data?(new r.a).load(n.data).then(function(t){t.relativeTo=p,t.firstgid=n.firstgid,e.tilesets[t.name]=t,h()}).catch(function(t){return o(t)}):n.source?(new r.a).fetch(n.source).then(function(t){e.tilesets[t.name]=t,t.firstgid=n.firstgid,t.literal=n.literal,h()}).catch(function(t){return o(t)}):o("Unknown type of tile set data")};h()}})},e}(i.a)},function(t,e,n){"use strict";var o=n(129),a=n(179),i=n(4),r=(n.n(i),n(182));n.d(e,"a",function(){return c});var s=function(){function t(t){this.properties={},this.id=t}return t}(),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=null,e.tilewidth=16,e.tileheight=16,e.imageWidth=0,e.imageHeight=0,e.image=null,e.firstgid=-1,e.tiles=[],e.relativeTo=null,e.imageUrl=null,e.literal=null,e}return __extends(e,t),e.prototype.load=function(t){var e=this;return this.data=t||this.data,new Promise(function(t,o){var c=e.getRootNode("tileset");e.name=e.getElAttribute(c,"name"),e.tilewidth=parseInt(e.getElAttribute(c,"tilewidth"),10),e.tileheight=parseInt(e.getElAttribute(c,"tileheight"),10);var u=e.url?e.url.substr(0,e.url.lastIndexOf("/")+1):"",p=e.getChildren(c,"tile");i.each(p,function(t){var o=parseInt(e.getElAttribute(t,"id"),10),a=new s(o);a.properties=n.i(r.a)(t),e.tiles.push(a)});var d=e.getChild(c,"img");if(!d||0===d.length)return t(e);var l=e.getElAttribute(d,"source");e.imageWidth=parseInt(e.getElAttribute(d,"width")||"0",10),e.imageHeight=parseInt(e.getElAttribute(d,"height")||"0",10),e.imageUrl=n.i(r.b)(e.relativeTo?e.relativeTo:u,l),console.log("Tileset source: "+e.imageUrl),new a.a(e.imageUrl).fetch().then(function(n){e.image=n,e.imageWidth=e.image.data.width,e.imageHeight=e.image.data.height;for(var o=e.imageWidth/e.tilewidth,a=e.imageHeight/e.tileheight,r=o*a,s=new Array(r),c=0;c<r;c++)s[c]=!1;i.each(e.tiles,function(t){s[t.id]=t.properties}),e.tiles=s,t(e)}).catch(function(t){o("Failed to load required TileMap image: "+l+" - "+t)})})},e.prototype.hasGid=function(t){return this.firstgid!==-1&&t>=this.firstgid&&t<this.firstgid+this.tiles.length},e.prototype.getTileMeta=function(t){var e=this.firstgid!==-1?t-this.firstgid:t,n=this.imageWidth/this.tilewidth,o=e%n,a=Math.floor((e-o)/n);return i.extend(this.tiles[e]||{},{image:this.image,url:this.imageUrl,x:o*this.tilewidth,y:a*this.tileheight,width:this.tilewidth,height:this.tileheight})},e}(o.a)},function(t,e,n){"use strict";function o(t){return{name:y(t,"name"),x:parseInt(y(t,"x")||"0",10),y:parseInt(y(t,"y")||"0",10),width:parseInt(y(t,"width")||"0",10),height:parseInt(y(t,"height")||"0",10),visible:1===parseInt(y(t,"visible")||"1",10),_xml:t}}function a(t,e){f(t,"name",e.name),e.type&&f(t,"type",e.type),0!==e.x&&f(t,"x",e.x),0!==e.y&&f(t,"y",e.y),f(t,"width",e.width),f(t,"height",e.height),e.visible===!1&&f(t,"visible",e.visible),"undefined"!=typeof e.color&&f(t,"color",e.color)}function i(t,e){a(t,e)}function r(t){var e=s(t),n=y(t,"type");return n&&(e.type=n),e}function s(t){var e=o(t);e.opacity=parseInt(y(t,"opacity")||"1",10);var n=d(t);return n&&(e.properties=n),e}function c(t,e){var n=t.split("/"),o=e.split("/");n.pop();for(var a=0;a<o.length;a++)"."!==o[a]&&(".."===o[a]?n.pop():n.push(o[a]));return n.join("/")}function u(t){try{return(new XMLSerializer).serializeToString(t)}catch(e){try{return t.xml}catch(t){throw new Error("Xmlserializer not supported")}}}function p(t,e){a(t,e),f(t,"opacity",e.opacity),l(t,e.properties)}function d(t){var e=m(t,"properties");if(e&&e.length>0){var n={},o=h(e,"property");return b.each(o,function(t){var e=y(t,"name"),o=y(t,"value");if("string"==typeof o){var a=o.toLowerCase(),i=parseFloat(o);"true"===a||"false"===a?o="true"===a:isNaN(i)||(o=i)}n[e]=o}),n}return null}function l(t,e){var n=v("<properties/>");b.each(e,function(t,e){var o=v("<property/>");f(o,"name",e),f(o,"value",t),n.append(o)}),n.children().length>0&&t.append(n)}function h(t,e){var n=t.find(e);return b.compact(b.map(n,function(e){var n=v(e);return n.parent()[0]!==t[0]?null:n}))}function m(t,e){return h(t,e)[0]}function f(t,e,n){t.attr(e,n)}function y(t,e){return t.attr(e)||null}var b=n(4),v=(n.n(b),n(100));n.n(v);e.e=i,e.i=r,e.h=s,e.b=c,e.g=u,e.f=p,e.a=d,e.d=l,e.c=f},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(1));n.d(e,"a",function(){return r});var i=null,r=s=function(){function t(){this.tickRateMS=32,this.mspf=0,this.world=null,this.lastTime=0,this.time=0,this.running=!1,this.objects=[],this.polyFillAnimationFrames()}return t.get=function(){return i||(i=new s),i},t.prototype.start=function(){var t=this;if(!this.running){this.running=!0;var e=function(n){if(t.running){t.time=Math.floor(n);var o=(new Date).getMilliseconds(),a=Math.floor(n-t.lastTime);a>=t.tickRateMS&&(t.lastTime=n,t.tickObjects(a)),t.processFrame(a),t.mspf=(new Date).getMilliseconds()-o,window.requestAnimationFrame(e)}};return e(0),this}},t.prototype.stop=function(){return this.running=!1,this},t.prototype.removeObject=function(t){return this.objects=o.reject(this.objects,function(e){return e._uid===t._uid}),this},t.prototype.addObject=function(t){return t._uid||(t._uid=o.uniqueId("u")),0===o.where(this.objects,{_uid:t._uid}).length&&this.objects.push(t),this},t.prototype.tickObjects=function(t){for(var e=this.objects,n=e.length-1;n>=0;--n)e[n].tick&&e[n].tick(t);return this},t.prototype.processFrame=function(t){for(var e=this.objects,n=e.length-1;n>=0;--n)e[n].processFrame&&e[n].processFrame(t);return this},t.prototype.polyFillAnimationFrames=function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length;n++){if(window.requestAnimationFrame)return;window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),o=Math.max(0,16-(n-t)),a=function(){e(n+o)},i=window.setTimeout(a,o);return t=n+o,i})},t}();r=s=__decorate([n.i(a.d)(),__metadata("design:paramtypes",[])],r);var s},function(t,e,n){"use strict";var o=n(42),a=n(11);n.d(e,"a",function(){return i});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.process=function(t){t.camera.point.set(this.host.point),t.cameraScale=t.context.canvas.width>768?4:2;var e=new a.a(t.context.canvas.width,t.context.canvas.height),n=t.screenToWorld(e,t.cameraScale);t.camera.extent.set(n)},e}(o.a)},function(t,e,n){"use strict";var o=n(11);n.d(e,"a",function(){return a});var a=function(){function t(){this._renderPoint=new o.a}return t.prototype.render=function(t,e,n,o){if(t&&t.visible!==!1&&t.image){this._renderPoint.set(e);var a=this._renderPoint,i=n.unitSize,r=n.unitSize;o&&"undefined"!=typeof o.cellWidth&&"undefined"!=typeof o.cellHeight&&(i=o.cellWidth,r=o.cellHeight);var s=n.fastScreenToWorldNumber(i),c=n.fastScreenToWorldNumber(r);if(a.x-=s*t.scale/2,a.y-=c*t.scale/2,n.fastWorldToScreenPoint(a,a),t.icon&&o){var u=o.x,p=o.y;if(o.frames>1){var d=o.width/i,l=t.frame%d,h=Math.floor((t.frame-l)/d);u+=l*i,p+=h*r}n.context.drawImage(t.image,u,p,i,r,a.x,a.y,i*t.scale,r*t.scale)}else n.context.drawImage(t.image,a.x,a.y,i*t.scale,r*t.scale)}},t}()},function(t,e,n){"use strict";var o=n(289),a=n(292),i=n(184),r=n(128);n.d(e,"a",function(){return s});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapRenderer=new a.a,e._bounds=new r.b,e}return __extends(e,t),e.prototype._onResize=function(t){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this._bounds.set(this.canvas.width,this.canvas.height),this._bounds=this.screenToWorld(this._bounds);var e=this.context;e.webkitImageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1},e.prototype.getCameraClip=function(){if(!this.map)return this.camera;var t=this.camera.clone();t.point.round(),t.extent.round();var e=this.map.bounds;return t.point.x<e.point.x&&(t.point.x+=e.point.x-t.point.x),t.point.y<e.point.y&&(t.point.y+=e.point.y-t.point.y),t.point.x+t.extent.x>e.point.x+e.extent.x&&(t.point.x-=t.point.x+t.extent.x-(e.point.x+e.extent.x)),t.point.y+t.extent.y>e.point.y+e.extent.y&&(t.point.y-=t.point.y+t.extent.y-(e.point.y+e.extent.y)),t},e.prototype.processCamera=function(){this.cameraComponent=this.findBehavior(i.a),!this.cameraComponent&&this.map&&(this.cameraComponent=this.map.findBehavior(i.a)),this.cameraComponent||(this.cameraComponent=this.scene.componentByType(i.a)),t.prototype.processCamera.call(this)},e.prototype.setRenderState=function(){if(t.prototype.setRenderState.call(this),this.camera&&this.context&&this.map){
var e=this.worldToScreen(this.camera.point),n=this.worldToScreen(this.map.bounds.point);n.x=parseFloat(n.x.toFixed(2)),n.y=parseFloat(n.y.toFixed(2)),e.x=parseFloat(e.x.toFixed(2)),e.y=parseFloat(e.y.toFixed(2)),this.context.translate(n.x-e.x,n.y-e.y)}},e.prototype.renderFrame=function(t){if(this.clearRect(),this.map)return this.mapRenderer.render(this.map,this),this},e.prototype.renderPost=function(){},e}(o.a)},function(t,e,n){"use strict";var o=n(76),a=n(42);n.d(e,"a",function(){return i});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.syncBehavior=function(){return!!this.host.tileMap&&this.host.tileMap instanceof o.a},e.prototype.disconnectBehavior=function(){return!0},e.prototype.enter=function(t){return!0},e.prototype.entered=function(t){return this.host.trigger(e.Events.ENTERED,this),this.isEntered=!0,!0},e.prototype.exit=function(t){return!0},e.prototype.exited=function(t){return this.host.trigger(e.Events.EXITED,this),this.isEntered=!1,!0},e}(a.a);i.Events={ENTERED:"tile:entered",EXITED:"tile:exited"}},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(103)),i=n(128),r=n(287),s=n(37),c=n(76),u=n(102);n.d(e,"a",function(){return d});var p={visible:!0,enabled:!0,icon:"",scale:1,image:null,tileMap:null},d=function(t){function e(){var e=t.call(this,{})||this;return e.frame=0,o.extend(e,o.defaults({},p)),e}return __extends(e,t),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){this._updateIcon(t),this._icon=t},enumerable:!0,configurable:!0}),e.prototype.setPoint=function(t){var e=new i.b(t).round();this.renderPoint&&(this.renderPoint=e.clone()),this.point=e.clone();var n=this.findBehavior(r.a);n&&(n.targetPoint.set(e),n.path.length=0)},e.prototype.onAddToScene=function(e){t.prototype.onAddToScene.call(this,e),this.icon&&this.setSprite(this.icon),this.tileMap||(this.tileMap=this.scene.objectByType(c.a))},e.prototype.setSprite=function(t,e){var n=this;void 0===e&&(e=0);var o=this.icon;if(t){var a=s.a.get();if(!a)return o;var i=a.sprites.getSpriteMeta(t);a.sprites.getSpriteSheet(i.source).then(function(t){var o=t[0];n.meta=i,n.image=o.data,n.frame=e})}else this.meta=null;return this.icon=t,o},e.prototype._updateIcon=function(t){var e=this,n=s.a.get();if(n&&this._icon!==t){var o=n.sprites.getSpriteMeta(name);o&&n.sprites.getSpriteSheet(o.source).then(function(t){var n=t[0];e.meta=o,e.image=n.data})}},e.prototype.getIcon=function(){if(this.icon)return this.icon;var t=this.findBehavior(a.a);return t?t.icon:null},e}(u.a)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var o=n(53),a=n(1);n.d(e,"a",function(){return s}),n.d(e,"b",function(){return c});var i=[],r=function(t){return t};n.i(a.a)(),r=function(t){return n.i(o.a)(),t},i=i.slice();var s=r,c=i.slice()},,function(t,e){function n(t){throw new Error("Cannot find module '"+t+"'.")}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=226},,,,,,,,,function(t,e,n){"use strict";var o=n(1),a=n(7),i=n(37),r=n(28);n.d(e,"a",function(){return s});var s=function(){function t(t,e,n){this.store=t,this.world=e,this.notifications=n,this.world.time.addObject(n),this.world.mark(n)}return t}();s=__decorate([n.i(o.Z)({selector:"app",encapsulation:o.m.None,styles:[n(899)],template:n(648)}),__metadata("design:paramtypes",[a.a,i.a,r.a])],s)},function(t,e,n){"use strict";var o=n(1),a=n(77),i=n(19),r=n(163),s=n(131);n.d(e,"a",function(){return c});var c=function(){function t(t,e){var o=this;this.actions$=t,this.loadingService=e,this.loadingIndicator$=this.actions$.ofType(i.a.typeId).distinctUntilChanged().do(function(t){o.loadingService.message="Traveling to "+t.payload.location+"...",o.loadingService.loading=!0}),this.loadingDoneIndicator$=this.actions$.ofType(i.b.typeId,i.c.typeId).distinctUntilChanged().do(function(t){o.loadingService.loading=!1}),this.navigateToWorldRoute$=this.actions$.ofType(i.b.typeId).debounceTime(100).distinctUntilChanged().map(function(t){return n.i(s.a)(["world",t.payload])})}return t}();__decorate([n.i(a.a)({dispatch:!1}),__metadata("design:type",Object)],c.prototype,"loadingIndicator$",void 0),__decorate([n.i(a.a)({dispatch:!1}),__metadata("design:type",Object)],c.prototype,"loadingDoneIndicator$",void 0),__decorate([n.i(a.a)(),__metadata("design:type",Object)],c.prototype,"navigateToWorldRoute$",void 0),c=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[a.b,r.a])],c)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(287)),i=n(188),r=n(11),s=n(176),c=n(187),u=n(76);n.d(e,"a",function(){return p});var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.passableKeys=["passable"],e._lastFrame=3,e._renderFrame=3,e.heading=new r.a(0,-1),e.sprite=null,e.collideComponentType=c.a,e}return __extends(e,t),e.prototype.syncBehavior=function(){return this.sprite=this.host.findBehavior(s.b),t.prototype.syncBehavior.call(this)},e.prototype.tick=function(e){this._lastFrame=this._renderFrame>3?this._renderFrame-4:this._renderFrame,t.prototype.tick.call(this,e)},e.prototype.interpolateTick=function(e){if(t.prototype.interpolateTick.call(this,e),this.sprite){var n=this.targetPoint.x!==this.host.renderPoint.x,o=this.targetPoint.y!==this.host.renderPoint.y;this.velocity.y>0&&o?(this.sprite.setHeading(s.a.SOUTH,o),this.heading.set(0,1)):this.velocity.y<0&&o?(this.sprite.setHeading(s.a.NORTH,o),this.heading.set(0,-1)):this.velocity.x<0&&n?(this.sprite.setHeading(s.a.WEST,n),this.heading.set(-1,0)):this.velocity.x>0&&n?(this.sprite.setHeading(s.a.EAST,n),this.heading.set(1,0)):this.velocity.y>0?(this.sprite.setHeading(s.a.SOUTH,!1),this.heading.set(0,1)):this.velocity.y<0?(this.sprite.setHeading(s.a.NORTH,!1),this.heading.set(0,-1)):this.velocity.x<0?(this.sprite.setHeading(s.a.WEST,!1),this.heading.set(-1,0)):this.velocity.x>0?(this.sprite.setHeading(s.a.EAST,!1),this.heading.set(1,0)):this.sprite.setMoving(!1)}},e.prototype.collideWithMap=function(t,e){var n=this.host.scene.objectByType(u.a);if(n)for(var o=n.getLayers(),a=0;a<o.length;a++){var i=n.getTileData(o[a],t.x,t.y);if(i&&i[e]===!1)return!0}return!1},e.prototype.collideMove=function(t,e,n){return void 0===n&&(n=[]),!1},e.prototype.beginMove=function(t){var n,o,a;if(this.host.trigger(e.Events.MOVE_BEGIN,this,t.from,t.to),this.collider){var r=[];for(this.collider.collide(t.from.x,t.from.y,i.a,r),a=0;a<r.length;a++)if(o=r[a],n=o.findBehavior(this.collideComponentType),n&&n.enter&&n.exit(this.host)===!1)return;for(r.length=0,this.collider.collide(t.to.x,t.to.y,i.a,r),a=0;a<r.length;a++)if(o=r[a],n=o.findBehavior(this.collideComponentType),n&&n.enter&&n.enter(this.host)===!1)return}},e.prototype.completeMove=function(t){var n,a=this;if(this.host.trigger(e.Events.MOVE_END,this,t.from,t.to),this.collider){var r=[];this.collider.collide(t.from.x,t.from.y,i.a,r);var s=o.find(r,function(t){return t._uid!==a.host._uid});s&&(n=s.findBehavior(this.collideComponentType),n&&n.host._uid!==this.host._uid&&n.exited(this.host)),r.length=0,this.collider.collide(t.to.x,t.to.y,i.a,r);var c=o.find(r,function(t){return t._uid!==a.host._uid});c&&(n=c.findBehavior(this.collideComponentType),n&&n.host._uid!==this.host._uid&&n.entered(this.host))}},e}(a.a);p.COLLIDE_TYPES=["TempleFeatureComponent","StoreFeatureComponent","DialogFeatureComponent","sign"],p.Events={MOVE_BEGIN:"move:begin",MOVE_END:"move:end"}},function(t,e,n){"use strict";var o=n(1),a=n(42),i=n(34),r=(n.n(i),n(37));n.d(e,"a",function(){return s});var s=function(t){function e(e){var n=t.call(this)||this;return n.gameWorld=e,n._icon$=new i.BehaviorSubject(null),n.icon$=n._icon$,n.meta=null,n.image=null,n}return __extends(e,t),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon$.value},set:function(t){this._icon$.next(t)},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this;this._subscription=this.icon$.distinctUntilChanged().do(function(e){return e?(t.meta=t.gameWorld.sprites.getSpriteMeta(e),void(t.meta&&t.gameWorld.sprites.getSpriteSheet(t.meta.source).then(function(e){t.image=e[0].data}))):(t.meta=null,void(t.image=null))}).subscribe()},e.prototype.ngOnDestroy=function(){this._subscription.unsubscribe()},e}(a.a);__decorate([n.i(o.M)(),__metadata("design:type",String),__metadata("design:paramtypes",[String])],s.prototype,"icon",null),s=__decorate([n.i(o.Z)({selector:"sprite-render-behavior",template:"\n    <ng-content></ng-content>"}),__metadata("design:paramtypes",[r.a])],s)},function(t,e,n){"use strict";var o=n(1);n.d(e,"a",function(){return a});var a=function(){function t(){}return t.prototype.getCSSClassMap=function(){if(!this.model)return{};var t=Math.round(this.model.hp/this.model.maxhp*100);return{dead:0===t,critical:t<33,hurt:t<66,fine:t>66}},t.prototype.getProgressBarWidth=function(){var t=0;return this.model&&this.model&&(t=Math.ceil(this.model.hp/this.model.maxhp*100)),t},t}();__decorate([n.i(o.M)(),__metadata("design:type",Object)],a.prototype,"model",void 0),a=__decorate([n.i(o.Z)({selector:"rpg-health-bar",styles:[n(900)],template:'\n  <div [ngClass]="getCSSClassMap()" [style.width]="getProgressBarWidth() + \'%\'">\n    <ng-content></ng-content>\n  </div>'})],a)},function(t,e,n){"use strict";var o=n(239);n.d(e,"a",function(){return a});var a=[o.a]},function(t,e,n){"use strict";var o=n(1),a=n(46);n.d(e,"a",function(){return i});var i=function(){function t(t){this.loadingService=t}return t}();i=__decorate([n.i(o.Z)({selector:"loading",changeDetection:o._0.OnPush,template:'\n  <div class="loading fade" *ngIf="loadingService.loading$ | async">\n    <div class="loading-wrapper">\n      <div class="loading-wrapper-inner hero-container">\n        <h1>\n          <a target="_blank" href="https://github.com/justindujardin/angular-rpg">{{loadingService.title$ | async}}</a>\n        </h1>\n        <p>{{loadingService.message$ | async}}</p>\n      </div>\n    </div>\n  </div>'}),__metadata("design:paramtypes",[a.a])],i)},function(t,e,n){"use strict";var o=n(243),a=n(28);n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r});var i=[o.a],r=[a.a]},function(t,e,n){"use strict";var o=n(1),a=n(96),i=n(46);n.d(e,"a",function(){return r});var r=function(){function t(t,e,n){this.notify=t,this.loadingService=e,this.element=n,t.container=n.nativeElement}return t}();r=__decorate([n.i(o.Z)({selector:"rpg-notification",styles:[n(901)],template:'<span class="message" \n      [innerText]="notify.message" \n      [class.loading]="loadingService.loading$ | async">\n</span>'}),__metadata("design:paramtypes",[a.b,i.a,o.K])],r)},function(t,e,n){"use strict";var o=n(446);n.d(e,"a",function(){return a});var a=[o.a]},function(t,e,n){"use strict";var o=n(246);n.d(e,"a",function(){return a});var a=[o.a]},function(t,e,n){"use strict";var o=n(1),a=n(96),i=n(7),r=n(16),s=n(19),c=n(155),u=n(90);n.d(e,"a",function(){return p});var p=function(){function t(t,e,n,o){this.game=t,this.store=e,this.gameStateService=n,this.notify=o,this.page="party",this.open=!1,this.partyGold$=this.store.select(r.d),this.party$=this.store.select(r.e)}return t.prototype.resetGame=function(){this.store.dispatch(new s.l)},t.prototype.saveGame=function(){this.store.dispatch(new s.o)},t}();__decorate([n.i(o.M)(),__metadata("design:type",String)],p.prototype,"page",void 0),__decorate([n.i(o.M)(),__metadata("design:type",Boolean)],p.prototype,"open",void 0),p=__decorate([n.i(o.Z)({selector:"party-menu",styles:[n(903)],template:n(650),animations:[n.i(c.a)("card",[n.i(c.d)(":enter",[n.i(c.c)({transform:"translateY(100%)"}),n.i(c.e)("110ms",n.i(c.c)({transform:"translateY(0)"}))]),n.i(c.d)(":leave",[n.i(c.c)({transform:"translateY(0)"}),n.i(c.e)("110ms",n.i(c.c)({transform:"translateY(100%)"}))])]),n.i(c.a)("toolbar",[n.i(c.d)(":enter",[n.i(c.c)({transform:"translateY(-100%)"}),n.i(c.e)("110ms",n.i(c.c)({transform:"translateY(0)"}))]),n.i(c.d)(":leave",[n.i(c.c)({transform:"translateY(0)"}),n.i(c.e)("110ms",n.i(c.c)({transform:"translateY(-100%)"}))])]),n.i(c.a)("fab",[n.i(c.d)(":enter",[n.i(c.c)({transform:"translateY(100%)"}),n.i(c.e)("110ms",n.i(c.c)({transform:"translateY(0)"}))]),n.i(c.d)(":leave",[n.i(c.c)({transform:"translateY(0)"}),n.i(c.e)("110ms",n.i(c.c)({transform:"translateY(100%)"}))])])]}),__metadata("design:paramtypes",[a.c,i.a,u.a,a.b])],p)},function(t,e,n){"use strict";var o=n(447);n.d(e,"a",function(){return a});var a=[o.a]},function(t,e,n){"use strict";var o=n(448);n.d(e,"a",function(){return a});var a=[o.a]},function(t,e,n){"use strict";var o=n(250);n.d(e,"a",function(){return a});var a=[o.a]},function(t,e,n){"use strict";var o=n(1),a=n(178),i=n(35),r=(n.n(i),n(53));n.d(e,"a",function(){return s});var s=c=function(){function t(t,e){this.sanitizer=t,this.renderer=e,this._dataUrl$=new i.ReplaySubject(1),this.dataUrl$=this._dataUrl$,this._width$=new i.BehaviorSubject("64"),this.width$=this._width$,this._height$=new i.BehaviorSubject("64"),this.height$=this._height$,this._name$=new i.BehaviorSubject(c.INVALID_IMAGE),this.name$=this._name$,this._frame$=new i.BehaviorSubject(0),this.frame$=this._frame$,this.styleBackground="rgba(0,0,0,1)",this._canvasAcquired=!1,c._renderCanvas||(c._renderCanvas=document.createElement("canvas"),c._renderCanvas.width=c._renderCanvas.height=64,c._renderCanvas.style.position="absolute",c._renderCanvas.style.left=c._renderCanvas.style.top="-9000px")}return Object.defineProperty(t.prototype,"width",{set:function(t){this._width$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{set:function(t){this._height$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frame",{set:function(t){this._frame$.value!==t&&(this._frame$.next(t),this._get(this._name$.value))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{set:function(t){return t?(this._name$.next(t),void this._get(t)):void this._name$.next(c.INVALID_IMAGE)},enumerable:!0,configurable:!0}),t.prototype.getRenderContext=function(t,e){if(this._canvasAcquired)throw new Error("Only one rendering canvas is available at a time. Check for calls to this function without corresponding releaseCanvas() calls.");this._canvasAcquired=!0,c._renderCanvas.width=t,c._renderCanvas.height=e;var n=c._renderCanvas.getContext("2d");return n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,n.msImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1,n},t.prototype.releaseRenderContext=function(){return this._canvasAcquired=!1,c._renderCanvas.toDataURL()},t.prototype._get=function(t){var e=this;return t&&t!==c.INVALID_IMAGE?void this.renderer.getSingleSprite(t,this._frame$.value).then(function(t){var n=parseInt(e._width$.value,10),o=parseInt(e._height$.value,10),a=e.getRenderContext(n,o);a.clearRect(0,0,n,o),a.drawImage(t,0,0,n,o);var i=e.sanitizer.bypassSecurityTrustResourceUrl(e.releaseRenderContext());e._dataUrl$.next(i)}):void this._dataUrl$.next(c.INVALID_IMAGE)},t}();s.INVALID_IMAGE="assets/images/a/blank.gif",__decorate([n.i(o.M)(),__metadata("design:type",String),__metadata("design:paramtypes",[String])],s.prototype,"width",null),__decorate([n.i(o.M)(),__metadata("design:type",String),__metadata("design:paramtypes",[String])],s.prototype,"height",null),__decorate([n.i(o.M)(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],s.prototype,"frame",null),__decorate([n.i(o.M)(),__metadata("design:type",String),__metadata("design:paramtypes",[String])],s.prototype,"name",null),s=c=__decorate([n.i(o.Z)({selector:"rpg-sprite",styles:[n(905)],changeDetection:o._0.OnPush,template:'<img [style.width]="width$ | async" [style.height]="height$ | async" [src]="dataUrl$ | async">'}),__metadata("design:paramtypes",[r.f,a.a])],s);var c},function(t,e,n){"use strict";function o(t,e,o){var a=t.allIds.indexOf(o);return n.i(c.c)(a===-1,"item ("+o+") already exists in collection"),t=t.updateIn(["allIds"],function(t){return t.push(o)}),t.updateIn(["byId"],function(t){return t.set(o,e)})}function a(t,e,o){var a=t.allIds.indexOf(o);return n.i(c.c)(a!==-1,"item ("+o+") does not exist in collection"),t.updateIn(["byId"],function(t){return t.set(o,s.Map(t.get(o)).merge(e).toJS())})}function i(t,e){var o=t.allIds.indexOf(e);return n.i(c.c)(o!==-1,"item ("+e+") does not exist in collection"),t=t.updateIn(["allIds"],function(t){return t.filter(function(t){return t!==e})}),t.updateIn(["byId"],function(t){return t.remove(e)})}function r(t){return{byId:s.Map(t.byId),allIds:s.List(t.allIds)}}var s=n(45),c=(n.n(s),n(22));e.b=o,e.d=a,e.c=i,e.a=r},function(t,e,n){"use strict";var o=n(451),a=n(1),i=n(39),r=n(7),s=n(73),c=n(123),u=n(0);n.n(u);n.d(e,"a",function(){return p});var p=function(){function t(t,e){this.loader=t,this.store=e}return t.prototype.loadGameData=function(t){var e=this;return void 0===t&&(t=s.a),u.Observable.fromPromise(this.loader.loadAsType(t,o.a).then(function(t){e.store.dispatch(new c.a("weapons",t.data.weapons)),e.store.dispatch(new c.a("armor",t.data.armor)),e.store.dispatch(new c.a("items",t.data.items)),e.store.dispatch(new c.a("enemies",t.data.enemies)),e.store.dispatch(new c.a("magic",t.data.magic)),e.store.dispatch(new c.a("classes",t.data.classes)),e.store.dispatch(new c.a("randomEncounters",t.data.randomencounters)),e.store.dispatch(new c.a("fixedEncounters",t.data.fixedencounters))}))},t}();p=__decorate([n.i(a.d)(),__metadata("design:paramtypes",[i.a,r.a])],p)},function(t,e,n){"use strict";function o(t){return function(e,o){switch(o.type){case"SET_ROOT_STATE":case m.j.typeId:return __assign({},o.payload,{gameState:n.i(u.k)(o.payload.gameState),entities:n.i(l.f)(o.payload.entities),gameData:n.i(p.t)(o.payload.gameData),combat:n.i(d.e)(o.payload.combat),sprites:n.i(h.d)(o.payload.sprites)});default:return t(e,o)}}}function a(t,e){return g(t,e)}var i=n(473),r=(n.n(i),n(7)),s=n(645),c=(n.n(s),n(131)),u=n(167),p=n(166),d=n(164),l=n(165),h=n(168),m=n(19),f=n(453);e.b=a,n.d(e,"a",function(){return _});var y={router:c.b,gameData:p.s,gameState:u.j,combat:d.d,entities:l.e,sprites:h.c},b=[o,s.storeFreeze,f.a],v=[o],g=(i.compose.apply(void 0,b.concat([r.d]))(y),i.compose.apply(void 0,v.concat([r.d]))(y)),_=[]},function(t,e,n){"use strict";function o(t){return u[0===t?t:t-1]}function a(t,e){return Math.floor(e.defense*Math.pow(t,1.1))+2*e.basedefense}function i(t,e){return Math.floor(e.baseattack*Math.pow(t,.65))}function r(t,e){return Math.floor(e.basespeed*Math.pow(t,.95))}function s(t,e){return Math.floor(e.basedefense*Math.pow(t,.95))}function c(t,e){return Math.floor(e.basemagic*Math.pow(t,.95))}e.a=o,e.b=a,e.c=i,e.d=r,e.e=s,e.f=c;var u=[0,32,96,208,400,672,1056,1552,2184,2976]},function(t,e,n){"use strict";var o=n(1),a=n(39),i=n(7),r=n(124),s=n(16),c=n(0),u=(n.n(c),n(4)),p=(n.n(u),n(74));n.d(e,"a",function(){return d});var d=function(){function t(t,e){this.resourceLoader=t,this.store=e}return t.prototype.loadSprites=function(t){var e=this;return this.store.select(s.a).take(1).switchMap(function(o){if(!o)return c.Observable.fromPromise(e.resourceLoader.load(t).then(function(t){var o=t[0],a=u.map(o.data,function(t){return t+".json"});return Promise.all(u.map(a,function(t){return e.resourceLoader.load(t).then(function(o){var a=o[0].data;e.store.dispatch(new r.a(a)),n.i(p.b)(t,a)})}))}).then(function(){return Promise.resolve(void 0)}))})},t}();d=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[a.a,i.a])],d)},function(t,e,n){"use strict";var o=n(42);n.d(e,"a",function(){return a});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="default",e.from=null,e.to=null,e.spell=null,e.item=null,e}return __extends(e,t),e.prototype.getActionName=function(){return this.name},e.prototype.isCurrentTurn=function(){return console.warn("combat: current turn update needed"),!0},e.prototype.canTarget=function(){return!0},e.prototype.canTargetMultiple=function(){return this.canTarget()},e.prototype.canBeUsedBy=function(t){return!0},e.prototype.act=function(t){return t&&t(this,null),!0},e.prototype.select=function(){},e}(o.a)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(1)),i=n(75),r=n(176),s=n(159),c=n(11),u=n(47);n.d(e,"a",function(){return d});var p;(function(t){t[t.DEFAULT=10]="DEFAULT",t[t.SWING=1]="SWING",t[t.INJURED=2]="INJURED",t[t.WALK=3]="WALK",t[t.STRIKE=3]="STRIKE",t[t.CELEBRATE=4]="CELEBRATE",t[t.DEAD=5]="DEAD"})(p||(p={}));var d=function(t){function e(e){var n=t.call(this)||this;return n.combatService=e,n._elapsed=0,n._renderFrame=3,n.state="",n.animating=!1,n.animator=null,n.attackDirection=r.a.WEST,n}return __extends(e,t),e.prototype.syncBehavior=function(){return this.animator=this.host.findBehavior(s.a),t.prototype.syncBehavior.call(this)},e.prototype.setState=function(t){void 0===t&&(t="Default"),this.state=t},e.prototype.attack=function(t,e){this._attack(e,this.getAttackAnimation(t))},e.prototype.magic=function(t,e){this._attack(e,this.getMagicAnimation(t))},e.prototype.getForwardDirection=function(){return this.attackDirection===r.a.WEST?-1:1},e.prototype.getBackwardDirection=function(){return this.attackDirection===r.a.WEST?1:-1},e.prototype.getForwardFrames=function(){return this.attackDirection===r.a.WEST?[9,11,10]:[3,5,4]},e.prototype.getBackwardFrames=function(){return this.attackDirection===r.a.WEST?[10,11,9]:[4,5,3]},e.prototype.getAttackFrames=function(){return this.attackDirection===r.a.WEST?[12,13,14,15,14,13,12]:[4,5,6,7,6,5,4]},e.prototype.getMagicAnimation=function(t){var e=this;return[{name:"Prep Animation",callback:function(){e.host.setSprite(e.host.icon.replace(".png","-magic.png"),19)}},{name:"Magic cast",repeats:0,duration:1e3,frames:[19,18,17,16,15],callback:function(){t&&t()}},{name:"Back to rest",repeats:0,duration:1e3,frames:[15,16,17,18,19],callback:function(){e.host.setSprite(e.host.icon.replace("-magic.png",".png"),10)}}]},e.prototype.getAttackAnimation=function(t){var e=this;return[{name:"Move Forward for Attack",repeats:0,duration:250,frames:this.getForwardFrames(),move:new c.a(this.getForwardDirection(),0),callback:function(){var t=e.host.icon.replace(".png","-attack.png");e.host.world.sprites.getSpriteMeta(t)&&e.host.setSprite(t,12)}},{name:"Strike at Opponent",repeats:1,duration:100,frames:this.getAttackFrames(),callback:function(){e.host.setSprite(e.host.icon.replace("-attack.png",".png"),10),t&&t()}},{name:"Return to Party",duration:250,repeats:0,frames:this.getBackwardFrames(),move:new c.a(this.getBackwardDirection(),0)}]},e.prototype.moveForward=function(t){this._playAnimation([{name:"Move Forward",repeats:0,duration:250,frames:this.getForwardFrames(),move:new c.a(this.getForwardDirection(),0)}],t)},e.prototype.moveBackward=function(t){this._playAnimation([{name:"Move Backward",repeats:0,duration:250,frames:this.getBackwardFrames(),move:new c.a(this.getBackwardDirection(),0)}],t)},e.prototype._playAnimation=function(t,e){var n=this;if(this.animator&&!this.animating){var a=o.map(t,function(t){var e=o.extend({},t);return"undefined"!=typeof e.move&&(e.move=e.move.clone()),e});this.animating=!0,this.animator.playChain(a,function(){n.animating=!1,e&&e()})}},e.prototype._attack=function(t,e){var n=this;if(this.animator&&!this.animating){var a=o.map(e,function(t){var e=o.extend({},t);return"undefined"!=typeof e.move&&(e.move=e.move.clone()),e});this.animating=!0,this.animator.playChain(a,function(){n.animating=!1,t&&t()})}},e.prototype.interpolateTick=function(e){if(t.prototype.interpolateTick.call(this,e),!this.animating){var n=this._elapsed/this.tickRateMS,o=n>0&&n<.5,a=p.DEFAULT;switch(this.state){case"Injured":a=p.DEFAULT;break;case"Dead":a=p.DEFAULT;break;case"Attacking":a=o?p.STRIKE:p.SWING}this.host.frame=this._renderFrame=a}},e}(i.a);d=__decorate([n.i(a.Z)({selector:"combat-player-render-behavior",template:"<ng-content></ng-content>"}),__metadata("design:paramtypes",[u.a])],d)},function(t,e,n){"use strict";var o=n(1),a=n(96),i=n(11);n.d(e,"a",function(){return r});var r=function(){function t(t){this.animate=t,this.classes=[],this.value=0,this.position=new i.a}return t.prototype.ngAfterViewInit=function(){var t=this,e="active",n=this.damageValue.nativeElement;return n?void this.animate.enter(n,e).then(function(){n.classList.remove("active"),t.animate.enter(n,"remove").then(function(){n.classList.remove("remove")})}):console.warn("unable to find damage value")},t}();__decorate([n.i(o.M)(),__metadata("design:type",Array)],r.prototype,"classes",void 0),__decorate([n.i(o.M)(),__metadata("design:type",Number)],r.prototype,"value",void 0),__decorate([n.i(o.M)(),__metadata("design:type",i.a)],r.prototype,"position",void 0),__decorate([n.i(o._14)("damageValue"),__metadata("design:type",o.K)],r.prototype,"damageValue",void 0),r=__decorate([n.i(o.Z)({selector:"combat-damage",template:'\n    <span #damageValue class="damage-value"\n          [ngClass]="classes"\n          [innerText]="value"\n          [style.top]="position?.y + \'px\'"\n          [style.left]="position?.x + \'px\'">\n    </span>\n  ',styles:[n(906)]}),__metadata("design:paramtypes",[a.d])],r)},function(t,e,n){"use strict";var o=n(1),a=n(93),i=n(91),r=n(35),s=(n.n(r),n(169)),c=n(238);n.d(e,"b",function(){return u}),n.d(e,"a",function(){return p});var u=function(t){function e(e){var n=t.call(this)||this;return n.combat=e,n._model$=new r.BehaviorSubject(null),n.model$=n._model$,n}return __extends(e,t),Object.defineProperty(e.prototype,"model",{get:function(){return this._model$.value},set:function(t){this._model$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this.model&&this.model.hp>0},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this;this.combat.scene.addObject(this),this.addBehavior(this.render),this.addBehavior(this.attack),this._spriteSubscription=this.model$.distinctUntilChanged().do(function(e){t.setSprite(e?e.icon:null)}).subscribe()},e.prototype.ngOnDestroy=function(){this.removeBehavior(this.render),this.removeBehavior(this.attack),this.combat.scene.removeObject(this),this._spriteSubscription.unsubscribe(),this.destroy()},e}(a.a);__decorate([n.i(o._14)(s.a),__metadata("design:type",s.a)],u.prototype,"attack",void 0),__decorate([n.i(o._14)(c.a),__metadata("design:type",c.a)],u.prototype,"render",void 0),__decorate([n.i(o.M)(),__metadata("design:type",String)],u.prototype,"icon",void 0),__decorate([n.i(o.M)(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],u.prototype,"model",null),u=__decorate([n.i(o.Z)({selector:"combat-enemy",template:'\n    <sprite-render-behavior [icon]="(model$ | async)?.icon"></sprite-render-behavior>\n    <combat-attack-behavior [combat]="combat" #attack></combat-attack-behavior>\n    <ng-content></ng-content>\n  '}),__param(0,n.i(o.e)(n.i(o._13)(function(){return i.a}))),__metadata("design:paramtypes",[i.a])],u);var p=[u]},function(t,e,n){"use strict";var o=n(1),a=n(95),i=n(49),r=n(16),s=n(7),c=n(46),u=n(39),p=n(185),d=n(457),l=n(47),h=n(261),m=n(259),f=n(292),y=n(11),b=n(103),v=n(458);n.d(e,"b",function(){return g}),n.d(e,"a",function(){return _});var g=function(t){function e(e,n,o,a){var i=t.call(this)||this;return i.combatService=e,i.store=n,i.loadingService=o,i.loader=a,i._tileRenderer=new f.a,i.enemies$=i.store.select(r.h),i.party$=i.store.select(r.i),i.encounter$=i.store.select(r.g),i.resource$=i.combatService.combatMap$.distinctUntilChanged().map(function(t){return i.setMap(t),t}),i.features$=i.resource$.map(function(){return i.features.objects}),i.objectRenderer=new p.a,i}return __extends(e,t),e.prototype.ngAfterViewInit=function(){var t=this;this.scene.addObject(this),this.addBehavior(this.camera),this._resourceSubscription=this.resource$.do(function(){t.party.forEach(function(e,n){e.setSprite(e.model.icon);var o=t.getFeature("p"+(n+1));e.setPoint(new y.a(o.x/16,o.y/16))}),t.enemies.forEach(function(e,n){var o=t.getFeature("e"+(n+1));o&&e.setPoint(new y.a(o.x/16,o.y/16))})}).subscribe()},e.prototype.ngOnDestroy=function(){this._resourceSubscription.unsubscribe(),this.scene.removeObject(this),this.removeBehavior(this.camera),this.destroy()},e.prototype.beforeFrame=function(t,e){},e.prototype.renderFrame=function(t,e){var n=this;this._tileRenderer.render(this,t),this.party.forEach(function(e){n.objectRenderer.render(e,e.renderPoint||e.point,t,e.meta);var o=e.findBehaviors(b.a);o.forEach(function(e){n.objectRenderer.render(e,e.host.point,t,e.meta)})}),this.enemies.forEach(function(e){n.objectRenderer.render(e,e.renderPoint||e.point,t,e.meta);var o=e.findBehaviors(b.a);o.forEach(function(e){n.objectRenderer.render(e,e.host.point,t,e.meta)})})},e.prototype.afterFrame=function(t,e){},e.prototype.combatTrackBy=function(t,e){return e.eid},e}(a.a);__decorate([n.i(o.M)(),__metadata("design:type",i.a)],g.prototype,"scene",void 0),__decorate([n.i(o._14)(d.a),__metadata("design:type",d.a)],g.prototype,"camera",void 0),__decorate([n.i(o._18)(h.b),__metadata("design:type",o._19)],g.prototype,"party",void 0),__decorate([n.i(o._18)(m.b),__metadata("design:type",o._19)],g.prototype,"enemies",void 0),g=__decorate([n.i(o.Z)({selector:"combat-map",changeDetection:o._0.OnPush,template:n(654)}),__metadata("design:paramtypes",[l.a,s.a,c.a,u.a])],g);var _=[g,v.a,d.a]},function(t,e,n){"use strict";var o=n(1),a=n(93),i=n(257),r=n(169),s=n(91);n.d(e,"b",function(){return c}),n.d(e,"a",function(){return u});var c=function(t){function e(e){var n=t.call(this)||this;return n.combat=e,n}return __extends(e,t),Object.defineProperty(e.prototype,"visible",{get:function(){return this.model&&this.model.hp>0},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this;this.combat.scene.addObject(this),this.behaviors.forEach(function(e){t.addBehavior(e)})},e.prototype.ngOnDestroy=function(){var t=this;this.combat.scene.removeObject(this),this.behaviors.forEach(function(e){t.removeBehavior(e)}),this.destroy()},e}(a.a);__decorate([n.i(o._18)("render,animation,attack,magic,guard,item,run"),__metadata("design:type",o._19)],c.prototype,"behaviors",void 0),__decorate([n.i(o._14)(i.a),__metadata("design:type",i.a)],c.prototype,"render",void 0),__decorate([n.i(o.M)(),__metadata("design:type",Object)],c.prototype,"model",void 0),__decorate([n.i(o.M)(),__metadata("design:type",String)],c.prototype,"icon",void 0),c=__decorate([n.i(o.Z)({selector:"combat-player",template:'\n    <combat-player-render-behavior #render></combat-player-render-behavior>\n    <animated-behavior #animation></animated-behavior>\n    <combat-attack-behavior [combat]="combat" #attack></combat-attack-behavior>\n    <!--<combat-magic-behavior [combat]="combat" #magic></combat-magic-behavior>-->\n    <!--<combat-item-behavior [combat]="combat" #item></combat-item-behavior>-->\n    <!--<combat-run-behavior [combat]="combat" #run></combat-run-behavior>-->\n    <!--<combat-guard-behavior [combat]="combat" #guard></combat-guard-behavior>-->\n    <ng-content></ng-content>\n  '}),__param(0,n.i(o.e)(n.i(o._13)(function(){return s.a}))),__metadata("design:paramtypes",[s.a])],c);var u=[i.a,r.a,c]},function(t,e,n){"use strict";var o=n(101),a=n(1),i=n(7),r=n(16);n.d(e,"a",function(){return s});var s=function(){function t(t,e){this.store=t,this.router=e}return t.prototype.canActivate=function(t,e){var n=this;return this.store.select(r.g).take(1).map(function(e){return e&&"none"!==e.type?e.id===t.params.id:(n.router.navigate(["/"]),!1)})},t}();s=__decorate([n.i(a.d)(),__metadata("design:paramtypes",[i.a,o.a])],s)},function(t,e,n){"use strict";var o=n(61),a=n(1);n.d(e,"a",function(){return i});var i=r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=r.NAME,e}return __extends(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),e.notify("combat:escape",{player:e.current},function(){alert("combat escape needs fixin'")})},e}(o.a);i.NAME="Combat Escaped",i=r=__decorate([n.i(a.Z)({selector:"combat-escape-state",template:"<ng-content></ng-content>"})],i);var r},function(t,e,n){"use strict";var o=n(1),a=n(28),i=n(62),r=n(37);n.d(e,"a",function(){return s;
});var s=function(){function t(t,e,n){this.game=t,this.notify=e,this.world=n}return t.prototype.ngOnInit=function(){var t=this;this.game.initGame().then(function(e){if(e){var n=["Click, Touch, or use the Arrow Keys."];n.forEach(function(e){return t.notify.show(e,null,0)})}}).catch(console.error.bind(console))},t}();s=__decorate([n.i(o.Z)({selector:"game",styles:[n(910)],encapsulation:o.m.None,template:n(656)}),__metadata("design:paramtypes",[i.a,a.a,r.a])],s)},function(t,e,n){"use strict";var o=n(1),a=n(143),i=(n.n(a),n(46)),r=n(37);n.d(e,"a",function(){return s});var s=function(){function t(t,e){this.world=t,this.loadingService=e}return t.prototype.resolve=function(t,e){return this.loadingService.loading=!0,this.loadingService.title="RPG!",this.loadingService.message="Initializing the world...",this.world.ready$.take(1)},t}();s=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[r.a,i.a])],s)},function(t,e,n){"use strict";var o=n(1);n.d(e,"a",function(){return a});var a=function(){function t(){}return t}();a=__decorate([n.i(o.Z)({selector:"no-content",template:"\n    <div>\n      <h1>404: page missing</h1>\n    </div>\n  "})],a)},function(t,e,n){"use strict";var o=n(1),a=n(31),i=n(279),r=n(162),s=n(277),c=n(161),u=n(276),p=n(270),d=n(234),l=n(278);n.d(e,"a",function(){return h}),n.d(e,"b",function(){return f});var h=[i.a],m=[l.a].concat(s.a,u.a,p.a),f=y=function(){function t(){}return t.forRoot=function(){return{ngModule:y,providers:h}},t}();f=y=__decorate([n.i(o.x)({declarations:m,exports:m,imports:[d.h,a.c,c.a,r.a]})],f);var y},function(t,e,n){"use strict";var o=n(48),a=n(92),i=n(1),r=n(73),s=n(7),c=n(16),u=n(72),p=n(45);n.n(p);n.d(e,"a",function(){return d});var d=function(t){function e(e){var n=t.call(this)||this;return n.store=e,n.party=null,n}return __extends(e,t),e.prototype.connectBehavior=function(){return this.properties&&this.properties.id?t.prototype.connectBehavior.call(this):(console.error("Fixed encounters must have a given id so they may be hidden"),!1)},e.prototype.enter=function(t){var e=this;if(this.party=t.findBehavior(a.a),!this.party)return!1;this.party.velocity.zero(),t.setPoint(t.point);var o=this.host.tileMap.getCombatZones(this.party.host.point);return this.store.select(c.e).withLatestFrom(this.store.select(c.p),this.store.select(c.q),function(t,a,i){var s=a.find(function(t){return t.id===e.properties.id}),c=function(t){var e=i.find(function(e){return e.id===t});return Object.assign({},e,{eid:n.i(r.c)(e.id),maxhp:e.hp,maxmp:e.mp})},d={type:"fixed",id:s.id,enemies:n.i(p.List)(s.enemies.map(c)),zone:o.target||o.map,message:s.message,party:n.i(p.List)(t)};e.store.dispatch(new u.b(d))}).take(1).subscribe(),!0},e}(o.b);__decorate([n.i(i.M)(),__metadata("design:type",Object)],d.prototype,"feature",void 0),d=__decorate([n.i(i.Z)({selector:"combat-feature",template:"\n    <ng-content></ng-content>"}),__metadata("design:paramtypes",[s.a])],d)},function(t,e,n){"use strict";var o=n(48),a=n(1);n.d(e,"a",function(){return i});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClose=new a.D,e.text$=e.feature$.map(function(t){return t.properties.text}),e.title$=e.feature$.map(function(t){return t.properties.title}),e.icon$=e.feature$.map(function(t){return t.properties.icon}),e}return __extends(e,t),e}(o.b);__decorate([n.i(a.M)(),__metadata("design:type",Object)],i.prototype,"feature",void 0),__decorate([n.i(a.M)(),__metadata("design:type",Object)],i.prototype,"scene",void 0),__decorate([n.i(a.M)(),__metadata("design:type",Boolean)],i.prototype,"active",void 0),__decorate([n.i(a._8)(),__metadata("design:type",Object)],i.prototype,"onClose",void 0),i=__decorate([n.i(a.Z)({selector:"dialog-feature",changeDetection:a._0.OnPush,encapsulation:a.m.None,styles:[n(911)],template:n(657)})],i)},function(t,e,n){"use strict";var o=n(48),a=n(268),i=n(269),r=n(271),s=n(272),c=n(274),u=n(275),p=n(273);n.d(e,"a",function(){return d});var d=[o.a,a.a,i.a,r.a,s.a,p.a,c.a,u.a]},function(t,e,n){"use strict";var o=n(48),a=n(1),i=n(7),r=n(19);n.d(e,"a",function(){return s});var s=function(t){function e(e){var n=t.call(this)||this;return n.store=e,n}return __extends(e,t),e.prototype.entered=function(t){return this.assertFeature(),!!this.properties.target&&(this.store.dispatch(new r.a({location:this.properties.target,position:{x:this.properties.targetX,y:this.properties.targetY}})),!0)},e}(o.b);__decorate([n.i(a.M)(),__metadata("design:type",Object)],s.prototype,"feature",void 0),s=__decorate([n.i(a.Z)({selector:"portal-feature",template:"\n    <ng-content></ng-content>"}),__metadata("design:paramtypes",[i.a])],s)},function(t,e,n){"use strict";var o=n(16),a=n(11),i=n(48),r=n(92),s=n(19),c=n(1);n.d(e,"a",function(){return u});var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tickInterval=-1,e._subscription=null,e}return __extends(e,t),e.prototype.disconnectBehavior=function(){return this._subscription&&(this._subscription.unsubscribe(),this._subscription=null),!0},e.prototype.connectBehavior=function(){var e=this;if(!t.prototype.connectBehavior.call(this))return!1;var n=this.host.world;return n&&(this._subscription=this.host.world.store.select(o.o).distinctUntilChanged().subscribe(function(t){e.host.setPoint(t)})),!0},e.prototype.enter=function(t){return this.party=t.findBehavior(r.a),!!this.party&&(this.partySprite=t.icon,this.party.passableKeys=["shipPassable"],!0)},e.prototype.entered=function(t){return this.board(t)},e.prototype.board=function(t){var e=this;return!(this.partyObject||!this.party)&&(this.partyObject=t,t.setSprite(this.host.icon),this.host.visible=!1,this.host.enabled=!1,this._tickInterval=setInterval(function(){if(a.a.equal(e.partyObject.point,e.party.targetPoint)&&!e.party.heading.isZero()){var t=new a.a(e.partyObject.point),n=t.clone().add(e.party.heading);e.party.collideWithMap(t,"shipPassable")||e.party.collideWithMap(n,"passable")||e.disembark(t,n,e.party.heading.clone())}},32),!0)},e.prototype.disembark=function(t,e,n){clearInterval(this._tickInterval),this.partyObject.setSprite(this.partySprite),this.party.targetPoint.set(e),this.party.velocity.set(n),this.party.passableKeys=["passable"],this.host.point.x=t.x,this.host.point.y=t.y,this.host.visible=!0,this.host.enabled=!0,this.partyObject=null,this.party=null,this.host.world.store.dispatch(new s.t("shipPosition",this.host.point))},e}(i.b);__decorate([n.i(c.M)(),__metadata("design:type",Object)],u.prototype,"feature",void 0),u=__decorate([n.i(c.Z)({selector:"ship-feature",template:"<ng-content></ng-content>"})],u)},function(t,e,n){"use strict";function o(t,e,n){return t.filter(function(t){var o="undefined"==typeof t.level||t.level===n;return o&&r(t,e)})}function a(t,e){return t.filter(function(t){return r(t,e)})}function i(t,e){return void 0===e&&(e=null),function(n){return n&&n.properties&&n.properties[t]?n.properties[t]:e}}function r(t,e){if(!t)return!1;var n=!t.groups||0===e.length;return(t.groups||[]).forEach(function(t){n=n||e.indexOf(t)!==-1}),n}var s=n(48),c=n(1),u=n(35),p=(n.n(u),n(73)),d=n(19),l=n(122),h=n(16),m=n(62),f=n(28),y=n(7);n.d(e,"a",function(){return b});var b=function(t){function e(e,r,s){var m=t.call(this)||this;return m.game=e,m.notify=r,m.store=s,m.onClose=new c.D,m._level$=new u.BehaviorSubject(1),m._weapons$=m.store.select(h.j),m._armors$=m.store.select(h.k),m._items$=m.store.select(h.l),m._selling$=new u.BehaviorSubject(!1),m.name$=m.feature$.map(i("name")),m.groups$=m.feature$.map(i("groups",[])),m.category$=m.feature$.map(i("category")),m.partyGold$=m.store.select(h.d),m.level$=m._level$,m.partyInventory$=m.store.select(h.f).combineLatest(m.category$,function(t,e){return t.filter(function(t){return t&&t.category===e})}).combineLatest(m.groups$,a),m.inventory$=m._weapons$.combineLatest(m._armors$,m._items$,m.category$,function(t,e,n,o){switch(o){case"items":return n;case"weapons":return t;case"armor":return e;default:return n.concat(t).concat(e)}}).combineLatest(m.groups$,m.level$,o),m.selling$=m._selling$,m._selected$=new u.BehaviorSubject(null),m.selected$=m._selected$,m.isBuying$=u.Observable.combineLatest(m.selected$,m.selling$,function(t,e){return!t&&!e}),m.isSelling$=u.Observable.combineLatest(m.selected$,m.selling$,function(t,e){return!t&&e}),m.actionVerb$=m.selling$.map(function(t){return t?"Sell":"Buy"}),m._onAction$=new u.Subject,m._onToggleAction$=new u.Subject,m._doToggleActionSubscription$=m._onToggleAction$.withLatestFrom(m.partyInventory$,function(t,e){var n=m._selling$.value;return n||0!==e.length?void m._selling$.next(!n):(m.notify.show("You don't have any inventory of this type to sell.",null,1500),void m._selling$.next(!1))}).subscribe(),m._doActionSubscription$=m._onAction$.withLatestFrom(m.store.select(h.n),function(t,e){if(m._selected$.value){var o=m._selected$.value,a=m._selling$.value,i=o.value;if(!a&&i>e.gold)return void m.notify.show("You don't have enough money");if(m._selected$.next(null),m._selling$.next(!1),a)m.notify.show("Sold "+o.name+" for "+o.value+" gold.",null,1500),m.store.dispatch(new d.x(o)),m.store.dispatch(new l.d(o.eid)),m.store.dispatch(new d.u(i));else{var r=n.i(p.b)(o);m.notify.show("Purchased "+o.name+".",null,1500),m.store.dispatch(new d.u(-i)),m.store.dispatch(new l.c(r)),m.store.dispatch(new d.w(r))}}}).subscribe(),m}return __extends(e,t),e.prototype.ngOnDestroy=function(){this._doActionSubscription$.unsubscribe(),this._doToggleActionSubscription$.unsubscribe()},e}(s.b);__decorate([n.i(c.M)(),__metadata("design:type",Object)],b.prototype,"feature",void 0),__decorate([n.i(c.M)(),__metadata("design:type",Object)],b.prototype,"scene",void 0),__decorate([n.i(c.M)(),__metadata("design:type",Boolean)],b.prototype,"active",void 0),__decorate([n.i(c._8)(),__metadata("design:type",Object)],b.prototype,"onClose",void 0),b=__decorate([n.i(c.Z)({selector:"store-feature",changeDetection:c._0.OnPush,encapsulation:c.m.None,styles:[n(912)],template:n(658)}),__metadata("design:paramtypes",[m.a,f.a,y.a])],b)},function(t,e,n){"use strict";var o=n(48),a=n(4),i=n.n(a),r=n(1),s=n(35),c=(n.n(s),n(62)),u=n(7),p=n(28),d=n(16),l=n(19);n.d(e,"a",function(){return h});var h=function(t){function e(e,n,o){var a=t.call(this)||this;return a.game=e,a.store=n,a.notify=o,a.onClose=new r.D,a.partyGold$=a.store.select(d.d),a.party$=a.store.select(d.e),a.name$=a.feature$.map(function(t){return t.properties.name}),a.icon$=a.feature$.map(function(t){return t.properties.icon}),a.cost$=a.feature$.map(function(t){return parseInt(t.properties.cost,10)}),a._onRest$=new s.Subject,a}return __extends(e,t),e.prototype.ngOnInit=function(){var t=this;this._onRestSubscription$=this._onRest$.withLatestFrom(this.party$,this.partyGold$,this.cost$,function(e,n,o,a){var r=!n.find(function(t){return console.log(t,c.a.getHPForLevel(1,t)),t.hp!==t.maxhp});if(a>o)t.notify.show("You don't have enough money");else if(r)t.notify.show("Keep your money.\nYour party is already fully healed.");else{var s=n.map(function(t){return t.eid}).toArray();t.store.dispatch(new l.v({cost:a,partyIds:s}));var u="Your party has been healed! \nYou have ("+(o-a)+") monies.";t.notify.show(u,null,5e3)}i.a.defer(function(){t.onClose.next({})})}).subscribe()},e.prototype.ngOnDestroy=function(){this._onRestSubscription$.unsubscribe()},e}(o.b);__decorate([n.i(r._8)(),__metadata("design:type",Object)],h.prototype,"onClose",void 0),__decorate([n.i(r.M)(),__metadata("design:type",Object)],h.prototype,"scene",void 0),__decorate([n.i(r.M)(),__metadata("design:type",Boolean)],h.prototype,"active",void 0),__decorate([n.i(r.M)(),__metadata("design:type",Array)],h.prototype,"party",void 0),__decorate([n.i(r.M)(),__metadata("design:type",Object)],h.prototype,"feature",void 0),h=__decorate([n.i(r.Z)({selector:"temple-feature",styles:[n(913)],changeDetection:r._0.OnPush,encapsulation:r.m.None,template:n(659)}),__metadata("design:paramtypes",[c.a,u.a,p.a])],h)},function(t,e,n){"use strict";var o=n(48),a=n(1),i=n(19),r=n(7),s=n(28),c=n(16),u=n(73),p=n(122);n.d(e,"a",function(){return d});var d=function(t){function e(e,n){var o=t.call(this)||this;return o.store=e,o.notify=n,o._weapons$=o.store.select(c.j),o._armors$=o.store.select(c.k),o._items$=o.store.select(c.l),o.inventory$=o._weapons$.combineLatest(o._armors$,o._items$,function(t,e,n){return n.concat(t).concat(e)}),o}return __extends(e,t),e.prototype.ngAfterViewInit=function(){if(!this.properties.id)throw new Error("treasure must always have a unique lower-snake-case id")},e.prototype.enter=function(t){var e=this;return"undefined"!=typeof this.properties.gold&&(this.store.dispatch(new i.u(this.properties.gold)),this.notify.show("You found "+this.properties.gold+" gold!",null,0)),"string"==typeof this.properties.item&&this.inventory$.take(1).do(function(t){var o=t.find(function(t){return t.id===e.properties.item});if(!o)throw new Error("could not find item template for id: "+e.properties.item);var a=n.i(u.b)(o);e.store.dispatch(new p.c(a)),e.store.dispatch(new i.w(a)),e.notify.show("You found "+o.name+"!",null,0)}).subscribe(),this.store.dispatch(new i.t(this.properties.id,!0)),!0},e}(o.b);__decorate([n.i(a.M)(),__metadata("design:type",Object)],d.prototype,"feature",void 0),d=__decorate([n.i(a.Z)({selector:"treasure-feature",template:"\n    <ng-content></ng-content>"}),__metadata("design:paramtypes",[r.a,s.a])],d)},function(t,e,n){"use strict";var o=n(1),a=n(90),i=n(39),r=n(462),s=n(49),c=n(48),u=n(185),p=n(277),d=n(16),l=n(11),h=n(46),m=n(7),f=n(95),y=n(34);n.n(y);n.d(e,"b",function(){return b}),n.d(e,"a",function(){return v});var b=function(t){function e(e,n,o,a){var i=t.call(this)||this;return i.gameStateService=e,i.store=n,i.loadingService=o,i.loader=a,i.self=i,i.renderPoint=new l.a,i._subscriptions=[],i.resource$=i.gameStateService.worldMap$.distinctUntilChanged().map(function(t){return i.setMap(t),t}),i.features$=i.resource$.map(function(){return i.features.objects}),i.activeFeatures$=i.store.select(d.r).combineLatest(i.features$,function(t,e){return e.filter(function(e){return!e.properties||!e.properties.id||t.get(e.properties.id)!==!0})}),i._renderPoint$=new y.BehaviorSubject(i.renderPoint),i.renderPoint$=i.store.select(d.s).combineLatest(i._renderPoint$,function(t,e){return i.renderPoint.set(t||e)}),i.objectRenderer=new u.a,i.notTraveling$=i.loadingService.loading$.map(function(t){return!t}),i.position$=i.store.select(d.s).distinctUntilChanged().do(function(t){i.renderPoint=new l.a(t)}),i.partyLeader$=i.store.select(d.e).map(function(t){return t.get(0)}),i}return __extends(e,t),e.prototype.ngAfterViewInit=function(){var t=this;this.scene.addObject(this),this.behaviors.forEach(function(e){t.addBehavior(e)}),this._subscriptions.push(this.position$.subscribe())},e.prototype.ngOnDestroy=function(){var t=this;this.scene.removeObject(this),this.behaviors.forEach(function(e){t.removeBehavior(e)}),this._subscriptions.forEach(function(t){return t.unsubscribe()}),this._subscriptions.length=0,this.destroy()},e.prototype.beforeFrame=function(t,e){},e.prototype.renderFrame=function(t,e){var n=this;this.mapFeatures.forEach(function(e){if(e.host){var o=e.host;n.objectRenderer.render(o,o.renderPoint||o.point,t,o.meta)}})},e.prototype.afterFrame=function(t,e){},e}(f.a);__decorate([n.i(o.M)(),__metadata("design:type",s.a)],b.prototype,"scene",void 0),__decorate([n.i(o._14)(p.b),__metadata("design:type",p.b)],b.prototype,"player",void 0),__decorate([n.i(o._18)("input"),__metadata("design:type",o._19)],b.prototype,"behaviors",void 0),__decorate([n.i(o._18)(c.a),__metadata("design:type",o._19)],b.prototype,"mapFeatures",void 0),b=__decorate([n.i(o.Z)({selector:"world-map",changeDetection:o._0.OnPush,template:n(661)}),__metadata("design:paramtypes",[a.a,m.a,h.a,i.a])],b);var v=[b,c.a,r.a]},function(t,e,n){"use strict";var o=n(1),a=n(93),i=n(95),r=n(461),s=n(92),c=n(463),u=n(465),p=n(176),d=n(464),l=n(49),h=n(11),m=n(185),f=n(38),y=n(48),b=n(35);n.n(b);n.d(e,"b",function(){return v}),n.d(e,"a",function(){return g});var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.self=e,e.targetFill="rgba(10,255,10,0.3)",e.targetStroke="rgba(10,255,10,0.3)",e.targetStrokeWidth=1.5,e._featureComponent$=new b.BehaviorSubject(null),e.featureComponent$=e._featureComponent$,e.objectRenderer=new m.a,e}return __extends(e,t),e.prototype.ngAfterViewInit=function(){var t=this;this.setSprite(this.model.icon),this.scene.addObject(this),this.behaviors.forEach(function(e){t.addBehavior(e)})},e.prototype.ngOnDestroy=function(){var t=this;this.scene.removeObject(this),this.behaviors.forEach(function(e){t.removeBehavior(e)}),this.destroy()},e.prototype.onFeatureLook=function(t){var e=t.findBehavior(y.b);e&&(e.enter(this),this.feature=e)},e.prototype.onFeatureLookAway=function(t){var e=t.findBehavior(y.b);e&&(e.exit(this),this.feature=null)},Object.defineProperty(e.prototype,"feature",{get:function(){return this._featureComponent$.value},set:function(t){this._featureComponent$.next(t)},enumerable:!0,configurable:!0}),e.prototype.escapeFeature=function(){this.feature&&this.onFeatureLookAway(this.feature.host)},e.prototype.beforeFrame=function(t,e){},e.prototype.renderFrame=function(t,e){if(this.objectRenderer.render(this,this.renderPoint||this.point,t,this.meta),this.movable){var n=this.movable;if(this.movable.path&&this.movable.path.length>0){t.context.save();var o=n.path[n.path.length-1].clone();o.x-=.5,o.y-=.5;var a=t.worldToScreen(new f.a(o,new h.a(1,1)));t.context.fillStyle=this.targetFill,t.context.fillRect(a.point.x,a.point.y,a.extent.x,a.extent.y),t.context.strokeStyle=this.targetStroke,t.context.lineWidth=this.targetStrokeWidth,t.context.strokeRect(a.point.x,a.point.y,a.extent.x,a.extent.y),t.context.restore()}}},e.prototype.afterFrame=function(t,e){},e}(a.a);__decorate([n.i(o._18)("render,collision,path,player,trigger,camera,encounter"),__metadata("design:type",o._19)],v.prototype,"behaviors",void 0),__decorate([n.i(o.M)(),__metadata("design:type",String)],v.prototype,"icon",void 0),__decorate([n.i(o.M)(),__metadata("design:type",Object)],v.prototype,"model",void 0),__decorate([n.i(o.M)(),__metadata("design:type",l.a)],v.prototype,"scene",void 0),__decorate([n.i(o.M)(),__metadata("design:type",i.a)],v.prototype,"map",void 0),__decorate([n.i(o.M)(),__metadata("design:type",h.a)],v.prototype,"point",void 0),__decorate([n.i(o._14)(s.a),__metadata("design:type",s.a)],v.prototype,"movable",void 0),v=__decorate([n.i(o.Z)({selector:"world-player",changeDetection:o._0.OnPush,template:'\n    <player-render-behavior #render></player-render-behavior>\n    <collision-behavior #collision></collision-behavior>\n    <player-map-path-behavior [tileMap]="map" #path></player-map-path-behavior>\n    <player-behavior (onCompleteMove)="encounter.completeMove($event)" #player></player-behavior>\n    <combat-encounter-behavior [scene]="scene" #encounter [tileMap]="map" [player]="self"></combat-encounter-behavior>\n    <player-camera-behavior #camera></player-camera-behavior>\n    <player-look-behavior\n      (onLook)="onFeatureLook($event)"\n      (onLookAway)="onFeatureLookAway($event)"\n      #trigger></player-look-behavior>\n    <ng-content></ng-content>\n  '})],v);var g=[v,r.a,s.a,c.a,u.a,p.b,d.a]},function(t,e,n){"use strict";var o=n(1),a=n(28),i=n(62),r=n(37),s=n(7),c=n(92),u=n(49),p=n(76),d=n(291),l=n(130),h=n(186),m=n(46),f=n(246),y=n(276),b=n(94),v=n(38),g=n(11);n.d(e,"a",function(){return _});var _=function(t){function e(e,n,o,a,i){var r=t.call(this)||this;return r.game=e,r.notify=n,r.loadingService=o,r.store=a,r.world=i,r.debug=!1,r.styleBackground="rgba(0,0,0,1)",r.mouse=null,r.scene=new u.a,r.world.mark(r.scene),r.world.time.start(),r}return __extends(e,t),e.prototype.handleKeyboardEvent=function(t){"Escape"===t.key?this.map.player&&this.map.player.feature?this.map.player.escapeFeature():this.partyMenu&&(this.partyMenu.open=!this.partyMenu.open):"1"===t.key&&(this.debug=!this.debug)},e.prototype.ngOnDestroy=function(){this.world.erase(this.scene),this.scene.removeView(this)},e.prototype.ngAfterViewInit=function(){var t=this;this.canvas=this.canvasElementRef.nativeElement,this.camera.point.set(-.5,-.5),this.scene.addView(this),setTimeout(function(){return t._onResize()},1)},e.prototype._onResize=function(e){if(t.prototype._onResize.call(this,e),this.map){var n=this.map.bounds.getCenter(),o=this._bounds.clone().divide(2).multiply(-1).add(n);this.camera.point.set(o.floor())}this.camera.extent.set(this._bounds)},e.prototype.onAddToScene=function(e){t.prototype.onAddToScene.call(this,e),this.mouse=this.world.input.mouseHook(this,"world"),e.on(p.a.Events.MAP_LOADED,this.syncBehaviors,this)},e.prototype.onRemoveFromScene=function(t){this.world.input.mouseUnhook("world"),t.off(p.a.Events.MAP_LOADED,this.syncBehaviors,this)},e.prototype._onClick=function(t){if(t.srcElement===this.canvas){var e=this.scene.componentByType(d.a),n=this.scene.componentByType(c.a);return e&&n?(l.a.mouseOnView(t,this.mouse.view,this.mouse),n.path=e.calculatePath(n.targetPoint,this.mouse.world),t.preventDefault(),!1):void 0}},e.prototype.renderFrame=function(e){return t.prototype.renderFrame.call(this,e),this.map&&(this.map.renderFrame(this,e),this.map.player&&this.map.player.renderFrame(this,e)),this.debug&&this.debugRender(),this},e.prototype.debugRender=function(){var t=this,e=["Camera: ("+this.camera.point.x+","+this.camera.point.y+")"],n=this.scene.objectByComponent(c.a);n&&e.push("Player: ("+n.point.x+","+n.point.y+")");var o=this.getCameraClip();e.push("Clip: ("+o.point.x+","+o.point.y+") ("+o.extent.x+","+o.extent.y+")"),this.context.strokeStyle="#00ff00";var a=this.worldToScreen(o);this.context.strokeRect(a.point.x,a.point.y,a.extent.x,a.extent.y),this.context.strokeStyle="#ff0000";for(var i=o.point.x,r=o.getRight(),s=o.point.y,u=o.getBottom(),p=function(e){for(var n=function(n){d.map.getLayers().forEach(function(o){var a=t.map.getTerrain(o.name,e,n);if(a&&!a.passable){var i=t.worldToScreen(new v.a(new g.a(e-.5,n-.5),new g.a(1,1)));t.context.strokeRect(i.point.x,i.point.y,i.extent.x,i.extent.y)}})},o=s;o<=u;o++)n(o)},d=this,l=i;l<=r;l++)p(l);this.context.strokeStyle="#0000FF";var h=this.scene.objectsByType(b.a);h.forEach(function(e){var n=e.renderPoint||e.point,o=t.worldToScreen(new v.a(new g.a(n.x-.5,n.y-.5),new g.a(1,1)));t.context.strokeRect(o.point.x,o.point.y,o.extent.x,o.extent.y)}),e.push("MSPF: "+this.world.time.mspf),e.push("FPS:  "+this.scene.fps.toFixed(0));var m=6;this.context.save(),this.context.font="bold "+m+"px GraphicPixel";var f,y=this.worldToScreen(o.point),_=y.x+10,x=y.y+10;for(f=0;f<e.length;++f)this.context.fillStyle="rgba(0,0,0,0.8)",this.context.fillText(e[f],_+1,x+1),this.context.fillStyle="rgba(255,255,255,1)",this.context.fillText(e[f],_,x),x+=m;this.context.restore()},e}(h.a);__decorate([n.i(o._14)("worldCanvas"),__metadata("design:type",o.K)],_.prototype,"canvasElementRef",void 0),__decorate([n.i(o._14)(f.a),__metadata("design:type",f.a)],_.prototype,"partyMenu",void 0),__decorate([n.i(o._4)("document:keyup",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[KeyboardEvent]),__metadata("design:returntype",void 0)],_.prototype,"handleKeyboardEvent",null),__decorate([n.i(o._14)(y.b),__metadata("design:type",y.b)],_.prototype,"map",void 0),_=__decorate([n.i(o.Z)({selector:"world",styles:[n(914)],changeDetection:o._0.OnPush,encapsulation:o.m.None,template:n(662),host:{"(window:resize)":"_onResize($event)","(click)":"_onClick($event)","[style.color]":"styleBackground"}}),__metadata("design:paramtypes",[i.a,a.a,m.a,s.a,r.a])],_)},function(t,e,n){"use strict";var o=n(101),a=n(1),i=n(7),r=n(16);n.d(e,"a",function(){return s});var s=function(){function t(t,e){this.store=t,this.router=e}return t.prototype.canActivate=function(t,e){var n=this;return this.store.select(r.v).take(1).map(function(e){return e===t.params.id||(n.router.navigate(["/"]),!1)})},t}();s=__decorate([n.i(a.d)(),__metadata("design:paramtypes",[i.a,o.a])],s)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(63)),i=n(127);n.d(e,"a",function(){return r});var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._connectedBehaviors=[],e}return __extends(e,t),e.prototype.destroy=function(){o.each(this._connectedBehaviors,function(t){t.disconnectBehavior()}),this._connectedBehaviors.length=0},e.prototype.findBehavior=function(t){for(var e=this._connectedBehaviors,n=this._connectedBehaviors.length,o=0;o<n;o++){var a=e[o];if(a instanceof t)return a}return null},e.prototype.findBehaviors=function(t){for(var e=this._connectedBehaviors,n=[],o=this._connectedBehaviors.length,a=0;a<o;a++){var i=e[a];i instanceof t&&n.push(i)}return n},e.prototype.findBehaviorByName=function(t){for(var e=this._connectedBehaviors,n=this._connectedBehaviors.length,o=0;o<n;o++){var a=e[o];if(a.name===t)return a}return null},e.prototype.syncBehaviors=function(){for(var t=this._connectedBehaviors,e=this._connectedBehaviors.length,n=0;n<e;n++)t[n].syncBehavior()},e.prototype.addBehavior=function(t,e){if(!t)throw new Error(a.a.REQUIRED_ARGUMENT);if(o.where(this._connectedBehaviors,{id:t.id}).length>0)throw new Error(a.a.ALREADY_EXISTS);return t.host=this,t.connectBehavior()===!1?(delete t.host,!1):(this._connectedBehaviors.push(t),e!==!0&&this.syncBehaviors(),!0)},e.prototype.removeBehaviorByType=function(t,e){void 0===e&&(e=!1);var n=this.findBehavior(t);return!!n&&this.removeBehavior(n,e)},e.prototype.removeBehavior=function(t,e){void 0===e&&(e=!1);var n=this._connectedBehaviors.length;this._connectedBehaviors=o.filter(this._connectedBehaviors,function(e){return e.id!==t.id||(e.disconnectBehavior()===!1||(e.host=null,!1))});var a=this._connectedBehaviors.length!==n;return a&&e!==!0&&this.syncBehaviors(),a},e}(i.a)},function(t,e,n){"use strict";var o=n(127),a=n(4);n.n(a);n.d(e,"a",function(){return i});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=a.uniqueId("sc"),e}return __extends(e,t),e.prototype.connectBehavior=function(){return!0},e.prototype.disconnectBehavior=function(){return!0},e.prototype.syncBehavior=function(){return!0},e.prototype.toString=function(){var t=this.constructor,e=t?t.toString().match(/function (.+?)\(/):null;return t&&t.name?t.name:e&&e[1]?e[1]:this.name},e}(o.a)},function(t,e,n){"use strict";var o=n(97),a=n(63),i=n(183),r=n(4);n.n(r);n.d(e,"a",function(){return s});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._source=null,e._audio=null,e._volume=.8,e}return __extends(e,t),e.supportedFormats=function(){var t=this,n=window,o=n.AudioContext||n.webkitAudioContext;if(null===e._context&&o&&(e._context=new o),null===e._types){this._types=[];var a=document.createElement("audio");if(a.canPlayType)try{a.canPlayType("audio/wav;"),r.each(this.FORMATS,function(e){var n=e[1],o=e[0];r.each(n,function(e){a.canPlayType(e)&&t._types.push({extension:o,type:e})})})}catch(t){}}return this._types.slice()},e.prototype.fetch=function(t){this.url=t||this.url;var n=e.supportedFormats(),o=this.url.lastIndexOf(".");if(o!==-1){var i=this.url.substr(o+1);n=n.sort(function(t,e){return e.extension===i?1:0})}return 0===n.length?Promise.reject(a.a.UNSUPPORTED_OPERATION):this._loadAudioElement(n)},e.prototype.play=function(t){return void 0===t&&(t=0),this._source&&this._source.start(t),this},e.prototype.pause=function(){return this._source&&this._source.stop(0),this},Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t},enumerable:!0,configurable:!0}),e.prototype._getUrlForFormat=function(t){var e=this.url.lastIndexOf("."),n=this.url;return e!==-1&&(n=n.substr(0,e)),n+"."+t.extension},e.prototype._loadAudioElement=function(t){var e=this;return new Promise(function(n,o){var a,s=t.length,c=[],u=document.createElement("audio"),p=(new i.a).start().addObject({tick:function(){return u.readyState>3?a():null}});a=function(){e.data=u,e._audio=u,p.stop(),n(e)};var d=function(t){s--,c.push(t),s<=0&&o("No valid sources at the following URLs\n"+c.join("\n   "))};return 0===s?o("no supported media types"):(u.addEventListener("canplaythrough",a),r.each(t,function(t){var n=document.createElement("source");n.addEventListener("error",function(){console.log("source failed: "+n.src),d(n.src)}),n.type=t.type.substr(0,t.type.indexOf(";")),n.src=e._getUrlForFormat(t),u.appendChild(n)}),void u.load())})},e}(o.a);s.FORMATS=[["mp3",["audio/mpeg;"]],["m4a",["audio/x-m4a;"]],["aac",["audio/mp4a;","audio/mp4;"]],["ogg",['audio/ogg; codecs="vorbis"']],["wav",['audio/wav; codecs="1"']]],s._context=null,s._types=null},function(t,e,n){"use strict";var o=n(97),a=n(100);n.n(a);n.d(e,"a",function(){return i});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.fetch=function(t){var e=this;return this.url=t||this.url,new Promise(function(t,n){var o=a.getJSON(e.url);o.done(function(n){e.data=n,t(e)}),o.fail(function(t,e,o){n(o)})})},e}(o.a)},function(t,e,n){"use strict";var o=n(183),a=n(1);n.d(e,"a",function(){return i});var i=function(){function t(){this.time=o.a.get()}return t.prototype.setService=function(t,e){return this.mark(e),this[t]=e,e},t.prototype.mark=function(t){t&&(t.world=this,t.onAddToWorld&&t.onAddToWorld(this))},t.prototype.erase=function(t){t&&(t.onRemoveFromWorld&&t.onRemoveFromWorld(this),delete t.world)},t}();i=__decorate([n.i(a.d)()],i)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(127));n.d(e,"a",function(){return i});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultState=null,e.states=[],e._currentState=null,e._previousState=null,e._newState=!1,e._pendingState=null,e._asyncProcessing=0,e._asyncCurrentCallback=null,e}return __extends(e,t),e.prototype.update=function(t){this._newState=!1,null===this._currentState&&this.setCurrentState(this.defaultState),null!==this._currentState&&this._currentState.update(this),this._newState===!1&&null!==this._currentState&&(this._previousState=this._currentState)},e.prototype.addState=function(t){this.states.push(t)},e.prototype.addStates=function(t){this.states=o.unique(this.states.concat(t))},e.prototype.getCurrentState=function(){return this._currentState},e.prototype.getCurrentName=function(){return null!==this._currentState?this._currentState.name:null},e.prototype.setCurrentState=function(t){var e=this,n="string"==typeof t?this.getState(t):t;return n?(null!==this._pendingState&&this._pendingState.name!==n.name?(console.log("Overwriting pending state ("+this._pendingState.name+") with ("+n.name+")"),this._pendingState=n):this._pendingState||(this._pendingState=n,o.defer(function(){n=e._pendingState,e._pendingState=null,e._setCurrentState(n)||console.error("Failed to set state: "+n.name)})),!0):(console.error("STATE NOT FOUND: "+t),!1)},e.prototype._setCurrentState=function(t){if(!t)return!1;var n=this._currentState;return this._currentState&&t.name===this._currentState.name?(console.warn(this._currentState.name+": Attempting to set current state to already active state"),!0):(this._newState=!0,this._previousState=this._currentState,this._currentState=t,e.DEBUG_STATES&&console.log("STATE: "+(n?n.name:"NULL")+" -> "+this._currentState.name),n&&(this.trigger(e.Events.EXIT,n,t),n.exit(this)),t.enter(this),this.trigger(e.Events.ENTER,t,n),!0)},e.prototype.getPreviousState=function(){return this._previousState},e.prototype.getState=function(t){return o.find(this.states,function(e){return e.name===t})},e.prototype.notify=function(t,e,n){var o=this;if(this._asyncProcessing>0)throw new Error("TODO: StateMachine cannot handle multiple async UI waits");this._asyncCurrentCallback=function(){o._asyncProcessing--,o._asyncProcessing<=0&&(n&&n(),o._asyncProcessing=0)},this._asyncProcessing=0,this.trigger(t,e),0===this._asyncProcessing&&n&&n()},e.prototype.notifyWait=function(){if(!this._asyncCurrentCallback)throw new Error("No valid async callback set!  Perhaps you called this outside of a notify event handler?");
return this._asyncProcessing++,this._asyncCurrentCallback},e}(a.a);i.DEBUG_STATES=!0,i.Events={ENTER:"enter",EXIT:"exit"}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(){this.transitions=[]}return t.prototype.enter=function(t){},t.prototype.exit=function(t){},t.prototype.update=function(t){for(var e=this.transitions.length,n=0;n<e;n++){var o=this.transitions[n];if(o.evaluate(t)&&t.setCurrentState(o.targetState))return}},t}();(function(){function t(){}return t.prototype.evaluate=function(t){return!0},t})()},function(t,e,n){"use strict";var o=n(11),a=n(75),i=n(130),r=n(102),s=n(160);n.d(e,"a",function(){return c});var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._elapsed=0,e.path=[],e.tickRateMS=250,e.velocity=new o.a(0,0),e.workPoint=new o.a(0,0),e.currentMove=null,e}return __extends(e,t),e.prototype.connectBehavior=function(){return this.host.point=new o.a(this.host.point).round(),this.targetPoint=new o.a(this.host.point),this.host.renderPoint=this.targetPoint.clone(),t.prototype.connectBehavior.call(this)},e.prototype.syncBehavior=function(){return this.collider=this.host.findBehavior(s.a),t.prototype.syncBehavior.call(this)},e.prototype.beginMove=function(t){},e.prototype.completeMove=function(t){},e.prototype.collideMove=function(t,e,n){return void 0===n&&(n=[]),!!this.collider&&this.collider.collide(t,e,r.a,n)},e.prototype.updateVelocity=function(){if(this.host.scene&&this.host.scene.world&&this.host.scene.world.input){var t=this.host.scene.world.input;this.velocity.x=0,t.keyDown(i.b.LEFT)&&(this.velocity.x-=1),t.keyDown(i.b.RIGHT)&&(this.velocity.x+=1),this.velocity.y=0,t.keyDown(i.b.UP)&&(this.velocity.y-=1),t.keyDown(i.b.DOWN)&&(this.velocity.y+=1)}},e.prototype.interpolateTick=function(t){var e=this._elapsed/this.tickRateMS;this.host.renderPoint.x=this.host.point.x,this.host.renderPoint.y=this.host.point.y,this.velocity.isZero()||(o.a.interpolate(this.host.renderPoint,this.host.point,this.targetPoint,e),this.host.renderPoint.x=parseFloat(this.host.renderPoint.x.toFixed(2)),this.host.renderPoint.y=parseFloat(this.host.renderPoint.y.toFixed(2)))},e.prototype.tick=function(t){if(this._elapsed+=t,!(this._elapsed<this.tickRateMS)){this._elapsed=this._elapsed%this.tickRateMS,this.targetPoint.equal(this.host.point)||this.collideMove(this.targetPoint.x,this.targetPoint.y)||(this.workPoint.set(this.host.point),this.host.point.x=this.targetPoint.x,this.host.point.y=this.targetPoint.y,this.completeMove(this.currentMove)),this.updateVelocity(),this.targetPoint.set(this.host.point);var e=this.velocity.isZero();if(!e||0!==this.path.length){if(e){var n=this.path.shift();this.velocity.set(n.x-this.host.point.x,n.y-this.host.point.y)}else this.path.length=0;if(this.targetPoint.add(this.velocity),0===this.velocity.y||this.collideMove(this.host.point.x,this.targetPoint.y)){if(0===this.velocity.x||this.collideMove(this.targetPoint.x,this.host.point.y))return this.targetPoint.set(this.host.point),void(this.path.length=0);this.targetPoint.y=this.host.point.y}else this.targetPoint.x=this.host.point.x;this.currentMove={from:new o.a(this.host.point),to:new o.a(this.targetPoint)},this.beginMove(this.currentMove)}}},e}(a.a)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(42)),i=n(37);n.d(e,"a",function(){return s});var r={url:null,volume:1,loop:!1},s=function(t){function e(e){void 0===e&&(e=r);var n=t.call(this)||this;return"undefined"!=typeof e&&o.extend(n,r,e),n}return __extends(e,t),e.prototype.disconnectBehavior=function(){return this.audio&&this.audio.data&&(this.audio.data.pause(),this.audio.data.currentTime=0),t.prototype.disconnectBehavior.call(this)},e.prototype.connectBehavior=function(){var e=this;if(!t.prototype.connectBehavior.call(this)||!this.url)return!1;if(this.audio&&this.audio.data)return this.audio.data.currentTime=0,this.audio.data.volume=this.volume,!0;var n=i.a.get();return!(!n||!n.loader)&&(n.loader.load(this.url).then(function(t){var n=t[0];e.audio=n,e.audio.data&&(e.audio.data.currentTime=0,e.audio.data.volume=e.volume,e.audio.data.loop=e.loop,e.audio.data.play(),e.audio.data.addEventListener("timeupdate",function(){e.audio.data.currentTime>=e.audio.data.duration&&(e.loop?e.trigger("audio:loop",e):(e.audio.data.pause(),e.trigger("audio:done",e)))}))}),!0)},e}(a.a)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(102)),i=n(38),r=n(470),s=n(11);n.d(e,"a",function(){return c});var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animations=[],e.cameraComponent=null,e.scene=null,e._canvas=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},set:function(t){if(this._canvas=t,!t)return void(this.context=this.canvas=null);if(this.context=t.getContext("2d"),!this.context)throw new Error("SceneView: could not retrieve 2d Canvas context");var n=this.context;n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,this.camera=new i.a(0,0,9,9),this.cameraScale=1,this.unitSize=e.UNIT},enumerable:!0,configurable:!0}),e.prototype.renderToCanvas=function(t,e,n){var o=document.createElement("canvas");o.width=t,o.height=e;var a=o.getContext("2d");return a.webkitImageSmoothingEnabled=!1,a.mozImageSmoothingEnabled=!1,n(a),o},e.prototype.renderFrame=function(t){var e=this;o.each(this._connectedBehaviors,function(n){n instanceof r.a&&n.renderFrame(e,t)})},e.prototype.renderPost=function(){},e.prototype.setRenderState=function(){this.context&&(this.context.save(),this.context.scale(this.cameraScale,this.cameraScale))},e.prototype.restoreRenderState=function(){return!!this.context&&(this.context.restore(),!0)},e.prototype.render=function(){this._render(0)},e.prototype._render=function(t){var e=this;this.processCamera(),this.setRenderState(),o.each(this._connectedBehaviors,function(n){n instanceof r.a&&n.beforeFrame(e,t)}),this.renderFrame(t),this.renderAnimations(),this.renderPost(),o.each(this._connectedBehaviors,function(n){n instanceof r.a&&n.afterFrame(e,t)}),this.restoreRenderState()},e.prototype.processCamera=function(){this.cameraComponent&&this.cameraComponent.process(this)},e.prototype.clearRect=function(){var t,e=0,n=0;return this.camera&&(t=this.worldToScreen(this.camera.point),e=t.x,n=t.y),this.context.clearRect(e,n,this.context.canvas.width,this.context.canvas.height)},e.prototype.worldToScreen=function(t,e){if(void 0===e&&(e=1),t instanceof i.a){var n=new i.a(t);return n.point.multiply(this.unitSize*e),n.extent.multiply(this.unitSize*e),n}return t instanceof s.a?new s.a(t).multiply(this.unitSize*e):t*(this.unitSize*e)},e.prototype.screenToWorld=function(t,e){if(void 0===e&&(e=1),t instanceof i.a){var n=new i.a(t);return n.point.multiply(1/(this.unitSize*e)),n.extent.multiply(1/(this.unitSize*e)),n}return t instanceof s.a?new s.a(t).multiply(1/(this.unitSize*e)):t*(1/(this.unitSize*e))},e.prototype.fastWorldToScreenPoint=function(t,e,n){return void 0===n&&(n=1),e.set(t),e.multiply(this.unitSize*n),e},e.prototype.fastWorldToScreenRect=function(t,e,n){return void 0===n&&(n=1),e.set(t),e.point.multiply(this.unitSize*n),e.extent.multiply(this.unitSize*n),e},e.prototype.fastWorldToScreenNumber=function(t,e){return void 0===e&&(e=1),t*(this.unitSize*e)},e.prototype.fastScreenToWorldPoint=function(t,e,n){return void 0===n&&(n=1),e.set(t),e.multiply(1/(this.unitSize*n)),e},e.prototype.fastScreenToWorldRect=function(t,e,n){return void 0===n&&(n=1),e.set(t),e.point.multiply(1/(this.unitSize*n)),e.extent.multiply(1/(this.unitSize*n)),e},e.prototype.fastScreenToWorldNumber=function(t,e){return void 0===e&&(e=1),t*(1/(this.unitSize*e))},e.prototype.renderAnimations=function(){for(var t=this.animations.length,e=0;e<t;e++){var n=this.animations[e];n.done=n.fn(n.frame),this.scene.time>=n.time&&(n.frame+=1,n.time=this.scene.time+n.rate)}return this.animations=o.filter(this.animations,function(t){return t.done!==!0})},e}(a.a);c.UNIT=16},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(103)),i=n(75);n.d(e,"a",function(){return r});var r=function(t){function e(e){void 0===e&&(e={lengthMS:500,spriteName:null});var n=t.call(this)||this;return n._elapsed=0,n._renderFrame=3,n.lengthMS=500,"undefined"!=typeof e&&o.extend(n,e),n}return __extends(e,t),e.prototype.connectBehavior=function(){return this._renderFrame=0,this._elapsed=0,t.prototype.connectBehavior.call(this)},e.prototype.syncBehavior=function(){if(!t.prototype.syncBehavior.call(this))return!1;var e=this.host.findBehaviors(a.a);return this.spriteComponent=o.where(e,{name:this.spriteName})[0],!!this.spriteComponent},e.prototype.tick=function(e){this._elapsed+=e,this._elapsed>=this.lengthMS&&(this.trigger("animation:done",this),this._elapsed=this._elapsed%this.lengthMS),t.prototype.tick.call(this,e)},e.prototype.interpolateTick=function(e){if(this.spriteComponent&&this.spriteComponent.meta){var n=this._elapsed/this.lengthMS;this.spriteComponent.frame=n*this.spriteComponent.meta.frames|0}t.prototype.interpolateTick.call(this,e)},e}(i.a)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(187)),i=n(76),r=n(11),s=n(644);n.n(s);n.d(e,"a",function(){return c});var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._graph=null,e}return __extends(e,t),e.prototype.connectBehavior=function(){return t.prototype.connectBehavior.call(this)&&!!this.tileMap},e.prototype.syncBehavior=function(){return this.tileMap.off(i.a.Events.LOADED,this._updateGraph,this),this.tileMap.on(i.a.Events.LOADED,this._updateGraph,this),t.prototype.syncBehavior.call(this)},e.prototype.disconnectBehavior=function(){return this.tileMap.off(i.a.Events.LOADED,this._updateGraph,this),this._graph=null,t.prototype.disconnectBehavior.call(this)},e.prototype._updateGraph=function(){var t=this.buildWeightedGraph();this._graph=new s.Graph(t)},e.prototype.buildWeightedGraph=function(){return[[]]},e.prototype.calculatePath=function(t,e){if(this._graph||this._updateGraph(),!this._graph||!this._graph.grid)throw new Error("Invalid AStar graph");if(this._graph.init(),t.x>=this._graph.grid.length||t.x<0)return[];if(t.y>=this._graph.grid[t.x].length)return[];if(e.x>=this._graph.grid.length||e.x<0)return[];if(e.y>=this._graph.grid[e.x].length)return[];var n=this._graph.grid[t.x][t.y],a=this._graph.grid[e.x][e.y],i=s.astar.search(this._graph,n,a);return o.map(i,function(t){return new r.a(t.x,t.y)})},e}(a.a)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(468)),i=n(38);n.d(e,"a",function(){return r});var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffer=null,e.bufferMapName=null,e.bufferComplete=!1,e._clipRect=new i.a,e._renderRect=new i.a,e}return __extends(e,t),e.prototype.render=function(t,e){var n,a,i,r=this,s=8,c=s*e.unitSize;if(t.isLoaded()){if(t.dirtyLayers&&(t.dirtyLayers=!1,this.buffer=null,this.bufferComplete=!1),!this.bufferComplete||null===this.buffer||null===this.bufferMapName||this.bufferMapName!==t.map.url){var u=c/e.unitSize,p=Math.ceil(t.bounds.extent.x/s);for(i=Math.ceil(t.bounds.extent.y/s),this.buffer=new Array(p),a=0;a<p;a++)this.buffer[a]=new Array(i);this.bufferComplete=!0;var d=t.getLayers();for(a=0;a<p;a++){var l=function(){var i=a*u,s=i+u,p=n*u,l=p+u;h.buffer[a][n]=e.renderToCanvas(c,c,function(n){for(var a=function(a){for(var s=function(s){o.each(d,function(o){if(o.visible){var c=t.getTileGid(o.name,a,s),u=t.getTileMeta(c);if(u){var d=u.image.data;if(!d||!d.complete)return void(r.bufferComplete=!1);var l=u.x,h=u.y,m=u.width,f=u.height,y=(a-i)*e.unitSize,b=(s-p)*e.unitSize,v=e.unitSize,g=e.unitSize;n.drawImage(d,l,h,m,f,y,b,v,g)}}})},c=p;c<l;c++)s(c)},c=i;c<s;c++)a(c)})},h=this;for(n=0;n<i;n++)l()}this.bufferMapName=t.map.url}var m=e.fastWorldToScreenNumber(s);e.fastWorldToScreenRect(e.getCameraClip(),this._clipRect);var f=this.buffer.length;for(i=this.buffer[0].length,a=0;a<f;a++)for(n=0;n<i;n++)this._renderRect.set(a*s-.5,n*s-.5,s,s),e.fastWorldToScreenRect(this._renderRect,this._renderRect),this._renderRect.intersect(this._clipRect)&&e.context.drawImage(this.buffer[a][n],0,0,c,c,this._renderRect.point.x,this._renderRect.point.y,m,m)}},e}(a.a)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var o=n(441);n.d(e,"a",function(){return o.a})},function(t,e,n){"use strict";var o=n(213),a=(n.n(o),n(340)),i=(n.n(a),n(212)),r=(n.n(i),n(346)),s=(n.n(r),n(347)),c=(n.n(s),n(85)),u=(n.n(c),n(342)),p=(n.n(u),n(211)),d=(n.n(p),n(343)),l=(n.n(d),n(351)),h=(n.n(l),n(69)),m=(n.n(h),n(352)),f=(n.n(m),n(353)),y=(n.n(f),n(143)),b=(n.n(y),n(354)),v=(n.n(b),n(355)),g=(n.n(v),n(214)),_=(n.n(g),n(358)),x=(n.n(_),n(359)),w=(n.n(x),n(360)),k=(n.n(w),n(112)),S=(n.n(k),n(0)),E=(n.n(S),n(15)),I=(n.n(E),n(17)),T=(n.n(I),n(472));n.n(T)},function(t,e,n){"use strict";var o=n(647);n.n(o);o.install({onUpdateReady:function(){return o.applyUpdate()},onUpdated:function(){return location.reload()}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var o=n(264),a=n(266),i=n(235);n.d(e,"a",function(){return r});var r=[i.a,a.a,o.a]},function(t,e,n){"use strict";var o=n(233),a=n(101),i=n(131),r=n(7),s=n(31),c=n(53),u=n(121),p=n(128),d=n(444),l=n(253),h=n(170),m=n(452),f=n(77),y=n(236),b=n(267),v=n(161),g=n(449),_=n(162),x=n(450),w=n(455);n.d(e,"a",function(){return k});var k=[c.h,s.c,o.b,u.b,v.a.forRoot(),_.a.forRoot(),h.b.forRoot(),b.b.forRoot(),p.a.forRoot(),o.f,a.c.forRoot(d.a,{useHash:!0}),r.c.provideStore(l.b),i.c.connectRouter(),f.c.run(m.a),f.c.run(g.a),f.c.run(w.a),f.c.run(x.a),f.c.run(y.a)]},function(t,e,n){"use strict";var o=n(1),a=n(225),i=(n.n(a),n(224)),r=n(235),s=n(442),c=n(440),u=n(439),p=n(7);n.d(e,"a",function(){return d});var d=function(){function t(t,e){this.appRef=t,this._store=e}return t.prototype.hmrOnInit=function(t){t&&t.rootState&&(t.rootState&&this._store.dispatch({type:"SET_ROOT_STATE",payload:t.rootState}),"restoreInputValues"in t&&t.restoreInputValues(),this.appRef.tick(),Object.keys(t).forEach(function(e){return delete t[e]}))},t.prototype.hmrOnDestroy=function(t){var e=this.appRef.components.map(function(t){return t.location.nativeElement});this._store.take(1).subscribe(function(e){return t.rootState=e}),t.disposeOldHosts=n.i(a.createNewHosts)(e),t.restoreInputValues=n.i(a.createInputTransfer)(),n.i(a.removeNgStyles)()},t.prototype.hmrAfterDestroy=function(t){t.disposeOldHosts(),delete t.disposeOldHosts},t}();d=__decorate([n.i(o.x)({bootstrap:[r.a],declarations:u.a,imports:c.a,providers:[i.b,s.a]}),__metadata("design:paramtypes",[o.h,p.a])],d)},function(t,e,n){"use strict";var o=n(443),a=n(96),i=n(253),r=n(267),s=n(236),c=n(170);n.d(e,"a",function(){return u});var u=o.a.concat(a.a,i.a,r.a,c.a,[s.a])},function(t,e,n){"use strict";var o=n(265);n.d(e,"a",function(){return a});var a=[o.a]},function(t,e,n){"use strict";var o=n(460),a=n(264),i=n(265),r=n(278),s=n(279),c=n(170),u=n(262);n.d(e,"a",function(){return p});var p=[{path:"",component:a.a,resolve:{gameState:i.a}},{path:"combat/:id",component:c.c,canActivate:[u.a]},{path:"world/:id",component:r.a,canActivate:[s.a]},{path:"**",component:o.a}]},function(t,e,n){"use strict";var o=n(42),a=n(290),i=n(103),r=n(288);n.d(e,"a",function(){return s});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.started=!1,e}return __extends(e,t),e.prototype.syncBehavior=function(){var e=this;if(!t.prototype.syncBehavior.call(this))return!1;this.animation=this.host.findBehavior(a.a),this.sprite=this.host.findBehavior(i.a),this.sound=this.host.findBehavior(r.a);var n=!(!this.animation||!this.sprite);return!this.started&&n&&(this.started=!0,this.animation.once("animation:done",function(){e.trigger("damage:done",e)})),n},e}(o.a)},function(t,e,n){"use strict";var o=n(1),a=n(62),i=n(28),r=n(7),s=n(16),c=n(34),u=(n.n(c),n(15)),p=(n.n(u),n(19)),d=n(47);n.d(e,"a",function(){return l});var l=function(){function t(t,e,o,a){var i=this;this.game=t,this.store=e,this.combatService=o,this.notify=a,this.active=!1,this.party$=this.store.select(s.e),this.inventory$=this.store.select(s.f).map(function(t){return t.filter(function(t){return"item"!==t.type})}),this.doChangeIndex$=new c.BehaviorSubject(0),this.doEquip$=new u.Subject,this.doUnequip$=new u.Subject,this.currentIndex$=this.doChangeIndex$.combineLatest(this.party$,function(t,e){return t>=e.count()?0:t<0?e.count()-1:t}),this.currentEntity$=this.currentIndex$.combineLatest(this.party$,function(t,e){return e.get(t)}).switchMap(function(t){return i.store.select(n.i(s.c)(t.eid))}),this._equipSubscription=this.doEquip$.withLatestFrom(this.currentEntity$,function(t,e){return t.item.usedby&&!t.item.usedby.find(function(t){return t===e.type})?i.notify.show(e.name+" cannot equip this item"):void i.store.dispatch(new p.g({entityId:e.eid,slot:t.slot,itemId:t.item.eid}))}).subscribe(),this._unequipSubscription=this.doUnequip$.withLatestFrom(this.currentEntity$,function(t,e){i.store.dispatch(new p.h({entityId:e.eid,slot:t.slot,itemId:t.item.eid}))}).subscribe()}return t.prototype.ngOnDestroy=function(){this._equipSubscription.unsubscribe(),this._unequipSubscription.unsubscribe()},t.prototype.nextCharacter=function(){var t=this;this.currentIndex$.take(1).subscribe(function(e){t.doChangeIndex$.next(e+1)})},t.prototype.previousCharacter=function(){var t=this;this.currentIndex$.take(1).subscribe(function(e){t.doChangeIndex$.next(e-1)})},t}();__decorate([n.i(o.M)(),__metadata("design:type",Boolean)],l.prototype,"active",void 0),l=__decorate([n.i(o.Z)({selector:"party-inventory",template:n(649),styles:[n(902)]}),__metadata("design:paramtypes",[a.a,r.a,d.a,i.a])],l)},function(t,e,n){"use strict";var o=n(1),a=n(96),i=n(34),r=(n.n(i),n(7));n.d(e,"a",function(){return s});var s=function(){function t(t,e){this.game=t,this.store=e,this._model$=new i.BehaviorSubject(null),this.model$=this._model$}return Object.defineProperty(t.prototype,"model",{set:function(t){this._model$.next(t)},enumerable:!0,configurable:!0}),t}();__decorate([n.i(o.M)(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],s.prototype,"model",null),s=__decorate([n.i(o.Z)({selector:"player-card",template:n(651),styles:[n(904)],changeDetection:o._0.OnPush}),__metadata("design:paramtypes",[a.c,r.a])],s)},function(t,e,n){"use strict";var o=n(1),a=n(96),i=n(0),r=(n.n(i),n(34)),s=(n.n(r),n(16)),c=n(7),u=n(47),p=n(254);n.d(e,"a",function(){return d});var d=function(){function t(t,e,o){var a=this;this.game=t,this.combatService=e,this.store=o,this._showExperience$=new r.BehaviorSubject(!0),this.showExperience$=this._showExperience$,this._showLevel$=new r.BehaviorSubject(!0),this.showLevel$=this._showLevel$,this._showHP$=new r.BehaviorSubject(!0),this.showHP$=this._showHP$,this._model$=new r.BehaviorSubject(null),this.model$=this._model$,this.entityWithEquipment$=this.model$.switchMap(function(t){return t?a.store.select(n.i(s.c)(t.eid)):i.Observable.empty()}),this._showCombatStats$=new r.BehaviorSubject(!0),this.showCombatStats$=this._showCombatStats$,this.attack$=this.entityWithEquipment$.map(function(t){return a.combatService.getAttack(t)}),this.defense$=this.entityWithEquipment$.map(function(t){return a.combatService.getDefense(t)}),this.speed$=this.entityWithEquipment$.map(function(t){return a.combatService.getSpeed(t)}),this.magic$=this.entityWithEquipment$.map(function(t){return a.combatService.getMagic(t)}),this.nextLevelExp$=this.model$.map(function(t){return t?n.i(p.a)(t.level+1):0}),this.nextLevelPercentage$=this.model$.map(function(t){if(!t)return 0;var e=n.i(p.a)(t.level+1),o=n.i(p.a)(t.level),a=0;return t&&(a=(t.exp-o)/(e-o)*100),Math.round(a)}),this.healthPercentage$=this.model$.map(function(t){return t?Math.round(t.hp/t.maxhp*100):0})}return Object.defineProperty(t.prototype,"showExperience",{set:function(t){this._showExperience$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showLevel",{set:function(t){this._showLevel$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showHP",{set:function(t){this._showHP$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{set:function(t){this._model$.next(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCombatStats",{set:function(t){this._showCombatStats$.next(t)},enumerable:!0,configurable:!0}),t}();__decorate([n.i(o.M)(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],d.prototype,"showExperience",null),__decorate([n.i(o.M)(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],d.prototype,"showLevel",null),__decorate([n.i(o.M)(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],d.prototype,"showHP",null),__decorate([n.i(o.M)(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],d.prototype,"model",null),__decorate([n.i(o.M)(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],d.prototype,"showCombatStats",null),d=__decorate([n.i(o.Z)({selector:"player-stats",template:n(652),changeDetection:o._0.OnPush}),__metadata("design:paramtypes",[a.c,u.a,c.a])],d)},function(t,e,n){"use strict";var o=n(1),a=n(35),i=(n.n(a),n(77)),r=n(72),s=n(47),c=n(28),u=n(131),p=n(22),d=n(7),l=n(16),h=n(19);n.d(e,"a",function(){return m});var m=function(){function t(t,e,o,i){var s=this;this.actions$=t,this.store=e,this.notificationService=o,this.combatService=i,this.beginCombat$=this.actions$.ofType(r.b.typeId).switchMap(function(t){return s.combatService.loadEncounter(t.payload)}).map(function(t){return new r.c(t)}).catch(function(t){return a.Observable.of(new r.f(t.toString()))}),this.navigateToCombatRoute$=this.actions$.ofType(r.c.typeId).debounceTime(100).distinctUntilChanged().map(function(t){var e=t.payload;return n.i(p.c)(e.id||e.zone,"combat must either be in a zone or have an id"),n.i(u.a)(["combat",e.id||e.zone])}),this.combatVictory$=this.actions$.ofType(r.a.typeId).switchMap(function(t){var e=t.payload;return a.Observable.create(function(n){return s.notificationService.show("Found "+e.gold+" gold!",null,0),e.items&&e.items.forEach(function(t){s.notificationService.show("Found "+t.name,null,0)}),s.notificationService.show("Gained "+e.exp+" experience!",null,0),e.levels.forEach(function(t){s.notificationService.show(t.name+" reached level "+t.level+"!",null,0)}),s.notificationService.show("Enemies Defeated!",function(){n.next(t),n.complete()}),"fixed"===e.type&&s.store.dispatch(new h.t(e.id,!0)),function(){}})}).map(function(t){return new r.d(t.payload)}),this.navigateToMapRoute$=this.actions$.ofType(r.d.typeId).debounceTime(100).switchMap(function(){return s.store.select(l.v)}).map(function(t){return n.i(p.c)(t,"cannot return to invalid map from combat"),n.i(u.a)(["world",t])})}return t}();__decorate([n.i(i.a)(),__metadata("design:type",Object)],m.prototype,"beginCombat$",void 0),__decorate([n.i(i.a)(),__metadata("design:type",Object)],m.prototype,"navigateToCombatRoute$",void 0),__decorate([n.i(i.a)(),__metadata("design:type",Object)],m.prototype,"combatVictory$",void 0),__decorate([n.i(i.a)(),__metadata("design:type",Object)],m.prototype,"navigateToMapRoute$",void 0),m=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[i.b,d.a,c.a,s.a])],m)},function(t,e,n){"use strict";var o=n(1),a=n(77),i=n(252),r=n(123),s=n(0);n.n(s);n.d(e,"a",function(){return c});var c=function(){function t(t,e){var n=this;this.actions$=t,this.gameDataService=e,this.loadSpreadsheetData$=this.actions$.ofType(r.b.typeId).switchMap(function(t){return n.gameDataService.loadGameData(t.payload).map(function(){return t.payload})}).map(function(t){return new r.d(t)}).catch(function(t){return s.Observable.of(new r.c(t.toString()))})}return t}();__decorate([n.i(a.a)(),__metadata("design:type",Object)],c.prototype,"loadSpreadsheetData$",void 0),c=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[a.b,i.a])],c)},function(t,e,n){"use strict";(function(t){var o=n(4),a=(n.n(o),n(97));n.d(e,"a",function(){return i});var i=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.fetch=function(e){var n=this;return new Promise(function(o,a){t.init({key:e,callback:function(t,e){t=n.data=n.transformTypes(t),o(n)}})})},n.prototype.transformTypes=function(t){var e={};return o.each(t,function(t,o){for(var a=t.elements.slice(0),i=a.length,r=0;r<i;r++){var s=a[r];for(var c in s)if(s.hasOwnProperty(c)&&"string"==typeof s[c]){var u=s[c];if(u.match(n.NUMBER_MATCHER))s[c]=parseInt(u,10);else if("benefit"===c)switch(u.toLowerCase()){case"true":case"yes":case"1":s[c]=!0;break;case"false":case"no":case"0":case null:s[c]=!1;break;default:s[c]=Boolean(u)}else"usedby"!==c&&"groups"!==c&&"message"!==c&&"zones"!==c&&"enemies"!==c||(/^\s*$/.test(u)?s[c]=null:s[c]=u.split("|"))}}e[o.toLowerCase()]=a}),e},n}(a.a);i.NUMBER_MATCHER=/^-?\d+$/}).call(e,n(898))},function(t,e,n){"use strict";var o=n(1),a=n(35),i=(n.n(a),n(19)),r=n(77),s=n(90),c=n(28);n.d(e,"a",function(){return u});var u=function(){function t(t,e,n){var o=this;this.actions$=t,this.notify=e,this.gameStateService=n,this.initLoadedGame$=this.actions$.ofType(i.i.typeId).switchMap(function(t){return o.gameStateService.load()}).map(function(t){return new i.j(t)}).catch(function(t){return a.Observable.of(new i.k(t.toString()))}),this.saveGameState$=this.actions$.ofType(i.o.typeId).switchMap(function(t){return o.gameStateService.save()}).map(function(){return new i.p}).catch(function(t){return a.Observable.of(new i.q(t.toString()))}),this.saveGameSuccess$=this.actions$.ofType(i.p.typeId).do(function(){o.notify.show("Game state saved!  Nice.")}),this.clearGameState$=this.actions$.ofType(i.l.typeId).switchMap(function(t){return o.gameStateService.resetGame()}).map(function(){return new i.m}).catch(function(t){return a.Observable.of(new i.n(t.toString()))}),this.clearGameSuccess$=this.actions$.ofType(i.m.typeId).do(function(){o.notify.show("Game data deleted.  Next time you refresh you will begin a new game.")}),this.afterLoadTravelToCurrentLocation$=this.actions$.ofType(i.e.typeId,i.j.typeId).debounceTime(10).map(function(t){var e;switch(t.type){case i.e.typeId:e=t.payload;break;case i.j.typeId:e=t.payload.gameState;break;default:return}return new i.a(e)}),this.travel$=this.actions$.ofType(i.a.typeId).switchMap(function(t){return o.gameStateService.loadMap(t.payload.location).map(function(){return t.payload.location})}).debounceTime(10).map(function(t){return new i.b(t)}).catch(function(t){return a.Observable.of(new i.c(t.toString()))})}return t}();__decorate([n.i(r.a)(),__metadata("design:type",Object)],u.prototype,"initLoadedGame$",void 0),__decorate([n.i(r.a)(),__metadata("design:type",Object)],u.prototype,"saveGameState$",void 0),__decorate([n.i(r.a)({dispatch:!1}),__metadata("design:type",Object)],u.prototype,"saveGameSuccess$",void 0),__decorate([n.i(r.a)(),__metadata("design:type",Object)],u.prototype,"clearGameState$",void 0),__decorate([n.i(r.a)({dispatch:!1}),__metadata("design:type",Object)],u.prototype,"clearGameSuccess$",void 0),__decorate([n.i(r.a)(),__metadata("design:type",Object)],u.prototype,"afterLoadTravelToCurrentLocation$",void 0),__decorate([n.i(r.a)(),__metadata("design:type",Object)],u.prototype,"travel$",void 0),u=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[r.b,c.a,s.a])],u)},function(t,e,n){"use strict";var o=n(45),a=(n.n(o),n(646));n.n(a);n.d(e,"a",function(){return r});var i=function(){function t(t){if(!o.Map.isMap(t)||o.List.isList(t)){var e;this._lazy=function(){return e||(e=t.toJS())}}else this._lazy=function(){return t}}return Object.defineProperty(t.prototype,"value",{get:function(){return this._lazy()},enumerable:!0,configurable:!0}),t}(),r=n.i(a.storeLogger)({collapsed:!0,stateTransformer:function(t){if(t.action&&t.nextState)return t;var e={};return Object.keys(t).forEach(function(n){e[n]=new i(t[n])}),e}})},function(t,e,n){"use strict";var o=n(22);n.d(e,"a",function(){return a});var a=n.i(o.d)({x:0,y:0});n.i(o.d)({eid:"improperly-initialized-entity-"+(new Date).getTime(),type:"npc",name:"unknown npc",icon:"improperly-initialized-entity.png",level:0,exp:0,attack:0,defense:0,speed:0,magic:0,baseattack:0,basespeed:0,basemagic:0,basedefense:0,hp:0,mp:0,maxhp:0,maxmp:0,weapon:null,armor:null,helm:null,shield:null,boots:null,accessory:null})},function(t,e,n){"use strict";var o=n(1),a=n(35),i=(n.n(a),n(77)),r=n(124),s=n(255);n.d(e,"a",function(){return c});var c=function(){function t(t,e){var n=this;this.actions$=t,this.spritesService=e,this.loadSprites$=this.actions$.ofType(r.d.typeId).switchMap(function(t){return n.spritesService.loadSprites(t.payload).map(function(){return t.payload})}).map(function(t){return new r.b(t)}).catch(function(t){return a.Observable.of(new r.c(t.toString()))})}return t}();__decorate([n.i(i.a)(),__metadata("design:type",Object)],c.prototype,"loadSprites$",void 0),c=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[i.b,s.a])],c)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(11)),i=n(285),r=n(256),s=n(37),c=n(286);n.d(e,"b",function(){return u}),n.d(e,"a",function(){return p});var u=function(t){function e(e,n,o,a){var i=t.call(this)||this;return i.parent=e,i.scene=n,i.data=o,i.current=null,i.target=null,i.player=null,i.action=null,i.spell=null,i.item=null,i.world=s.a.get(),i.states=[new h,new p,new l,new d,new m(a)],i}return __extends(e,t),e}(i.a),p=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.name=e.NAME,n}return __extends(e,t),e.prototype.enter=function(t){var e=this,n=function(e,o){t.scene.off("click",n),t.target=o[0],t.parent.items[0].select()};if(!t.current)throw new Error("Requires Current Player");var i=t.current;if(t.player=i.render,!t.player)throw new Error("Requires player render component for combat animations.");var s=new a.a(-1,-.25);t.action=t.target=t.spell=t.item=null;var c=function(e){t.action=e,t.scene.off("click",n),t.action.canTarget()?t.setCurrentState(h.NAME):t.setCurrentState(m.NAME)},u=o.filter(i.findBehaviors(r.a),function(t){return t.canBeUsedBy(i)});return t.parent.items=o.map(u,function(t){return{select:c.bind(e,t),label:t.getActionName()}}),i?void t.player.moveForward(function(){t.parent.setPointerTarget(i,"right",s),t.parent.showPointer(),t.scene.on("click",n)}):void t.parent.hidePointer()},e.prototype.exit=function(t){t.parent.items=[]},e}(c.a);p.NAME="choose-type";var d=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.name=e.NAME,n}return __extends(e,t),e.prototype.enter=function(t){var e=this;if(!t.current)throw new Error("Requires Current Player");var n=function(e,o){t.scene.off("click",n),t.target=o[0],t.parent.items[0].select()},a=function(e){switch(t.scene.off("click",n),t.spell=e,e.benefit&&(t.target=t.current),e.type){case"target":t.setCurrentState(h.NAME);break;default:console.info("Unknown spell type, submitting without target: "+e.type),t.setCurrentState(m.NAME)}},i=t.current.getSpells();t.parent.items=o.map(i,function(t){return{select:a.bind(e,t),label:t.name}}),t.scene.on("click",n)},e.prototype.exit=function(t){t.parent.items=[]},e}(c.a);d.NAME="choose-spell";var l=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.name=e.NAME,n}return __extends(e,t),e.prototype.enter=function(t){if(!t.current)throw new Error("Requires Current Player");console.warn("todo: combat items")},e.prototype.exit=function(t){t.parent.items=[]},e}(c.a);l.NAME="choose-item";var h=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.name=e.NAME,n}return __extends(e,t),e.prototype.enter=function(t){var e=this,n=t.data.enemies,i=t.target||n[0];if(t.parent.addPointerClass(t.action.getActionName()),!i)return void t.parent.hidePointer();var r,s=new a.a(.5,-.25),c=function(e){return t.target&&t.target._uid===e._uid?(t.target=e,t.scene.off("click",r),void t.setCurrentState(m.NAME)):(t.target=e,void t.parent.setPointerTarget(e,"left",s))};r=function(t,e){
c(e[0])};var u=!(!t||!(t.spell&&t.spell.benefit||t.item)),p=u?t.data.players:t.data.enemies;t.parent.items=o.map(p,function(t){return{select:c.bind(e,t),label:t.model.name}}),t.parent.setPointerTarget(i,"left",s),t.scene.on("click",r)},e.prototype.exit=function(t){t.parent.items=[]},e}(c.a);h.NAME="choose-target";var m=function(t){function e(n){var o=t.call(this)||this;return o.submit=n,o.name=e.NAME,o}return __extends(e,t),e.prototype.enter=function(t){var e=this;if(!t.current||!t.action||!this.submit)throw new Error("Invalid state");if(t.action.canTarget()&&!t.target)throw new Error("Invalid target");t.player.moveBackward(function(){t.parent.hidePointer(),t.action.from=t.current,t.action.to=t.target,t.action.spell=t.spell,t.action.item=t.item,t.action.select(),t.parent.removePointerClass(t.action.getActionName()),e.submit(t.action)})},e}(c.a);m.NAME="choose-submit"},function(t,e,n){"use strict";var o=n(184),a=n(95),i=n(38),r=n(1);n.d(e,"a",function(){return s});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.connectBehavior=function(){return t.prototype.connectBehavior.call(this)&&this.host instanceof a.a},e.prototype.process=function(e){if(!this.host)return void t.prototype.process.call(this,e);var n=e.context.canvas.width,o=new i.a(0,0,e.context.canvas.width,e.context.canvas.height);e.cameraScale=n>1024?6:n>768?4:n>480?3:2,e.camera=e.screenToWorld(o,e.cameraScale),e.camera.point.x=this.host.bounds.extent.x/2-e.camera.extent.x/2},e}(o.a);s=__decorate([n.i(r.Z)({selector:"combat-camera-behavior",template:"<ng-content></ng-content>"})],s)},function(t,e,n){"use strict";var o=n(1),a=n(49),i=n(16),r=n(7),s=n(46),c=n(39);n.d(e,"a",function(){return u});var u=function(){function t(t,e,n){this.store=t,this.loadingService=e,this.loader=n,this.party$=this.store.select(i.i)}return t.prototype.getMemberClass=function(t,e){return{focused:e&&e.model&&t&&t.model&&t.model.name===e.model.name}},t}();__decorate([n.i(o.M)(),__metadata("design:type",a.a)],u.prototype,"scene",void 0),u=__decorate([n.i(o.Z)({selector:"combat-hud",changeDetection:o._0.OnPush,styles:[n(907)],template:n(653)}),__metadata("design:paramtypes",[r.a,s.a,c.a])],u)},function(t,e,n){"use strict";var o=n(125),a=n(126),i=n(171),r=n(172),s=n(263),c=n(173),u=n(174),p=n(175);n(61);n.d(e,"a",function(){return d});var d=[p.a,o.a,a.a,i.a,r.a,s.a,c.a,u.a]},function(t,e,n){"use strict";var o=n(266);n.d(e,"a",function(){return o.a})},function(t,e,n){"use strict";var o=n(42),a=n(95),i=n(93),r=n(19),s=n(16),c=n(1),u=n(49),p=n(7),d=n(73),l=n(45),h=(n.n(l),n(72)),m=n(92);n.d(e,"a",function(){return f});var f=function(t){function e(e){var n=t.call(this)||this;return n.store=e,n.battleCounter$=n.store.select(s.t),n}return __extends(e,t),e.prototype.completeMove=function(t){var e=this;if(this.tileMap){var n=this.tileMap.map;if(n&&n.properties&&n.properties.combat){var o=this.tileMap.getTerrain("Terrain",t.to.x,t.to.y),a=o&&o.isDangerous,i=a?10:6;this.battleCounter$.take(1).subscribe(function(n){var o=n-i;o<=0?e.triggerCombat(t):e.store.dispatch(new r.s(o))})}}},e.prototype.rollBattleCounter=function(){var t=255,e=64;return Math.floor(Math.random()*(t-e+1))+e},e.prototype.triggerCombat=function(t){var e=this,o=t.to,a=this.tileMap.getCombatZones(o);if(!a)throw new Error("missing combat zone at point: "+o);var i=this.rollBattleCounter();this.store.dispatch(new r.s(i));var c=this.player.findBehavior(m.a);c&&c.velocity.zero(),this.store.select(s.e).withLatestFrom(this.store.select(s.u),this.store.select(s.q),function(t,o,i){var r=o.filter(function(t){return t.zones.indexOf(a.map)!==-1||t.zones.indexOf(a.target)!==-1});if(0===r.count())throw new Error("no valid encounters for this zone");var s=r.count()-1,c=0,u=r.get(Math.floor(Math.random()*(s-c+1))+c),p=function(t){var e=i.find(function(e){return e.id===t});return Object.assign({},e,{eid:n.i(d.c)(e.id),maxhp:e.hp,maxmp:e.mp})},m={type:"random",id:u.id,enemies:n.i(l.List)(u.enemies.map(p)),zone:a.target||a.map,message:u.message,party:n.i(l.List)(t)};e.store.dispatch(new h.b(m))}).take(1).subscribe()},e}(o.a);__decorate([n.i(c.M)(),__metadata("design:type",u.a)],f.prototype,"scene",void 0),__decorate([n.i(c.M)(),__metadata("design:type",a.a)],f.prototype,"tileMap",void 0),__decorate([n.i(c.M)(),__metadata("design:type",i.a)],f.prototype,"player",void 0),f=__decorate([n.i(c.Z)({selector:"combat-encounter-behavior",template:"\n    <ng-content></ng-content>"}),__metadata("design:paramtypes",[p.a])],f)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(94)),i=n(75),r=n(38),s=n(1),c=n(49);n.d(e,"a",function(){return u});var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hitBox=new r.a(0,0,1,1),e.hits=[],e.mouse=null,e}return __extends(e,t),e.prototype.syncBehavior=function(){return!!(t.prototype.syncBehavior.call(this)&&this.host.scene&&this.host.scene.world&&this.host.scene.world.input)&&(this.mouse=this.host.scene.world.input.getMouseHook("world"),!!this.mouse)},e.prototype.tick=function(e){this.host.scene&&this.mouse&&(o.each(this.hits,function(t){t.scale=1}),this.hits.length=0,this.hitBox.point.set(this.mouse.world),this.host.scene.db.queryRect(this.hitBox,a.a,this.hits),o.each(this.hits,function(t){t.scale=1.25}),t.prototype.tick.call(this,e))},e}(i.a);__decorate([n.i(s.M)(),__metadata("design:type",c.a)],u.prototype,"scene",void 0),u=__decorate([n.i(s.Z)({selector:"map-feature-input-behavior",template:"<ng-content></ng-content>"})],u)},function(t,e,n){"use strict";var o=n(184),a=n(1),i=n(11);n.d(e,"a",function(){return r});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.process=function(t){var e=t.context.canvas.width;t.camera.point.set(this.host.point),t.cameraScale=e>1024?6:e>768?4:e>480?3:2;var n=new i.a(t.context.canvas.width,t.context.canvas.height),o=t.screenToWorld(n,t.cameraScale);t.camera.extent.set(o),t.camera.setCenter(this.host.renderPoint||this.host.point),this.host.tileMap&&(t.camera.point.x=Math.min(t.camera.point.x,this.host.tileMap.bounds.extent.x-t.camera.extent.x),t.camera.point.y=Math.min(t.camera.point.y,this.host.tileMap.bounds.extent.y-t.camera.extent.y),t.camera.point.x=Math.max(0,t.camera.point.x),t.camera.point.y=Math.max(0,t.camera.point.y),this.host.tileMap.bounds.extent.x<t.camera.extent.x&&(t.camera.point.x=(this.host.tileMap.bounds.extent.x-t.camera.extent.x)/2),this.host.tileMap.bounds.extent.y<t.camera.extent.y&&(t.camera.point.y=(this.host.tileMap.bounds.extent.y-t.camera.extent.y)/2))},e}(o.a);r=__decorate([n.i(a.Z)({selector:"player-camera-behavior",template:"<ng-content></ng-content>"})],r)},function(t,e,n){"use strict";var o=n(94),a=n(75),i=n(160),r=n(92),s=n(1);n.d(e,"a",function(){return c});var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.collider=null,e.player=null,e.featureObject=null,e.onLook=new s.D,e.onLookAway=new s.D,e}return __extends(e,t),e.prototype.syncBehavior=function(){return t.prototype.syncBehavior.call(this),this.player=this.host.findBehavior(r.a),this.collider=this.host.findBehavior(i.a),!(!this.player||!this.collider)},e.prototype.tick=function(e){if(t.prototype.tick.call(this,e),this.player&&this.collider){var n=[],a=this.host.point.x+this.player.heading.x,i=this.host.point.y+this.player.heading.y,r=this.collider.collide(a,i,o.a,n),s=n[0],c=this.featureObject?this.featureObject._uid:null,u=!(!s||s._uid===c);r&&s&&!u||this.featureObject&&(this.onLookAway.emit(this.featureObject),this.featureObject=null),s&&r&&(this.featureObject=s,u&&this.onLook.emit(this.featureObject))}},e}(a.a);__decorate([n.i(s._8)(),__metadata("design:type",s.D)],c.prototype,"onLook",void 0),__decorate([n.i(s._8)(),__metadata("design:type",s.D)],c.prototype,"onLookAway",void 0),c=__decorate([n.i(s.Z)({selector:"player-look-behavior",template:"<ng-content></ng-content>"})],c)},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(237)),i=n(291),r=n(1),s=n(95);n.d(e,"a",function(){return c});var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.buildWeightedGraph=function(){var t,e=this,n=this.tileMap.getLayers(),i=n.length,r=new Array(this.tileMap.bounds.extent.x);for(t=0;t<this.tileMap.bounds.extent.x;t++)r[t]=new Array(this.tileMap.bounds.extent.y);for(t=0;t<this.tileMap.bounds.extent.x;t++)for(var s=0;s<this.tileMap.bounds.extent.y;s++){for(var c=10,u=!1,p=0;p<i;p++){var d=this.tileMap.getTileData(n[p],t,s);d&&(d.passable===!1?(c=1e3,u=!0):d.isPath===!0&&(c=1))}r[t][s]=c}return o.each(this.tileMap.features.objects,function(t){var n=t.properties;if(n){var i=a.a.COLLIDE_TYPES;if(n.passable!==!0&&n.type&&o.indexOf(i,n.type)!==-1){var s=t.x/t.width|0,c=t.y/t.height|0;!n.passable&&e.tileMap.bounds.pointInRect(s,c)&&(r[s][c]=100)}}}),r},e}(i.a);__decorate([n.i(r.M)(),__metadata("design:type",s.a)],c.prototype,"tileMap",void 0),c=__decorate([n.i(r.Z)({selector:"player-map-path-behavior",template:"\n    <ng-content></ng-content>"})],c)},function(t,e,n){"use strict";var o=n(1);n.d(e,"a",function(){return a});var a=function(){function t(){var t=this;this.supported=document.hasOwnProperty("hidden"),this._changeVisibility=function(){return t.onChange()},this.supported&&document.addEventListener("visibilityChange",this._changeVisibility)}return t.prototype.destroy=function(){this.supported&&document.removeEventListener("visibilityChange",this._changeVisibility)},t.prototype.onChange=function(){},t}();a=__decorate([n.i(o.d)(),__metadata("design:paramtypes",[])],a)},function(t,e,n){"use strict";var o=n(74);n.d(e,"a",function(){return a});var a=function(){function t(){this.interpFrame=0,this.animElapsed=0,this.animDuration=0,this.frames=[0],this.sourceMeta=null,this.sourceAnims=null}return t.prototype.setAnimationSource=function(t){console.log("Sprite is "+t),this.sourceMeta=n.i(o.e)(t),this.sourceMeta&&(this.sourceAnims=this.sourceMeta.animations,this.setAnimation("down"))},t.prototype.setAnimation=function(t){if(!this.sourceAnims)throw new Error("Invalid source animations");var e=this.sourceAnims[t];if(!e)throw new Error("Invalid animation name - "+t);this.frames=e.frames,this.animDuration=e.duration},t.prototype.updateTime=function(t){this.animElapsed+=t;var e=this.animElapsed/this.animDuration,n=Math.round(this.interpolate(0,this.frames.length-1,e));this.interpFrame=this.frames[n],this.animElapsed>this.animDuration&&(this.animElapsed=0)},t.prototype.interpolate=function(t,e,n){return n=Math.min(Math.max(n,0),1),t*(1-n)+e*n},t.prototype.getFrame=function(){return this.interpFrame},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(){}return t.prototype.render=function(t,e,n){},t}()},function(t,e,n){"use strict";var o=n(4),a=(n.n(o),n(38)),i=n(11);n.d(e,"a",function(){return r});var r=function(){function t(){this._pointRect=new a.a(0,0,1,1),this._objects=[]}return t.prototype.addSpatialObject=function(t){t&&t.point instanceof i.a&&this._objects.push(t)},t.prototype.removeSpatialObject=function(t){this._objects=o.reject(this._objects,function(e){return e._uid===t._uid})},t.prototype.queryPoint=function(t,e,n){return this._pointRect.point.set(t),this.queryRect(this._pointRect,e,n)},t.prototype.queryRect=function(t,e,n){var o;if(!n)throw new Error("Results array must be provided to query scene spatial database");o=!1;var a,i,r,s=this._objects;for(a=0,i=s.length;a<i;a++)r=s[a],(!e||r instanceof e)&&r.enabled!==!1&&r.point&&t.pointInRect(r.point)&&(n.push(r),o=!0);return o},t}()},function(t,e,n){"use strict";var o=n(42);n.d(e,"a",function(){return a});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.beforeFrame=function(t,e){},e.prototype.renderFrame=function(t,e){},e.prototype.afterFrame=function(t,e){},e}(o.a)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){e=t.exports=n(23)(),e.push([t.i,'.pt-page{width:100%;height:100%;position:absolute;top:0;left:0;visibility:hidden;overflow:hidden;-webkit-backface-visibility:hidden;-moz-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translateZ(0);-moz-transform:translateZ(0);transform:translateZ(0);-webkit-transform-style:preserve-3d;-moz-transform-style:preserve-3d;transform-style:preserve-3d}.no-js body{overflow:auto}.pt-page-ontop,.scale-down.ng-hide-add{z-index:99}.pt-page{visibility:visible;z-index:1}.pt-page-scaleDown{-webkit-animation:scaleDown .7s ease both;-moz-animation:scaleDown .7s ease both;animation:scaleDown .7s ease both}.pt-page-scaleUp,.scale-down.ng-hide-remove{-webkit-animation:scaleUp .7s ease both;-moz-animation:scaleUp .7s ease both;animation:scaleUp .7s ease both}.pt-page-scaleUpDown{-webkit-animation:scaleUpDown .5s ease both;-moz-animation:scaleUpDown .5s ease both;animation:scaleUpDown .5s ease both}.pt-page-scaleDownUp,.scale-down.ng-hide-add{-webkit-animation:scaleDownUp .5s ease both;-moz-animation:scaleDownUp .5s ease both;animation:scaleDownUp .5s ease both}.pt-page-scaleDownCenter{-webkit-animation:scaleDownCenter .4s ease-in both;-moz-animation:scaleDownCenter .4s ease-in both;animation:scaleDownCenter .4s ease-in both}.pt-page-scaleUpCenter{-webkit-animation:scaleUpCenter .4s ease-out both;-moz-animation:scaleUpCenter .4s ease-out both;animation:scaleUpCenter .4s ease-out both}@-webkit-keyframes scaleDown{to{opacity:0;-webkit-transform:scale(.8)}}@-moz-keyframes scaleDown{to{opacity:0;-moz-transform:scale(.8)}}@keyframes scaleDown{to{opacity:0;transform:scale(.8)}}@-webkit-keyframes scaleUp{0%{opacity:0;-webkit-transform:scale(.8)}}@-moz-keyframes scaleUp{0%{opacity:0;-moz-transform:scale(.8)}}@keyframes scaleUp{0%{opacity:0;transform:scale(.8)}}@-webkit-keyframes scaleUpDown{0%{opacity:0;-webkit-transform:scale(1.2)}}@-moz-keyframes scaleUpDown{0%{opacity:0;-moz-transform:scale(1.2)}}@keyframes scaleUpDown{0%{opacity:0;transform:scale(1.2)}}@-webkit-keyframes scaleDownUp{to{opacity:0;-webkit-transform:scale(1.2)}}@-moz-keyframes scaleDownUp{to{opacity:0;-moz-transform:scale(1.2)}}@keyframes scaleDownUp{to{opacity:0;transform:scale(1.2)}}@-webkit-keyframes scaleDownCenter{to{opacity:0;-webkit-transform:scale(.7)}}@-moz-keyframes scaleDownCenter{to{opacity:0;-moz-transform:scale(.7)}}@keyframes scaleDownCenter{to{opacity:0;transform:scale(.7)}}@-webkit-keyframes scaleUpCenter{0%{opacity:0;-webkit-transform:scale(.7)}}@-moz-keyframes scaleUpCenter{0%{opacity:0;-moz-transform:scale(.7)}}@keyframes scaleUpCenter{0%{opacity:0;transform:scale(.7)}}.pt-page-delay100{-webkit-animation-delay:.1s;-moz-animation-delay:.1s;animation-delay:.1s}.pt-page-delay180{-webkit-animation-delay:.18s;-moz-animation-delay:.18s;animation-delay:.18s}.pt-page-delay200{-webkit-animation-delay:.2s;-moz-animation-delay:.2s;animation-delay:.2s}.pt-page-delay300{-webkit-animation-delay:.3s;-moz-animation-delay:.3s;animation-delay:.3s}.pt-page-delay400{-webkit-animation-delay:.4s;-moz-animation-delay:.4s;animation-delay:.4s}.pt-page-delay500,.scale-down.ng-hide-add{-webkit-animation-delay:.5s;-moz-animation-delay:.5s;animation-delay:.5s}.pt-page-delay700{-webkit-animation-delay:.7s;-moz-animation-delay:.7s;animation-delay:.7s}.pt-page-delay1000,.scale-down.ng-hide-remove{-webkit-animation-delay:1s;-moz-animation-delay:1s;animation-delay:1s}.pt-page-moveToLeft{-webkit-animation:moveToLeft .6s ease both;-moz-animation:moveToLeft .6s ease both;animation:moveToLeft .6s ease both}.pt-page-moveFromLeft{-webkit-animation:moveFromLeft .6s ease both;-moz-animation:moveFromLeft .6s ease both;animation:moveFromLeft .6s ease both}.pt-page-moveToRight{-webkit-animation:moveToRight .6s ease both;-moz-animation:moveToRight .6s ease both;animation:moveToRight .6s ease both}.pt-page-moveFromRight{-webkit-animation:moveFromRight .6s ease both;-moz-animation:moveFromRight .6s ease both;animation:moveFromRight .6s ease both}.pt-page-moveToTop{-webkit-animation:moveToTop .6s ease both;-moz-animation:moveToTop .6s ease both;animation:moveToTop .6s ease both}.pt-page-moveFromTop{-webkit-animation:moveFromTop .6s ease both;-moz-animation:moveFromTop .6s ease both;animation:moveFromTop .6s ease both}.pt-page-moveToBottom{-webkit-animation:moveToBottom .6s ease both;-moz-animation:moveToBottom .6s ease both;animation:moveToBottom .6s ease both}.pt-page-moveFromBottom{-webkit-animation:moveFromBottom .6s ease both;-moz-animation:moveFromBottom .6s ease both;animation:moveFromBottom .6s ease both}.pt-page-fade{-webkit-animation:fade .7s ease both;-moz-animation:fade .7s ease both;animation:fade .7s ease both}.pt-page-moveToLeftFade{-webkit-animation:moveToLeftFade .7s ease both;-moz-animation:moveToLeftFade .7s ease both;animation:moveToLeftFade .7s ease both}.pt-page-moveFromLeftFade{-webkit-animation:moveFromLeftFade .7s ease both;-moz-animation:moveFromLeftFade .7s ease both;animation:moveFromLeftFade .7s ease both}.pt-page-moveToRightFade{-webkit-animation:moveToRightFade .7s ease both;-moz-animation:moveToRightFade .7s ease both;animation:moveToRightFade .7s ease both}.pt-page-moveFromRightFade{-webkit-animation:moveFromRightFade .7s ease both;-moz-animation:moveFromRightFade .7s ease both;animation:moveFromRightFade .7s ease both}.pt-page-moveToTopFade{-webkit-animation:moveToTopFade .7s ease both;-moz-animation:moveToTopFade .7s ease both;animation:moveToTopFade .7s ease both}.pt-page-moveFromTopFade{-webkit-animation:moveFromTopFade .7s ease both;-moz-animation:moveFromTopFade .7s ease both;animation:moveFromTopFade .7s ease both}.pt-page-moveToBottomFade{-webkit-animation:moveToBottomFade .7s ease both;-moz-animation:moveToBottomFade .7s ease both;animation:moveToBottomFade .7s ease both}.pt-page-moveFromBottomFade{-webkit-animation:moveFromBottomFade .7s ease both;-moz-animation:moveFromBottomFade .7s ease both;animation:moveFromBottomFade .7s ease both}.pt-page-moveToLeftEasing{-webkit-animation:moveToLeft .7s ease-in-out both;-moz-animation:moveToLeft .7s ease-in-out both;animation:moveToLeft .7s ease-in-out both}.pt-page-moveToRightEasing{-webkit-animation:moveToRight .7s ease-in-out both;-moz-animation:moveToRight .7s ease-in-out both;animation:moveToRight .7s ease-in-out both}.pt-page-moveToTopEasing{-webkit-animation:moveToTop .7s ease-in-out both;-moz-animation:moveToTop .7s ease-in-out both;animation:moveToTop .7s ease-in-out both}.pt-page-moveToBottomEasing{-webkit-animation:moveToBottom .7s ease-in-out both;-moz-animation:moveToBottom .7s ease-in-out both;animation:moveToBottom .7s ease-in-out both}@-webkit-keyframes moveToLeft{to{-webkit-transform:translateX(-100%)}}@-moz-keyframes moveToLeft{to{-moz-transform:translateX(-100%)}}@keyframes moveToLeft{to{transform:translateX(-100%)}}@-webkit-keyframes moveFromLeft{0%{-webkit-transform:translateX(-100%)}}@-moz-keyframes moveFromLeft{0%{-moz-transform:translateX(-100%)}}@keyframes moveFromLeft{0%{transform:translateX(-100%)}}@-webkit-keyframes moveToBottom{to{-webkit-transform:translateY(100%)}}@-moz-keyframes moveToBottom{to{-moz-transform:translateY(100%)}}@keyframes moveToBottom{to{transform:translateY(100%)}}@-webkit-keyframes moveFromBottom{0%{-webkit-transform:translateY(100%)}}@-moz-keyframes moveFromBottom{0%{-moz-transform:translateY(100%)}}@keyframes moveFromBottom{0%{transform:translateY(100%)}}@-webkit-keyframes fade{to{opacity:.3}}@-moz-keyframes fade{to{opacity:.3}}@keyframes fade{to{opacity:.3}}@-webkit-keyframes moveToLeftFade{to{opacity:.3;-webkit-transform:translateX(-100%)}}@-moz-keyframes moveToLeftFade{to{opacity:.3;-moz-transform:translateX(-100%)}}@keyframes moveToLeftFade{to{opacity:.3;transform:translateX(-100%)}}@-webkit-keyframes moveFromLeftFade{0%{opacity:.3;-webkit-transform:translateX(-100%)}}@-moz-keyframes moveFromLeftFade{0%{opacity:.3;-moz-transform:translateX(-100%)}}@keyframes moveFromLeftFade{0%{opacity:.3;transform:translateX(-100%)}}@-webkit-keyframes moveToRightFade{to{opacity:.3;-webkit-transform:translateX(100%)}}@-moz-keyframes moveToRightFade{to{opacity:.3;-moz-transform:translateX(100%)}}@keyframes moveToRightFade{to{opacity:.3;transform:translateX(100%)}}@-webkit-keyframes moveFromRightFade{0%{opacity:.3;-webkit-transform:translateX(100%)}}@-moz-keyframes moveFromRightFade{0%{opacity:.3;-moz-transform:translateX(100%)}}@keyframes moveFromRightFade{0%{opacity:.3;transform:translateX(100%)}}@-webkit-keyframes moveToTopFade{to{opacity:.3;-webkit-transform:translateY(-100%)}}@-moz-keyframes moveToTopFade{to{opacity:.3;-moz-transform:translateY(-100%)}}@keyframes moveToTopFade{to{opacity:.3;transform:translateY(-100%)}}@-webkit-keyframes moveFromTopFade{0%{opacity:.3;-webkit-transform:translateY(-100%)}}@-moz-keyframes moveFromTopFade{0%{opacity:.3;-moz-transform:translateY(-100%)}}@keyframes moveFromTopFade{0%{opacity:.3;transform:translateY(-100%)}}@-webkit-keyframes moveToBottomFade{to{opacity:.3;-webkit-transform:translateY(100%)}}@-moz-keyframes moveToBottomFade{to{opacity:.3;-moz-transform:translateY(100%)}}@keyframes moveToBottomFade{to{opacity:.3;transform:translateY(100%)}}@-webkit-keyframes moveFromBottomFade{0%{opacity:.3;-webkit-transform:translateY(100%)}}@-moz-keyframes moveFromBottomFade{0%{opacity:.3;-moz-transform:translateY(100%)}}@keyframes moveFromBottomFade{0%{opacity:.3;transform:translateY(100%)}}@-webkit-keyframes moveFromRight{0%{-webkit-transform:translateX(100%)}}@-moz-keyframes moveFromRight{0%{-moz-transform:translateX(100%)}}@keyframes moveFromRight{0%{transform:translateX(100%)}}@-webkit-keyframes moveToRight{to{-webkit-transform:translateX(100%)}}@-moz-keyframes moveToRight{to{-moz-transform:translateX(100%)}}@keyframes moveToRight{to{transform:translateX(100%)}}@-webkit-keyframes moveFromTop{0%{opacity:.3;-webkit-transform:translateY(-100%)}to{opacity:1}}@-moz-keyframes moveFromTop{0%{opacity:.3;-moz-transform:translateY(-100%)}to{opacity:1}}@keyframes moveFromTop{0%{opacity:.3;transform:translateY(-100%)}to{opacity:1;transform:translateY(0)}}@-webkit-keyframes moveToTop{to{opacity:.3;-webkit-transform:translateY(100%)}}@-moz-keyframes moveToTop{to{opacity:.3;-moz-transform:translateY(100%)}}@keyframes moveToTop{to{opacity:.3;transform:translateY(100%)}}@-webkit-keyframes fadeOut{to{opacity:0}}@-moz-keyframes fadeOut{to{opacity:0}}@keyframes fadeOut{to{opacity:0}}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.moveFromRight,.slide-from-right.ng-hide-remove{-webkit-animation:moveFromRight .6s ease both;-moz-animation:moveFromRight .6s ease both;animation:moveFromRight .6s ease both}.moveToRight,.slide-from-right.ng-hide-add{-webkit-animation:moveToRight .6s ease both;-moz-animation:moveToRight .6s ease both;animation:moveToRight .6s ease both}.slide-from-right.ng-hide-add,.slide-from-right.ng-hide-remove{display:block!important}.fade.ng-hide-add,.fadeOut,.menu-fade.ng-hide-add{-webkit-animation:fadeOut .3s ease both;-moz-animation:fadeOut .3s ease both;animation:fadeOut .3s ease both}.fade.ng-hide-remove,.fadeIn,.menu-fade.ng-hide-remove{-webkit-animation:fadeIn .3s ease both;-moz-animation:fadeIn .3s ease both;animation:fadeIn .3s ease both}.fade.ng-enter,.menu-fade.ng-hide-add,.menu-fade.ng-hide-remove{display:block!important}.fade.ng-enter{opacity:0}.fade.ng-enter,.fade.ng-enter.ng-enter-active{-webkit-animation:fadeIn .3s ease both;-moz-animation:fadeIn .3s ease both;animation:fadeIn .3s ease both;display:block!important}.fade.ng-leave{opacity:1;display:block!important}.fade.ng-leave,.fade.ng-leave-active{-webkit-animation:fadeOut .3s ease both;-moz-animation:fadeOut .3s ease both;animation:fadeOut .3s ease both;display:block!important}.fade.ng-hide-add,.fade.ng-hide-add-active,.fade.ng-hide-remove,.fade.ng-hide-remove-active{display:block!important}.fade.ng-hide-add{opacity:1}.fade.ng-hide-remove{opacity:0}.scale-down.ng-hide-add,.scale-down.ng-hide-remove{display:block!important}.loading{position:absolute;left:0;right:0;top:0;bottom:0}.loading .loading-wrapper{display:table;width:100%;height:100%;min-height:100%}.loading .loading-wrapper-inner{display:table-cell;vertical-align:middle;text-align:center}.mat-elevation-z0{box-shadow:0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12)}.mat-elevation-z1{box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12)}.mat-elevation-z2{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.mat-elevation-z3{box-shadow:0 3px 3px -2px rgba(0,0,0,.2),0 3px 4px 0 rgba(0,0,0,.14),0 1px 8px 0 rgba(0,0,0,.12)}.mat-elevation-z4{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)}.mat-elevation-z5{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 5px 8px 0 rgba(0,0,0,.14),0 1px 14px 0 rgba(0,0,0,.12)}.mat-elevation-z6{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.mat-elevation-z7{box-shadow:0 4px 5px -2px rgba(0,0,0,.2),0 7px 10px 1px rgba(0,0,0,.14),0 2px 16px 1px rgba(0,0,0,.12)}.mat-elevation-z8{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.mat-elevation-z9{box-shadow:0 5px 6px -3px rgba(0,0,0,.2),0 9px 12px 1px rgba(0,0,0,.14),0 3px 16px 2px rgba(0,0,0,.12)}.mat-elevation-z10{box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.mat-elevation-z11{box-shadow:0 6px 7px -4px rgba(0,0,0,.2),0 11px 15px 1px rgba(0,0,0,.14),0 4px 20px 3px rgba(0,0,0,.12)}.mat-elevation-z12{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.mat-elevation-z13{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 13px 19px 2px rgba(0,0,0,.14),0 5px 24px 4px rgba(0,0,0,.12)}.mat-elevation-z14{box-shadow:0 7px 9px -4px rgba(0,0,0,.2),0 14px 21px 2px rgba(0,0,0,.14),0 5px 26px 4px rgba(0,0,0,.12)}.mat-elevation-z15{box-shadow:0 8px 9px -5px rgba(0,0,0,.2),0 15px 22px 2px rgba(0,0,0,.14),0 6px 28px 5px rgba(0,0,0,.12)}.mat-elevation-z16{box-shadow:0 8px 10px -5px rgba(0,0,0,.2),0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12)}.mat-elevation-z17{box-shadow:0 8px 11px -5px rgba(0,0,0,.2),0 17px 26px 2px rgba(0,0,0,.14),0 6px 32px 5px rgba(0,0,0,.12)}.mat-elevation-z18{box-shadow:0 9px 11px -5px rgba(0,0,0,.2),0 18px 28px 2px rgba(0,0,0,.14),0 7px 34px 6px rgba(0,0,0,.12)}.mat-elevation-z19{box-shadow:0 9px 12px -6px rgba(0,0,0,.2),0 19px 29px 2px rgba(0,0,0,.14),0 7px 36px 6px rgba(0,0,0,.12)}.mat-elevation-z20{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 20px 31px 3px rgba(0,0,0,.14),0 8px 38px 7px rgba(0,0,0,.12)}.mat-elevation-z21{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 21px 33px 3px rgba(0,0,0,.14),0 8px 40px 7px rgba(0,0,0,.12)}.mat-elevation-z22{box-shadow:0 10px 14px -6px rgba(0,0,0,.2),0 22px 35px 3px rgba(0,0,0,.14),0 8px 42px 7px rgba(0,0,0,.12)}.mat-elevation-z23{box-shadow:0 11px 14px -7px rgba(0,0,0,.2),0 23px 36px 3px rgba(0,0,0,.14),0 9px 44px 8px rgba(0,0,0,.12)}.mat-elevation-z24{box-shadow:0 11px 15px -7px rgba(0,0,0,.2),0 24px 38px 3px rgba(0,0,0,.14),0 9px 46px 8px rgba(0,0,0,.12)}.mat-ripple{overflow:hidden}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0,0,.2,1);transform:scale(0)}.mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;font-size:16px;font-family:Roboto,Helvetica Neue,sans-serif;text-align:left;text-decoration:none;position:relative;cursor:pointer;outline:none}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px}[dir=rtl] .mat-option .mat-icon{margin-left:16px}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-option-ripple{position:absolute;top:0;left:0;bottom:0;right:0}@media screen and (-ms-high-contrast:active){.mat-option-ripple{opacity:.5}}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}.cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;text-transform:none;width:1px}.cdk-global-overlay-wrapper,.cdk-overlay-container{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed;z-index:1000}.cdk-global-overlay-wrapper{display:flex;position:absolute;z-index:1000}.cdk-overlay-pane{box-sizing:border-box}.cdk-overlay-backdrop,.cdk-overlay-pane{position:absolute;pointer-events:auto;z-index:1000}.cdk-overlay-backdrop{top:0;bottom:0;left:0;right:0;transition:opacity .4s cubic-bezier(.25,.8,.25,1);opacity:0}.cdk-overlay-backdrop.cdk-overlay-backdrop-showing{opacity:.48}.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.6)}.cdk-overlay-transparent-backdrop{background:none}.mat-ripple-element{background-color:hsla(0,0%,100%,.1)}.mat-option:focus:not(.mat-option-disabled),.mat-option:hover:not(.mat-option-disabled){background:hsla(0,0%,100%,.04)}.mat-option.mat-selected{color:#004c62}.mat-option.mat-active,.mat-option.mat-selected:not(.mat-option-multiple){background:hsla(0,0%,100%,.04)}.mat-option.mat-active{color:#fff}.mat-option.mat-option-disabled{color:hsla(0,0%,100%,.3)}.mat-pseudo-checkbox{color:hsla(0,0%,100%,.7)}.mat-pseudo-checkbox:after{color:#303030}.mat-pseudo-checkbox-checked.mat-primary,.mat-pseudo-checkbox-indeterminate.mat-primary{background:#0088ad}.mat-pseudo-checkbox-checked.mat-accent,.mat-pseudo-checkbox-indeterminate.mat-accent{background:#ffe261}.mat-pseudo-checkbox-checked.mat-warn,.mat-pseudo-checkbox-indeterminate.mat-warn{background:#f44336}.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background:#686868}.mat-app-background{background-color:#303030}.mat-theme-loaded-marker{display:none}.mat-autocomplete-panel,.mat-autocomplete-panel .mat-option.mat-selected:not(.mat-active){background:#424242;color:#fff}.mat-button.mat-primary .mat-button-focus-overlay,.mat-fab.mat-primary .mat-button-focus-overlay,.mat-icon-button.mat-primary .mat-button-focus-overlay,.mat-mini-fab.mat-primary .mat-button-focus-overlay,.mat-raised-button.mat-primary .mat-button-focus-overlay{background-color:rgba(0,76,98,.12)}.mat-button.mat-accent .mat-button-focus-overlay,.mat-fab.mat-accent .mat-button-focus-overlay,.mat-icon-button.mat-accent .mat-button-focus-overlay,.mat-mini-fab.mat-accent .mat-button-focus-overlay,.mat-raised-button.mat-accent .mat-button-focus-overlay{background-color:rgba(217,177,0,.12)}.mat-button.mat-warn .mat-button-focus-overlay,.mat-fab.mat-warn .mat-button-focus-overlay,.mat-icon-button.mat-warn .mat-button-focus-overlay,.mat-mini-fab.mat-warn .mat-button-focus-overlay,.mat-raised-button.mat-warn .mat-button-focus-overlay{background-color:rgba(244,67,54,.12)}.mat-button[disabled] .mat-button-focus-overlay,.mat-fab[disabled] .mat-button-focus-overlay,.mat-icon-button[disabled] .mat-button-focus-overlay,.mat-mini-fab[disabled] .mat-button-focus-overlay,.mat-raised-button[disabled] .mat-button-focus-overlay{background-color:transparent}.mat-button,.mat-icon-button{background:transparent}.mat-button.mat-primary,.mat-icon-button.mat-primary{color:#004c62}.mat-button.mat-accent,.mat-icon-button.mat-accent{color:#d9b100}.mat-button.mat-warn,.mat-icon-button.mat-warn{color:#f44336}.mat-button.mat-accent[disabled],.mat-button.mat-primary[disabled],.mat-button.mat-warn[disabled],.mat-button[disabled][disabled],.mat-icon-button.mat-accent[disabled],.mat-icon-button.mat-primary[disabled],.mat-icon-button.mat-warn[disabled],.mat-icon-button[disabled][disabled]{color:hsla(0,0%,100%,.3)}.mat-icon-button.mat-primary .mat-ripple-element{background-color:rgba(0,76,98,.26)}.mat-icon-button.mat-accent .mat-ripple-element{background-color:rgba(217,177,0,.26)}.mat-icon-button.mat-warn .mat-ripple-element{background-color:rgba(244,67,54,.26)}.mat-fab,.mat-mini-fab,.mat-raised-button{color:#fff;background-color:#424242}.mat-fab.mat-primary,.mat-mini-fab.mat-primary,.mat-raised-button.mat-primary{color:hsla(0,0%,100%,.87)}.mat-fab.mat-accent,.mat-mini-fab.mat-accent,.mat-raised-button.mat-accent{color:rgba(0,0,0,.87)}.mat-fab.mat-warn,.mat-mini-fab.mat-warn,.mat-raised-button.mat-warn{color:#fff}.mat-fab.mat-accent[disabled],.mat-fab.mat-primary[disabled],.mat-fab.mat-warn[disabled],.mat-fab[disabled][disabled],.mat-mini-fab.mat-accent[disabled],.mat-mini-fab.mat-primary[disabled],.mat-mini-fab.mat-warn[disabled],.mat-mini-fab[disabled][disabled],.mat-raised-button.mat-accent[disabled],.mat-raised-button.mat-primary[disabled],.mat-raised-button.mat-warn[disabled],.mat-raised-button[disabled][disabled]{color:hsla(0,0%,100%,.3)}.mat-fab.mat-primary,.mat-mini-fab.mat-primary,.mat-raised-button.mat-primary{background-color:#004c62}.mat-fab.mat-accent,.mat-mini-fab.mat-accent,.mat-raised-button.mat-accent{background-color:#d9b100}.mat-fab.mat-warn,.mat-mini-fab.mat-warn,.mat-raised-button.mat-warn{background-color:#f44336}.mat-fab.mat-accent[disabled],.mat-fab.mat-primary[disabled],.mat-fab.mat-warn[disabled],.mat-fab[disabled][disabled],.mat-mini-fab.mat-accent[disabled],.mat-mini-fab.mat-primary[disabled],.mat-mini-fab.mat-warn[disabled],.mat-mini-fab[disabled][disabled],.mat-raised-button.mat-accent[disabled],.mat-raised-button.mat-primary[disabled],.mat-raised-button.mat-warn[disabled],.mat-raised-button[disabled][disabled]{background-color:hsla(0,0%,100%,.12)}.mat-fab,.mat-mini-fab{background-color:#d9b100;color:rgba(0,0,0,.87)}.mat-button-toggle{color:hsla(0,0%,100%,.3)}.mat-button-toggle.cdk-focused .mat-button-toggle-focus-overlay{background-color:hsla(0,0%,100%,.06)}.mat-button-toggle-checked{background-color:#212121;color:#fff}.mat-button-toggle-disabled{background-color:#000;color:hsla(0,0%,100%,.3)}.mat-button-toggle-disabled.mat-button-toggle-checked{background-color:#424242}.mat-card{background:#424242;color:#fff}.mat-card-subtitle{color:hsla(0,0%,100%,.7)}.mat-checkbox-frame{border-color:hsla(0,0%,100%,.7)}.mat-checkbox-checkmark{fill:#303030}.mat-checkbox-checkmark-path{stroke:#303030!important}.mat-checkbox-mixedmark{background-color:#303030}.mat-checkbox-checked.mat-primary .mat-checkbox-background,.mat-checkbox-indeterminate.mat-primary .mat-checkbox-background{background-color:#0088ad}.mat-checkbox-checked.mat-accent .mat-checkbox-background,.mat-checkbox-indeterminate.mat-accent .mat-checkbox-background{background-color:#ffe261}.mat-checkbox-checked.mat-warn .mat-checkbox-background,.mat-checkbox-indeterminate.mat-warn .mat-checkbox-background{background-color:#f44336}.mat-checkbox-disabled.mat-checkbox-checked .mat-checkbox-background,.mat-checkbox-disabled.mat-checkbox-indeterminate .mat-checkbox-background{background-color:#686868}.mat-checkbox-disabled:not(.mat-checkbox-checked) .mat-checkbox-frame{border-color:#686868}.mat-checkbox:not(.mat-checkbox-disabled).mat-primary .mat-checkbox-ripple .mat-ripple-element{background-color:rgba(0,76,98,.26)}.mat-checkbox:not(.mat-checkbox-disabled).mat-accent .mat-checkbox-ripple .mat-ripple-element{background-color:rgba(217,177,0,.26)}.mat-checkbox:not(.mat-checkbox-disabled).mat-warn .mat-checkbox-ripple .mat-ripple-element{background-color:rgba(244,67,54,.26)}.mat-chip:not(.mat-basic-chip){background-color:#424242;color:#fff}.mat-chip.mat-chip-selected:not(.mat-basic-chip){background-color:#212121;color:#fff}.mat-chip.mat-chip-selected:not(.mat-basic-chip).mat-primary{background-color:#0088ad;color:#fff}.mat-chip.mat-chip-selected:not(.mat-basic-chip).mat-accent{background-color:#ffe261;color:rgba(0,0,0,.87)}.mat-chip.mat-chip-selected:not(.mat-basic-chip).mat-warn{background-color:#f44336;color:#fff}.mat-dialog-container{background:#424242}.mat-icon.mat-primary{color:#004c62}.mat-icon.mat-accent{color:#d9b100}.mat-icon.mat-warn{color:#f44336}.mat-input-placeholder{color:hsla(0,0%,100%,.3)}.mat-focused .mat-input-placeholder{color:#004c62}.mat-focused .mat-input-placeholder.mat-accent{color:#d9b100}.mat-focused .mat-input-placeholder.mat-warn{color:#f44336}.mat-input-element:disabled{color:hsla(0,0%,100%,.3)}.mat-focused .mat-input-placeholder.mat-float .mat-placeholder-required,input.mat-input-element:-webkit-autofill+.mat-input-placeholder .mat-placeholder-required{color:#d9b100}.mat-input-underline{border-color:hsla(0,0%,100%,.12)}.mat-input-underline .mat-input-ripple{background-color:#004c62}.mat-input-underline .mat-input-ripple.mat-accent{background-color:#d9b100}.mat-input-underline .mat-input-ripple.mat-warn{background-color:#f44336}.mat-input-invalid .mat-input-placeholder,.mat-input-invalid .mat-placeholder-required{color:#f44336}.mat-input-invalid .mat-input-underline{border-color:#f44336}.mat-input-invalid .mat-input-ripple{background-color:#f44336}.mat-input-error{color:#f44336}.mat-list .mat-list-item,.mat-nav-list .mat-list-item{color:#fff}.mat-list .mat-subheader,.mat-nav-list .mat-subheader{color:hsla(0,0%,100%,.7)}.mat-divider{border-top-color:hsla(0,0%,100%,.12)}.mat-nav-list .mat-list-item-content.mat-list-item-focus,.mat-nav-list .mat-list-item-content:hover{background:hsla(0,0%,100%,.04)}.mat-menu-content{background:#424242}.mat-menu-item{background:transparent;color:#fff}.mat-menu-item[disabled]{color:hsla(0,0%,100%,.3)}.mat-menu-item .mat-icon{color:#fff;vertical-align:middle}.mat-menu-item:focus:not([disabled]),.mat-menu-item:hover:not([disabled]){background:hsla(0,0%,100%,.04)}.mat-progress-bar-background{background:url("data:image/svg+xml;charset=UTF-8,%3Csvg%20version%3D%271.1%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20xmlns%3Axlink%3D%27http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%27%20x%3D%270px%27%20y%3D%270px%27%20enable-background%3D%27new%200%200%205%202%27%20xml%3Aspace%3D%27preserve%27%20viewBox%3D%270%200%205%202%27%20preserveAspectRatio%3D%27none%20slice%27%3E%3Ccircle%20cx%3D%271%27%20cy%3D%271%27%20r%3D%271%27%20fill%3D%27%23ccf5ff%27%2F%3E%3C%2Fsvg%3E")}.mat-progress-bar-buffer{background-color:#ccf5ff}.mat-progress-bar-fill:after{background-color:#007494}.mat-progress-bar.mat-accent .mat-progress-bar-background{background:url("data:image/svg+xml;charset=UTF-8,%3Csvg%20version%3D%271.1%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20xmlns%3Axlink%3D%27http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%27%20x%3D%270px%27%20y%3D%270px%27%20enable-background%3D%27new%200%200%205%202%27%20xml%3Aspace%3D%27preserve%27%20viewBox%3D%270%200%205%202%27%20preserveAspectRatio%3D%27none%20slice%27%3E%3Ccircle%20cx%3D%271%27%20cy%3D%271%27%20r%3D%271%27%20fill%3D%27%23fff5c7%27%2F%3E%3C%2Fsvg%3E")}.mat-progress-bar.mat-accent .mat-progress-bar-buffer{background-color:#fff5c7}.mat-progress-bar.mat-accent .mat-progress-bar-fill:after{background-color:#ffdd45}.mat-progress-bar.mat-warn .mat-progress-bar-background{background:url("data:image/svg+xml;charset=UTF-8,%3Csvg%20version%3D%271.1%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20xmlns%3Axlink%3D%27http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%27%20x%3D%270px%27%20y%3D%270px%27%20enable-background%3D%27new%200%200%205%202%27%20xml%3Aspace%3D%27preserve%27%20viewBox%3D%270%200%205%202%27%20preserveAspectRatio%3D%27none%20slice%27%3E%3Ccircle%20cx%3D%271%27%20cy%3D%271%27%20r%3D%271%27%20fill%3D%27%23ffcdd2%27%2F%3E%3C%2Fsvg%3E")}.mat-progress-bar.mat-warn .mat-progress-bar-buffer{background-color:#ffcdd2}.mat-progress-bar.mat-warn .mat-progress-bar-fill:after{background-color:#e53935}.mat-progress-spinner path,.mat-spinner path{stroke:#007494}.mat-progress-spinner.mat-accent path,.mat-spinner.mat-accent path{stroke:#ffdd45}.mat-progress-spinner.mat-warn path,.mat-spinner.mat-warn path{stroke:#e53935}.mat-radio-outer-circle{border-color:hsla(0,0%,100%,.7)}.mat-radio-checked .mat-radio-outer-circle{border-color:#d9b100}.mat-radio-disabled .mat-radio-outer-circle{border-color:hsla(0,0%,100%,.3)}.mat-radio-inner-circle{background-color:#d9b100}.mat-radio-disabled .mat-radio-inner-circle{background-color:hsla(0,0%,100%,.3)}.mat-radio-ripple .mat-ripple-element{background-color:rgba(217,177,0,.26)}.mat-radio-disabled .mat-radio-ripple .mat-ripple-element{background-color:hsla(0,0%,100%,.3)}.mat-select-trigger{color:hsla(0,0%,100%,.3)}.mat-select:focus:not(.mat-select-disabled) .mat-select-trigger{color:#004c62}.mat-select:not(:focus).ng-invalid.ng-touched:not(.mat-select-disabled) .mat-select-trigger{color:#f44336}.mat-select-underline{background-color:hsla(0,0%,100%,.12)}.mat-select:focus:not(.mat-select-disabled) .mat-select-underline{background-color:#004c62}.mat-select:not(:focus).ng-invalid.ng-touched:not(.mat-select-disabled) .mat-select-underline{background-color:#f44336}.mat-select-arrow{color:hsla(0,0%,100%,.3)}.mat-select:focus:not(.mat-select-disabled) .mat-select-arrow{color:#004c62}.mat-select:not(:focus).ng-invalid.ng-touched:not(.mat-select-disabled) .mat-select-arrow{color:#f44336}.mat-select-content,.mat-select-panel-done-animating{background:#424242}.mat-select-value{color:#fff}.mat-select-disabled .mat-select-value{color:hsla(0,0%,100%,.3)}.mat-sidenav-container{background-color:#303030;color:#fff}.mat-sidenav{color:#fff}.mat-sidenav,.mat-sidenav.mat-sidenav-push{background-color:#424242}.mat-sidenav-backdrop.mat-sidenav-shown{background-color:hsla(0,0%,74%,.6)}.mat-slide-toggle.mat-checked:not(.mat-disabled) .mat-slide-toggle-thumb{background-color:#fff0ad}.mat-slide-toggle.mat-checked:not(.mat-disabled) .mat-slide-toggle-bar{background-color:rgba(255,240,173,.5)}.mat-slide-toggle:not(.mat-checked) .mat-ripple-element{background-color:hsla(0,0%,100%,.12)}.mat-slide-toggle .mat-ripple-element{background-color:rgba(255,240,173,.12)}.mat-slide-toggle.mat-primary.mat-checked:not(.mat-disabled) .mat-slide-toggle-thumb{background-color:#7de1fa}.mat-slide-toggle.mat-primary.mat-checked:not(.mat-disabled) .mat-slide-toggle-bar{background-color:rgba(125,225,250,.5)}.mat-slide-toggle.mat-primary:not(.mat-checked) .mat-ripple-element{background-color:hsla(0,0%,100%,.12)}.mat-slide-toggle.mat-primary .mat-ripple-element{background-color:rgba(125,225,250,.12)}.mat-slide-toggle.mat-warn.mat-checked:not(.mat-disabled) .mat-slide-toggle-thumb{background-color:#ef9a9a}.mat-slide-toggle.mat-warn.mat-checked:not(.mat-disabled) .mat-slide-toggle-bar{background-color:hsla(0,73%,77%,.5)}.mat-slide-toggle.mat-warn:not(.mat-checked) .mat-ripple-element{background-color:hsla(0,0%,100%,.12)}.mat-slide-toggle.mat-warn .mat-ripple-element{background-color:hsla(0,73%,77%,.12)}.mat-disabled .mat-slide-toggle-thumb{background-color:#424242}.mat-disabled .mat-slide-toggle-bar{background-color:hsla(0,0%,100%,.12)}.mat-slide-toggle-thumb{background-color:#bdbdbd}.mat-slide-toggle-bar{background-color:hsla(0,0%,100%,.3)}.mat-slider-track-background{background-color:rgba(0,0,0,.26)}.mat-primary .mat-slider-thumb,.mat-primary .mat-slider-thumb-label,.mat-primary .mat-slider-track-fill{background-color:#004c62}.mat-accent .mat-slider-thumb,.mat-accent .mat-slider-thumb-label,.mat-accent .mat-slider-track-fill{background-color:#d9b100}.mat-warn .mat-slider-thumb,.mat-warn .mat-slider-thumb-label,.mat-warn .mat-slider-track-fill{background-color:#f44336}.mat-slider-focus-ring{background-color:rgba(217,177,0,.2)}.mat-primary .mat-slider-thumb-label-text{color:hsla(0,0%,100%,.87)}.mat-accent .mat-slider-thumb-label-text{color:rgba(0,0,0,.87)}.mat-warn .mat-slider-thumb-label-text{color:#fff}.cdk-focused .mat-slider-track-background,.mat-slider:hover .mat-slider-track-background{background-color:rgba(0,0,0,.38)}.mat-slider-disabled .mat-slider-thumb,.mat-slider-disabled .mat-slider-track-background,.mat-slider-disabled .mat-slider-track-fill,.mat-slider-disabled:hover .mat-slider-track-background{background-color:rgba(0,0,0,.26)}.mat-slider-min-value .mat-slider-focus-ring{background-color:rgba(0,0,0,.12)}.mat-slider-min-value.mat-slider-thumb-label-showing .mat-slider-thumb,.mat-slider-min-value.mat-slider-thumb-label-showing .mat-slider-thumb-label{background-color:#000}.mat-slider-min-value.mat-slider-thumb-label-showing.cdk-focused .mat-slider-thumb,.mat-slider-min-value.mat-slider-thumb-label-showing.cdk-focused .mat-slider-thumb-label{background-color:rgba(0,0,0,.26)}.mat-slider-min-value:not(.mat-slider-thumb-label-showing) .mat-slider-thumb{border-color:rgba(0,0,0,.26);background-color:transparent}.mat-slider-min-value:not(.mat-slider-thumb-label-showing).cdk-focused .mat-slider-thumb,.mat-slider-min-value:not(.mat-slider-thumb-label-showing):hover .mat-slider-thumb{border-color:rgba(0,0,0,.38)}.mat-slider-min-value:not(.mat-slider-thumb-label-showing).cdk-focused.mat-slider-disabled .mat-slider-thumb,.mat-slider-min-value:not(.mat-slider-thumb-label-showing):hover.mat-slider-disabled .mat-slider-thumb{border-color:rgba(0,0,0,.26)}.mat-tab-header,.mat-tab-nav-bar{border-bottom:1px solid #000}.mat-tab-group-inverted-header .mat-tab-header,.mat-tab-group-inverted-header .mat-tab-nav-bar{border-top:1px solid #000;border-bottom:none}.mat-tab-label:focus{background-color:rgba(204,245,255,.3)}.mat-ink-bar{background-color:#0088ad}.mat-tab-label,.mat-tab-link{color:currentColor}.mat-tab-label.mat-tab-disabled,.mat-tab-link.mat-tab-disabled{color:hsla(0,0%,100%,.3)}.mat-toolbar{background:#212121;color:#fff}.mat-toolbar.mat-primary{background:#004c62;color:hsla(0,0%,100%,.87)}.mat-toolbar.mat-accent{background:#d9b100;color:rgba(0,0,0,.87)}.mat-toolbar.mat-warn{background:#f44336;color:#fff}.mat-tooltip{background:rgba(97,97,97,.9)}body,html{background-color:#222;overflow:hidden;color:hsla(0,0%,100%,.9)}canvas{image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges;-ms-interpolation-mode:nearest-neighbor}.ebp{font-family:GraphicPixel,sans-serif;background-color:#004c62;color:#fff;border:6px solid #fff;border-radius:9px;text-shadow:2px 2px 0 rgba(0,0,0,.7);padding-top:16px;padding-bottom:16px}.select-map{position:absolute;top:10px;right:10px;margin:1rem;padding:.5rem;opacity:.3;pointer-events:none}.select-map:hover{opacity:1}.select-map select{pointer-events:all}',""]);
},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,":host{display:inline-flex}:host,:host div{height:inherit}:host div.fine{background-color:#2e6da6}:host div.hurt{background-color:#e6c828}:host div.critical{background-color:rgba(183,0,5,.5)}:host div.dead{background-color:hsla(0,0%,100%,.5)}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,":host{padding:0;top:0;left:0;width:100%;min-height:100%;position:fixed;background-color:transparent;z-index:50;text-align:center;font-family:GraphicPixel,AdvoCut,sans-serif;pointer-events:none;-webkit-transform:scaleY(0);-moz-transform:scaleY(0);transform:scaleY(0);-webkit-transition:transform .2s ease-in-out;-moz-transition:transform .2s ease-in-out;transition:transform .2s ease-in-out}:host.active{-webkit-transform:scaleX(1);-moz-transform:scaleX(1);transform:scaleX(1);pointer-events:auto}:host .message{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;top:45%;left:0;right:0;background-color:rgba(0,0,0,.8);border:none;box-shadow:none;margin:auto;position:absolute;padding:25px 10px;font-size:2.5em;color:#fff;text-shadow:1px 1px 0 #000,-2px 0 #000,0 0 #000,-1px 1px 0 #000}:host .message.loading{visibility:hidden}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,":host,:host ul{text-align:center}:host ul{list-style-type:none;margin:0;padding:10px}:host ul>li{position:relative;padding-top:36px;height:100px;width:64px}:host ul>li>*{pointer-events:none}:host ul>li .desc{position:absolute;top:0;left:0;right:0;font-size:.9em;line-height:18px}:host ul>li .icon{left:0;right:0;margin:auto}:host ul>li .icon img{display:inline-block;height:64px;width:64px}:host ul>li .compare{color:#0f0}:host .unequipped>li{display:inline-block}:host ul,:host ul>li{display:inline-block;list-style-type:none}:host .character-equipment-map{padding:10px;margin:0;position:relative}:host .character-equipment-map>li{display:inline-block;font-size:16px}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,":host{background-color:rgba(0,0,0,.54);color:#fff}:host :not(md-icon):not([md-icon-button]):not([md-fab]){font-family:GraphicPixel,AdvoCut,sans-serif;text-shadow:1px 1px 0 #000,-2px 0 #000,0 0 #000,-1px 1px 0 #000}:host md-toolbar{position:fixed;border-bottom:6px solid #fff}:host md-toolbar h1{line-height:28px;height:32px;margin:0}:host md-toolbar h1 a{color:#fff;text-decoration:none}:host md-toolbar rpg-sprite{height:32px;margin-left:6px}:host md-toolbar button{font-size:20px}:host md-toolbar button.active{color:#e6c828}:host button[md-fab]{position:fixed;bottom:12px;right:12px}:host md-card{background-color:#004c62;color:#fff;border:6px solid #fff;border-radius:9px;text-shadow:2px 2px 0 rgba(0,0,0,.7);padding-top:16px;padding-bottom:16px;position:fixed;margin:auto;right:24px;bottom:-12px;top:88px;padding-bottom:36px;left:24px;max-width:600px;overflow-y:auto}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,":host .hero-card{padding:0 15px}:host .hero-card.dead{color:#aaa}:host .hero-card hr{margin-bottom:5px;margin-top:5px}:host .hero-card .image,:host .hero-card h1{margin-top:5px;text-align:center}:host .hero-card player-stats{text-align:center}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,"rpg-sprite{font-size:0}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,":host{display:block}:host .damage-value{background:none;pointer-events:none;position:absolute;opacity:0;z-index:20;font-family:GraphicPixel,sans-serif;font-size:3em;color:red;transition:opacity 1s ease-out,transform 1s cubic-bezier(.19,1,.22,1);transform:translateY(0);text-shadow:2px 2px 0 hsla(0,0%,100%,.9),-4px 0 hsla(0,0%,100%,.9),0 0 hsla(0,0%,100%,.9),-2px 2px 0 hsla(0,0%,100%,.9)}:host .damage-value.miss{color:#ccc}:host .damage-value.heal,:host .damage-value.miss{text-shadow:1px 1px 0 #222,-2px 0 #222,0 0 #222,-1px 1px 0 #222}:host .damage-value.heal{color:#0e0}:host .damage-value.active{opacity:1;transform:translateY(-25%)}:host .damage-value.remove{display:none}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,'[data-icon]:before{content:attr(data-icon)}[class*=" pow2-"]:before,[class^=pow2-]:before,[data-icon]:before{font-family:pow2!important;font-style:normal!important;font-weight:400!important;font-variant:normal!important;text-transform:none!important;speak:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.pow2-aura:before{content:"a"}.pow2-back-forth:before{content:"b"}.pow2-barbute:before{content:"c"}.pow2-barefoot:before{content:"d"}.pow2-battle-gear:before{content:"e"}.pow2-black-flag:before{content:"f"}.pow2-bolt-shield:before{content:"g"}.pow2-bone-knife:before{content:"h"}.pow2-bookmark:before{content:"i"}.pow2-bookmarklet:before{content:"j"}.pow2-boot-prints:before{content:"k"}.pow2-boots:before{content:"l"}.pow2-bottle-vapors:before{content:"m"}.pow2-breastplate:before{content:"n"}.pow2-broadsword:before{content:"o"}.pow2-bubbling-flask:before{content:"p"}.pow2-burning-dot:before{content:"q"}.pow2-cash:before{content:"r"}.pow2-castle:before{content:"s"}.pow2-checked-shield:before{content:"t"}.pow2-cheese-wedge:before{content:"u"}.pow2-chemical-drop:before{content:"v"}.pow2-chicken-leg:before{content:"w"}.pow2-cog:before{content:"x"}.pow2-conversation:before{content:"y"}.pow2-death-note:before{content:"z"}.pow2-drink-me:before{content:"A"}.pow2-emerald:before{content:"B"}.pow2-envelope:before{content:"C"}.pow2-ice-bolt:before{content:"D"}.pow2-list:before{content:"E"}.pow2-social-github:before{content:"F"}.pow2-tablet-landscape:before{content:"G"}.pow2-tablet-portrait:before{content:"H"}.pow2-comment:before{content:"I"}.pow2-arrow-right:before{content:"J"}:host{font-family:GraphicPixel,AdvoCut,sans-serif;position:fixed;bottom:0;left:0;right:0;background-color:rgba(0,0,0,.8);font-size:20px;margin-left:auto;margin-right:auto;width:100%;z-index:20;display:block}:host .progress{margin-bottom:0}:host .status{border-radius:0;text-align:right;color:#fff;position:relative;min-height:32px}@media (min-width:600px){:host .status{min-height:64px}}:host .status .text,:host .status rpg-health-bar{height:100%;position:absolute;top:0;bottom:0;left:0;right:0}:host .status .text{padding:0 15px;z-index:70}:host .status.focused{color:#e8c627}:host .status.choosing{background-color:#004c62}:host .status .name{float:left;text-align:left;width:25%}:host .status .hp,:host .status .name{text-shadow:1px 1px 0 #000,-2px 0 #000,0 0 #000,-1px 1px 0 #000}:host .status .hp{text-align:right}:host .status rpg-health-bar{opacity:.5;min-width:25%}@media (min-width:600px){:host .status{font-size:2.2em}}',""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,'[data-icon]:before{content:attr(data-icon)}[class*=" pow2-"]:before,[class^=pow2-]:before,[data-icon]:before{font-family:pow2!important;font-style:normal!important;font-weight:400!important;font-variant:normal!important;text-transform:none!important;speak:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.pow2-aura:before{content:"a"}.pow2-back-forth:before{content:"b"}.pow2-barbute:before{content:"c"}.pow2-barefoot:before{content:"d"}.pow2-battle-gear:before{content:"e"}.pow2-black-flag:before{content:"f"}.pow2-bolt-shield:before{content:"g"}.pow2-bone-knife:before{content:"h"}.pow2-bookmark:before{content:"i"}.pow2-bookmarklet:before{content:"j"}.pow2-boot-prints:before{content:"k"}.pow2-boots:before{content:"l"}.pow2-bottle-vapors:before{content:"m"}.pow2-breastplate:before{content:"n"}.pow2-broadsword:before{content:"o"}.pow2-bubbling-flask:before{content:"p"}.pow2-burning-dot:before{content:"q"}.pow2-cash:before{content:"r"}.pow2-castle:before{content:"s"}.pow2-checked-shield:before{content:"t"}.pow2-cheese-wedge:before{content:"u"}.pow2-chemical-drop:before{content:"v"}.pow2-chicken-leg:before{content:"w"}.pow2-cog:before{content:"x"}.pow2-conversation:before{content:"y"}.pow2-death-note:before{content:"z"}.pow2-drink-me:before{content:"A"}.pow2-emerald:before{content:"B"}.pow2-envelope:before{content:"C"}.pow2-ice-bolt:before{content:"D"}.pow2-list:before{content:"E"}.pow2-social-github:before{content:"F"}.pow2-tablet-landscape:before{content:"G"}.pow2-tablet-portrait:before{content:"H"}.pow2-comment:before{content:"I"}.pow2-arrow-right:before{content:"J"}:host *{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host rpg-health-bar{width:100%;display:-webkit-inline-flex;display:-moz-inline-flex;display:inline-flex}',""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,'[data-icon]:before{content:attr(data-icon)}[class*=" pow2-"]:before,[class^=pow2-]:before,[data-icon]:before{font-family:pow2!important;font-style:normal!important;font-weight:400!important;font-variant:normal!important;text-transform:none!important;speak:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.pow2-aura:before{content:"a"}.pow2-back-forth:before{content:"b"}.pow2-barbute:before{content:"c"}.pow2-barefoot:before{content:"d"}.pow2-battle-gear:before{content:"e"}.pow2-black-flag:before{content:"f"}.pow2-bolt-shield:before{content:"g"}.pow2-bone-knife:before{content:"h"}.pow2-bookmark:before{content:"i"}.pow2-bookmarklet:before{content:"j"}.pow2-boot-prints:before{content:"k"}.pow2-boots:before{content:"l"}.pow2-bottle-vapors:before{content:"m"}.pow2-breastplate:before{content:"n"}.pow2-broadsword:before{content:"o"}.pow2-bubbling-flask:before{content:"p"}.pow2-burning-dot:before{content:"q"}.pow2-cash:before{content:"r"}.pow2-castle:before{content:"s"}.pow2-checked-shield:before{content:"t"}.pow2-cheese-wedge:before{content:"u"}.pow2-chemical-drop:before{content:"v"}.pow2-chicken-leg:before{content:"w"}.pow2-cog:before{content:"x"}.pow2-conversation:before{content:"y"}.pow2-death-note:before{content:"z"}.pow2-drink-me:before{content:"A"}.pow2-emerald:before{content:"B"}.pow2-envelope:before{content:"C"}.pow2-ice-bolt:before{content:"D"}.pow2-list:before{content:"E"}.pow2-social-github:before{content:"F"}.pow2-tablet-landscape:before{content:"G"}.pow2-tablet-portrait:before{content:"H"}.pow2-comment:before{content:"I"}.pow2-arrow-right:before{content:"J"}:host .action-menu,:host .spells-menu,:host .targets-menu{position:absolute;bottom:100%;width:100%;margin:0;text-align:center;list-style-type:none;padding:0}:host .action-menu li,:host .spells-menu li,:host .targets-menu li{text-transform:capitalize;display:-webkit-inline-flex;display:-moz-inline-flex;display:inline-flex;cursor:pointer;padding:10px 15px}:host .action-menu li:hover,:host .spells-menu li:hover,:host .targets-menu li:hover{color:#e8c627}:host .point-to-player{font-size:1em;-webkit-transition:all .1s;-moz-transition:all .1s;transition:all .1s;color:#fff;text-shadow:2px 2px 1px rgba(0,0,0,.8);pointer-events:none;position:relative;top:1px;display:inline-block;font-family:Glyphicons;font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;z-index:20;position:absolute}:host .point-to-player.hidden{display:none}:host .point-to-player.left{content:\'<\'}:host .point-to-player.left:before{content:"\\E079"}:host .point-to-player.right{content:\'>\'}:host .point-to-player.right:before{content:"\\E080"}:host .point-to-player.attack,:host .point-to-player.magic{content:\'X\';color:red}:host .point-to-player.attack:before,:host .point-to-player.magic:before{content:"\\E087"}@media (min-width:600px){:host .point-to-player{font-size:2em}:host .combat-view .action-menu,:host .combat-view .spells-menu,:host .combat-view .targets-menu{margin:20px;width:auto;padding:5px 25px}}@media (max-width:599px){:host .combat-view .action-menu,:host .combat-view .spells-menu,:host .combat-view .targets-menu{border-radius:0;border-left:none;border-right:none}}',""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,"",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,"dialog-feature .dialog{position:fixed;top:0;left:0;right:0;margin:auto;font-family:GraphicPixel,AdvoCut,sans-serif;font-size:20px;background-color:#004c62;color:#fff;border:6px solid #fff;border-radius:9px;text-shadow:2px 2px 0 rgba(0,0,0,.7);padding-top:16px;padding-bottom:16px;max-height:90%;z-index:20;max-width:800px;text-align:center}dialog-feature .dialog h1{margin:0}@media (min-width:600px){dialog-feature .dialog{max-height:80%}dialog-feature .dialog h1{margin:auto}}dialog-feature .dialog .body-text{pointer-events:none}dialog-feature .dialog button{border:none;font-family:inherit;font-size:inherit;color:inherit;background:none;cursor:pointer;padding:10px 30px;display:inline-block;text-transform:uppercase;letter-spacing:1px;font-weight:700;outline:none;position:relative;-webkit-transition:all .3s;-moz-transition:all .3s;transition:all .3s;background:#cb4e4e;color:#fff;box-shadow:0 6px #ab3c3c;-webkit-transition:none;-moz-transition:none;transition:none;border-radius:0 0 5px 5px;position:absolute;font-size:1.5em;padding:10px 20px 5px;right:.5em;top:0}dialog-feature .dialog button:after{content:'';position:absolute;z-index:-1;-webkit-transition:all .3s;-moz-transition:all .3s;transition:all .3s}dialog-feature .dialog button:before{speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;position:relative;-webkit-font-smoothing:antialiased}dialog-feature .dialog button:hover{box-shadow:0 4px #ab3c3c;top:2px}dialog-feature .dialog button.ng-click-active,dialog-feature .dialog button:active{box-shadow:0 0 #ab3c3c;top:6px}dialog-feature .dialog button>i{pointer-events:none}dialog-feature .dialog button:hover{top:0;padding-top:12px;outline:none}dialog-feature .dialog button:active{top:0;padding-top:16px;outline:none}dialog-feature .dialog .character{padding:0}dialog-feature .dialog .character p{margin:0}dialog-feature .dialog .text{text-align:center;vertical-align:middle;line-height:normal;color:#fff;text-shadow:1px 1px 0 #000,-2px 0 #000,0 0 #000,-1px 1px 0 #000}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,"store-feature .store{max-width:600px;min-width:320px;z-index:20;position:fixed;top:0;left:0;right:0;margin:auto;font-family:GraphicPixel,AdvoCut,sans-serif;font-size:20px;background-color:#004c62;border:6px solid #fff;border-radius:9px;text-shadow:2px 2px 0 rgba(0,0,0,.7);padding-top:16px;padding-bottom:16px;max-height:90%;text-align:center;color:#fff;display:block}store-feature .store h1{margin:0}@media (min-width:600px){store-feature .store{max-height:80%}store-feature .store h1{margin:auto}}store-feature .store .inventory{min-height:200px;overflow-y:auto;text-align:center}store-feature .store .inventory .item-price{color:#e8c627}store-feature .store .btn-group{text-align:center}store-feature .store .btn-group button{border:none;font-family:inherit;font-size:inherit;color:inherit;background:none;cursor:pointer;padding:10px 30px;display:inline-block;text-transform:uppercase;letter-spacing:1px;font-weight:700;outline:none;position:relative;-webkit-transition:all .3s;-moz-transition:all .3s;transition:all .3s;border:3px solid #fff;color:#fff}store-feature .store .btn-group button:after{content:'';position:absolute;z-index:-1;-webkit-transition:all .3s;-moz-transition:all .3s;transition:all .3s}store-feature .store .btn-group button:before{speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;position:relative;-webkit-font-smoothing:antialiased}store-feature .store .btn-group button.ng-click-active,store-feature .store .btn-group button:active,store-feature .store .btn-group button:hover{color:#0e83cd;background:#fff}store-feature .store ul{padding:0;margin:0;text-align:center;list-style-type:none;max-width:100%}store-feature .store ul li.item{margin:10px;cursor:pointer;border:1px solid transparent}store-feature .store ul li.item *{pointer-events:none}store-feature .store ul li.item .item-name{white-space:nowrap;text-overflow:ellipsis}store-feature .store ul li.item:hover *{color:#0ff!important}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,"temple-feature .temple-view{position:fixed;top:0;left:0;right:0;font-family:GraphicPixel,AdvoCut,sans-serif;font-size:20px;background-color:#004c62;color:#fff;border:6px solid #fff;border-radius:9px;text-shadow:2px 2px 0 rgba(0,0,0,.7);padding-top:16px;padding-bottom:16px;max-height:90%;z-index:20;text-align:center;margin:auto;max-width:800px}temple-feature .temple-view h1{margin:0}@media (min-width:600px){temple-feature .temple-view{max-height:80%}temple-feature .temple-view h1{margin:auto}}temple-feature .temple-view button{border:none;font-family:inherit;font-size:inherit;color:inherit;background:none;cursor:pointer;padding:10px 30px;display:inline-block;text-transform:uppercase;letter-spacing:1px;font-weight:700;outline:none;position:relative;-webkit-transition:all .3s;-moz-transition:all .3s;transition:all .3s;border:3px solid #fff;color:#fff}temple-feature .temple-view button:after{content:'';position:absolute;z-index:-1;-webkit-transition:all .3s;-moz-transition:all .3s;transition:all .3s}temple-feature .temple-view button:before{speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;position:relative;-webkit-font-smoothing:antialiased}temple-feature .temple-view button.ng-click-active,temple-feature .temple-view button:active,temple-feature .temple-view button:hover{color:#0e83cd;background:#fff}temple-feature .temple-view .header h1{margin:0}temple-feature .temple-view ul.party{list-style:none}temple-feature .temple-view ul.party li{display:inline-block}",""])},function(t,e,n){e=t.exports=n(23)(),e.push([t.i,"",""])},,,,,,function(t,e){t.exports="<rpg-notification></rpg-notification>\n<loading></loading>\n<main>\n  <router-outlet></router-outlet>\n</main>\n\n"},function(t,e){t.exports='<div *ngFor="let current of [currentEntity$ | async]" fxLayout="column">\n  <div fxLayout="row" fxLayoutAlign="space-between stretch">\n    <button md-icon-button (click)="previousCharacter()">\n      <md-icon>chevron_left</md-icon>\n    </button>\n\n    <section fxLayout="row" fxFlex fxLayoutAlign="space-around center">\n      <div flex fxLayout="column" fxLayoutAlign="center center">\n        <rpg-sprite class="image" [name]="current.icon" frame="7"></rpg-sprite>\n        <span>{{current.name}}</span>\n      </div>\n      <div>\n        <player-stats [model]="current"\n                      [showExperience]="false"\n                      [showHP]="false"\n                      [showLevel]="false"></player-stats>\n      </div>\n    </section>\n\n    <button md-icon-button (click)="nextCharacter()">\n      <md-icon>chevron_right</md-icon>\n    </button>\n  </div>\n\n\n  <ul class="equipped" fxLayout="row" fxLayoutAlign="space-between center">\n    <li class="weapon" *ngIf="current.weapon" (click)="doUnequip$.next({slot:\'weapon\', item: current.weapon})">\n      <span class="desc">Weapon</span>\n      <rpg-sprite class="icon" [name]="current.weapon.icon"></rpg-sprite>\n    </li>\n    <li class="jewelry item" *ngIf="current.accessory" (click)="doUnequip$.next({slot:\'accessory\', item: current.accessory})">\n      <span class="desc">Accessory</span>\n      <rpg-sprite class="icon" [name]="current.accessory.icon"></rpg-sprite>\n    </li>\n    <li class="head item" *ngIf="current.helm" (click)="doUnequip$.next({slot:\'helm\', item: current.helm})">\n      <span class="desc">Head</span>\n      <rpg-sprite class="icon" [name]="current.helm.icon"></rpg-sprite>\n    </li>\n    <li class="body item" *ngIf="current.armor" (click)="doUnequip$.next({slot:\'armor\', item: current.armor})">\n      <span class="desc">Body</span>\n      <rpg-sprite class="icon" [name]="current.armor.icon"></rpg-sprite>\n    </li>\n    <li class="arms item" *ngIf="current.shield" (click)="doUnequip$.next({slot:\'shield\', item: current.shield})">\n      <span class="desc">Arms</span>\n      <rpg-sprite class="icon" [name]="current.shield.icon"></rpg-sprite>\n    </li>\n    <li class="feet item" *ngIf="current.boots" (click)="doUnequip$.next({slot:\'boots\', item: current.boots})">\n      <span class="desc">Feet</span>\n      <rpg-sprite class="icon" [name]="current.boots.icon"></rpg-sprite>\n    </li>\n  </ul>\n\n  <div class="container" fxLayout="column">\n    <strong>Inventory</strong>\n    <ul class="unequipped">\n      <li class="item" *ngFor="let item of (inventory$ | async)" (click)="doEquip$.next({slot:item.type, item: item})">\n        <span class="desc">{{item.name}}</span>\n        <rpg-sprite class="icon" [name]="item.icon"></rpg-sprite>\n      </li>\n    </ul>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<md-toolbar color="primary" class="mat-elevation-z4" *ngIf="open == true" [@toolbar]="open">\n  <h1 fxShow="false" fxShow.gt-sm><a href="https://github.com/justindujardin/angular-rpg" target="_blank">RPG</a></h1>\n  <rpg-sprite [height]="32" [width]="32" name="longSword.png"></rpg-sprite>\n  <span fxFlex></span>\n  <button md-button (click)="page = \'party\'" [ngClass]="{active: page == \'party\'}">Party</button>\n  <button md-button (click)="page = \'inventory\'" [ngClass]="{active: page == \'inventory\'}">Inventory</button>\n  <button md-button (click)="page = \'settings\'" [ngClass]="{active: page == \'settings\'}">Settings</button>\n</md-toolbar>\n\n<md-card class="mat-elevation-z3" [@card]="open" *ngIf="open == true">\n  <party-inventory *ngIf="page == \'inventory\'"></party-inventory>\n\n  <md-card-title *ngIf="page == \'party\'">Party Gold: {{partyGold$ | async}}</md-card-title>\n  <md-card-content *ngIf="page == \'party\'"\n                   fxLayout="row" fxLayoutWrap fxLayoutAlign="space-around center">\n    <player-card *ngFor="let member of party$ | async" [model]="member"></player-card>\n  </md-card-content>\n\n  <md-card-title *ngIf="page == \'settings\'">Game Save</md-card-title>\n  <md-card-actions *ngIf="page == \'settings\'">\n    <button md-button color="warn" (click)="resetGame()">Reset Game</button>\n    <button md-button (click)="saveGame()">Save Game</button>\n  </md-card-actions>\n</md-card>\n<button md-fab color="accent" (click)="open = !open" [@fab]="open">\n  <md-icon>{{open ? \'close\' : \'menu\'}}</md-icon>\n</button>\n'},function(t,e){t.exports='<section class="hero-card"\n         *ngFor="let model of [model$ | async]"\n         [class.dead]="model?.hp <= 0"\n         fxLayout="column"\n         fxLayoutAlign="space-between center">\n  <h3 class="name" [innerText]="model.name"></h3>\n  <rpg-sprite class="image" [name]="model.icon" frame="7" width="64" height="72"></rpg-sprite>\n  <player-stats [model]="model"></player-stats>\n</section>\n'},function(t,e){t.exports='<div *ngIf="showLevel$ | async">Level {{(model$ | async)?.level}}</div>\n\n<section *ngIf="showHP$ | async">\n  <div>HP {{(model$ | async)?.hp}} / {{(model$ | async)?.maxhp}}</div>\n  <md-progress-bar [value]="healthPercentage$ | async"></md-progress-bar>\n</section>\n\n<section *ngIf="showExperience$ | async">\n  <div>EXP {{(model$ | async)?.exp}} / {{nextLevelExp$ | async}}</div>\n  <md-progress-bar [value]="nextLevelPercentage$ | async"></md-progress-bar>\n</section>\n\n<section *ngIf="showCombatStats$ | async">\n  <div class="hero-stat">Attack : {{attack$ | async}}</div>\n  <div class="hero-stat">Defense : {{defense$ | async}}</div>\n  <div class="hero-stat">Magic : {{magic$ | async}}</div>\n  <div class="hero-stat">Speed : {{speed$ | async}}</div>\n</section>\n'},function(t,e){t.exports='<div class="status" *ngFor="let member of party$ | async" [ngClass]="getMemberClass(member,combat?.focus)">\n  <rpg-health-bar [model]="member">\n  </rpg-health-bar>\n  <div class="text">\n    <span class="name">{{member.name}}</span>\n    <span class="hp">HP {{member.hp}} / {{member.maxhp}}</span>\n  </div>\n</div>\n'},function(t,e){t.exports='<combat-camera-behavior></combat-camera-behavior>\n<combat-player\n  *ngFor="let p of (party$ | async); trackBy: combatTrackBy"\n  [icon]="p.icon"\n  [model]="p"></combat-player>\n<combat-enemy\n  *ngFor="let e of (enemies$ | async); trackBy: combatTrackBy"\n  [icon]="e.icon"\n  [model]="e"></combat-enemy>\n<ng-content></ng-content>\n'},function(t,e){t.exports='<canvas #combatCanvas>\n  Your browser doesn\'t support this.\n</canvas>\n\n<combat-damage *ngFor="let d of damages"\n               [value]="d.value"\n               [position]="d.position"\n               [classes]="d.classes"></combat-damage>\n\n<combat-map #map [scene]="scene">\n  <combat-state-machine [scene]="scene"\n                        [party]="map.party"\n                        [enemies]="map.enemies"\n                        [encounter]="map.encounter$ | async"></combat-state-machine>\n\n</combat-map>\n<combat-hud [scene]="scene"></combat-hud>\n'},function(t,e){t.exports="\n"},function(t,e){t.exports='<div layout="row" layout-padding class="dialog" *ngIf="active$ | async">\n  <rpg-sprite class="character" [name]="icon$ | async"></rpg-sprite>\n  <div flex class="body-text">\n    <p [innerText]="title$ | async"></p>\n    <span class="text" [innerText]="text$ | async"></span>\n  </div>\n  <button class="btn-close" (click)="onClose.next($event)">x</button>\n</div>\n'},function(t,e){t.exports='<div layout="column" class="store" layout-padding *ngIf="active$ | async">\n  <h1>{{actionVerb$ | async}} {{name$ | async}}</h1> <span>Gold: {{partyGold$ | async}}</span>\n\n  <div class="inventory" layout-padding flex>\n    <ul *ngIf="isBuying$ | async">\n      <li class="item" *ngFor="let item of inventory$ | async" (click)="_selected$.next(item)" layout="row">\n        <rpg-sprite width="32" height="32" class="icon" [name]="item.icon"></rpg-sprite>\n        <span flex class="item-name" [innerText]="item.name"></span>\n        <span class="item-price" [innerText]="item.value"></span>\n      </li>\n    </ul>\n\n    <ul *ngIf="isSelling$ | async">\n      <li class="item" *ngFor="let item of partyInventory$ | async" (click)="_selected$.next(item)" layout="row">\n        <rpg-sprite width="32" height="32" class="icon" [name]="item.icon"></rpg-sprite>\n        <span flex class="item-name" [innerText]="item.name"></span>\n        <span class="item-price" [innerText]="item.value"></span>\n      </li>\n    </ul>\n    <ul *ngIf="selected$ | async">\n      <li class="item selected" layout="row">\n        <rpg-sprite width="32" height="32" class="icon" [name]="(selected$ | async)?.icon"></rpg-sprite>\n        <span flex class="item-name" [innerText]="(selected$ | async)?.name"></span>\n        <span class="item-price" [innerText]="(selected$ | async)?.value"></span>\n      </li>\n    </ul>\n\n  </div>\n\n\n  <div class="prompt btn-group" *ngIf="selected$ | async">\n    <button (click)="_selected$.next(null)">Back</button>\n    <button (click)="_onAction$.next()" [innerText]="(selling$ | async)?\'Sell\':\'Buy\'"></button>\n  </div>\n  <div class="prompt btn-group" *ngIf="!(selected$ | async)">\n    <button (click)="onClose.next($event)">Done</button>\n    <button (click)="_onToggleAction$.next()" [innerText]="(selling$ | async)?\'Back\':\'Sell\'"></button>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class="temple-view" layout="column" layout-padding *ngIf="active$ | async">\n  <div class="header" layout="row" layout-align="center center">\n    <rpg-sprite [name]="icon$ | async"></rpg-sprite>\n    <h1>{{name$ | async}}</h1>\n  </div>\n\n  <div class="prompt" flex>\n    <h2>It will cost you {{cost$ | async}} of your {{partyGold$ | async}} gold to recover here.</h2>\n\n    <p>Would you like to heal your party members?</p>\n  </div>\n  <div layout="row" layout-padding>\n    <button flex="50" (click)="_onRest$.next()">Yes</button>\n    <button flex="50" (click)="onClose.next($event)">No</button>\n  </div>\n\n  <ul class="party">\n    <li *ngFor="let hero of party$ | async">\n      <h1>{{hero.name}}</h1>\n      <player-stats\n        [showLevel]="false"\n        [showExperience]="false"\n        [showCombatStats]="false"\n        [model]="hero"></player-stats>\n      <rpg-sprite class="image" frame="7" width="96" height="96" [name]="hero.icon"></rpg-sprite>\n    </li>\n  </ul>\n</div>\n'},function(t,e){t.exports='<!-- TODO: Replace this mess with Material Portal components -->\n<portal-feature\n  [feature]="feature$ | async"\n  #comp *ngIf="(type$ | async) ===\'PortalFeatureComponent\' && (enabled$ | async)"></portal-feature>\n<dialog-feature\n  [feature]="feature$ | async"\n  (onClose)="onClose.emit(featureQuery.first)"\n  #comp *ngIf="(type$ | async) ===\'DialogFeatureComponent\' && (enabled$ | async)"></dialog-feature>\n<temple-feature\n  [feature]="feature$ | async"\n  (onClose)="onClose.emit(featureQuery.first)"\n  #comp *ngIf="(type$ | async) ===\'TempleFeatureComponent\' && (enabled$ | async)"></temple-feature>\n<store-feature\n  [feature]="feature$ | async"\n  (onClose)="onClose.emit(featureQuery.first)"\n  #comp *ngIf="(type$ | async) ===\'StoreFeatureComponent\' && (enabled$ | async)"></store-feature>\n<ship-feature\n  [feature]="feature$ | async"\n  #comp *ngIf="(type$ | async) ===\'ShipFeatureComponent\' && (enabled$ | async)"></ship-feature>\n<treasure-feature\n  [feature]="feature$ | async"\n  #comp *ngIf="(type$ | async) ===\'TreasureFeatureComponent\' && (enabled$ | async)"></treasure-feature>\n<combat-feature\n  [feature]="feature$ | async"\n  #comp *ngIf="(type$ | async) ===\'CombatFeatureComponent\' && (enabled$ | async)"></combat-feature>\n'},function(t,e){t.exports='<map-feature-input-behavior [scene]="scene" #input></map-feature-input-behavior>\n<map-feature *ngFor="let feature of activeFeatures$ | async"\n             [tiledMap]="resource$ | async"\n             [scene]="scene"\n             (onClose)="player.escapeFeature()"\n             [feature]="feature"></map-feature>\n<world-player\n  #player\n  *ngIf="notTraveling$ | async"\n  [map]="self"\n  [scene]="scene"\n  [point]="renderPoint$ | async"\n  [model]="partyLeader$ | async"></world-player>\n<ng-content></ng-content>\n'},function(t,e){t.exports='<party-menu></party-menu>\n\n<world-map #map [scene]="scene"></world-map>\n\n<canvas #worldCanvas [hidden]="loadingService.loading$ | async">\n  Your browser doesn\'t support this.\n</canvas>\n'},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){function n(t){throw new Error("Cannot find module '"+t+"'.")}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=897},,function(t,e,n){var o=n(627);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(628);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(629);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(630);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(631);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(632);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(633);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(634);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(635);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(636);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(637);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(638);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(639);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(640);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(641);"string"==typeof o?t.exports=o:t.exports=o.toString()},function(t,e,n){var o=n(642);"string"==typeof o?t.exports=o:t.exports=o.toString();
},,,function(t,e,n){"use strict";function o(){return n.i(a.a)().bootstrapModule(s.a).then(i.a).catch(function(t){return console.error(t)})}Object.defineProperty(e,"__esModule",{value:!0});var a=(n(399),n(398),n(396)),i=n(224),r=n(225),s=(n.n(r),n(397));e.main=o,n.i(r.bootloader)(o)}],[917]);